<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Data Extraction and Preparation | A Practitioner’s Guide through the People Analytics Lifecycle: With Applications in R</title>
  <meta name="description" content="An end-to-end guide for successful analytics projects in the social sciences" />
  <meta name="generator" content="bookdown 0.24.4 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Data Extraction and Preparation | A Practitioner’s Guide through the People Analytics Lifecycle: With Applications in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An end-to-end guide for successful analytics projects in the social sciences" />
  <meta name="github-repo" content="crstarbuck/peopleanalytics-lifecycle-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Data Extraction and Preparation | A Practitioner’s Guide through the People Analytics Lifecycle: With Applications in R" />
  
  <meta name="twitter:description" content="An end-to-end guide for successful analytics projects in the social sciences" />
  

<meta name="author" content="Craig Starbuck" />


<meta name="date" content="2022-03-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inf-stats.html"/>
<link rel="next" href="aod.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Practitioner's Guide through the People Analytics Lifecycle: With Applications in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i><b>1</b> Foreword</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="planning.html"><a href="planning.html"><i class="fa fa-check"></i><b>3</b> Project Planning</a><ul>
<li class="chapter" data-level="3.1" data-path="planning.html"><a href="planning.html#guiding-principles"><i class="fa fa-check"></i><b>3.1</b> Guiding Principles</a><ul>
<li class="chapter" data-level="3.1.1" data-path="planning.html"><a href="planning.html#pro-employee-thinking"><i class="fa fa-check"></i><b>3.1.1</b> Pro Employee Thinking</a></li>
<li class="chapter" data-level="3.1.2" data-path="planning.html"><a href="planning.html#quality"><i class="fa fa-check"></i><b>3.1.2</b> Quality</a></li>
<li class="chapter" data-level="3.1.3" data-path="planning.html"><a href="planning.html#prioritization"><i class="fa fa-check"></i><b>3.1.3</b> Prioritization</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="planning.html"><a href="planning.html#tools"><i class="fa fa-check"></i><b>3.2</b> Tools</a><ul>
<li class="chapter" data-level="3.2.1" data-path="planning.html"><a href="planning.html#r"><i class="fa fa-check"></i><b>3.2.1</b> R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="planning.html"><a href="planning.html#d-framework"><i class="fa fa-check"></i><b>3.3</b> 4D Framework</a><ul>
<li class="chapter" data-level="3.3.1" data-path="planning.html"><a href="planning.html#discover"><i class="fa fa-check"></i><b>3.3.1</b> Discover</a></li>
<li class="chapter" data-level="3.3.2" data-path="planning.html"><a href="planning.html#design"><i class="fa fa-check"></i><b>3.3.2</b> Design</a></li>
<li class="chapter" data-level="3.3.3" data-path="planning.html"><a href="planning.html#develop"><i class="fa fa-check"></i><b>3.3.3</b> Develop</a></li>
<li class="chapter" data-level="3.3.4" data-path="planning.html"><a href="planning.html#deliver"><i class="fa fa-check"></i><b>3.3.4</b> Deliver</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-intro.html"><a href="r-intro.html"><i class="fa fa-check"></i><b>4</b> Introduction to R</a><ul>
<li class="chapter" data-level="4.1" data-path="r-intro.html"><a href="r-intro.html#getting-started"><i class="fa fa-check"></i><b>4.1</b> Getting Started</a></li>
<li class="chapter" data-level="4.2" data-path="r-intro.html"><a href="r-intro.html#vectors"><i class="fa fa-check"></i><b>4.2</b> Vectors</a></li>
<li class="chapter" data-level="4.3" data-path="r-intro.html"><a href="r-intro.html#matrices"><i class="fa fa-check"></i><b>4.3</b> Matrices</a></li>
<li class="chapter" data-level="4.4" data-path="r-intro.html"><a href="r-intro.html#factors"><i class="fa fa-check"></i><b>4.4</b> Factors</a></li>
<li class="chapter" data-level="4.5" data-path="r-intro.html"><a href="r-intro.html#data-frames"><i class="fa fa-check"></i><b>4.5</b> Data Frames</a></li>
<li class="chapter" data-level="4.6" data-path="r-intro.html"><a href="r-intro.html#lists"><i class="fa fa-check"></i><b>4.6</b> Lists</a></li>
<li class="chapter" data-level="4.7" data-path="r-intro.html"><a href="r-intro.html#loops"><i class="fa fa-check"></i><b>4.7</b> Loops</a></li>
<li class="chapter" data-level="4.8" data-path="r-intro.html"><a href="r-intro.html#user-defined-functions-udfs"><i class="fa fa-check"></i><b>4.8</b> User-Defined Functions (UDFs)</a></li>
<li class="chapter" data-level="4.9" data-path="r-intro.html"><a href="r-intro.html#graphics"><i class="fa fa-check"></i><b>4.9</b> Graphics</a></li>
<li class="chapter" data-level="4.10" data-path="r-intro.html"><a href="r-intro.html#exercises"><i class="fa fa-check"></i><b>4.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="measure-sampl.html"><a href="measure-sampl.html"><i class="fa fa-check"></i><b>5</b> Measurement &amp; Sampling</a><ul>
<li class="chapter" data-level="5.1" data-path="measure-sampl.html"><a href="measure-sampl.html#variable-types"><i class="fa fa-check"></i><b>5.1</b> Variable Types</a><ul>
<li class="chapter" data-level="5.1.1" data-path="measure-sampl.html"><a href="measure-sampl.html#independent-variables-iv"><i class="fa fa-check"></i><b>5.1.1</b> Independent Variables (IV)</a></li>
<li class="chapter" data-level="5.1.2" data-path="measure-sampl.html"><a href="measure-sampl.html#dependent-variables-dv"><i class="fa fa-check"></i><b>5.1.2</b> Dependent Variables (DV)</a></li>
<li class="chapter" data-level="5.1.3" data-path="measure-sampl.html"><a href="measure-sampl.html#control-variables-cv"><i class="fa fa-check"></i><b>5.1.3</b> Control Variables (CV)</a></li>
<li class="chapter" data-level="5.1.4" data-path="measure-sampl.html"><a href="measure-sampl.html#moderating-variables"><i class="fa fa-check"></i><b>5.1.4</b> Moderating Variables</a></li>
<li class="chapter" data-level="5.1.5" data-path="measure-sampl.html"><a href="measure-sampl.html#mediating-variables"><i class="fa fa-check"></i><b>5.1.5</b> Mediating Variables</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="measure-sampl.html"><a href="measure-sampl.html#measurement-scales"><i class="fa fa-check"></i><b>5.2</b> Measurement Scales</a><ul>
<li class="chapter" data-level="5.2.1" data-path="measure-sampl.html"><a href="measure-sampl.html#discrete-variables"><i class="fa fa-check"></i><b>5.2.1</b> Discrete Variables</a></li>
<li class="chapter" data-level="5.2.2" data-path="measure-sampl.html"><a href="measure-sampl.html#continuous-variables"><i class="fa fa-check"></i><b>5.2.2</b> Continuous Variables</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="measure-sampl.html"><a href="measure-sampl.html#sampling"><i class="fa fa-check"></i><b>5.3</b> Sampling</a><ul>
<li class="chapter" data-level="5.3.1" data-path="measure-sampl.html"><a href="measure-sampl.html#sampling-nonsampling-error"><i class="fa fa-check"></i><b>5.3.1</b> Sampling &amp; Nonsampling Error</a></li>
<li class="chapter" data-level="5.3.2" data-path="measure-sampl.html"><a href="measure-sampl.html#sampling-methods"><i class="fa fa-check"></i><b>5.3.2</b> Sampling Methods</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="measure-sampl.html"><a href="measure-sampl.html#exercises-1"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="research.html"><a href="research.html"><i class="fa fa-check"></i><b>6</b> Research Fundamentals</a><ul>
<li class="chapter" data-level="6.1" data-path="research.html"><a href="research.html#research-questions"><i class="fa fa-check"></i><b>6.1</b> Research Questions</a></li>
<li class="chapter" data-level="6.2" data-path="research.html"><a href="research.html#research-hypotheses"><i class="fa fa-check"></i><b>6.2</b> Research Hypotheses</a></li>
<li class="chapter" data-level="6.3" data-path="research.html"><a href="research.html#internal-vs.external-validity"><i class="fa fa-check"></i><b>6.3</b> Internal vs. External Validity</a></li>
<li class="chapter" data-level="6.4" data-path="research.html"><a href="research.html#research-methods"><i class="fa fa-check"></i><b>6.4</b> Research Methods</a></li>
<li class="chapter" data-level="6.5" data-path="research.html"><a href="research.html#research-designs"><i class="fa fa-check"></i><b>6.5</b> Research Designs</a></li>
<li class="chapter" data-level="6.6" data-path="research.html"><a href="research.html#exercises-2"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="uni-bi-stats.html"><a href="uni-bi-stats.html"><i class="fa fa-check"></i><b>7</b> Univariate &amp; Bivariate Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="uni-bi-stats.html"><a href="uni-bi-stats.html#univariate-analysis"><i class="fa fa-check"></i><b>7.1</b> Univariate Analysis</a><ul>
<li class="chapter" data-level="7.1.1" data-path="uni-bi-stats.html"><a href="uni-bi-stats.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>7.1.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="7.1.2" data-path="uni-bi-stats.html"><a href="uni-bi-stats.html#measures-of-spread"><i class="fa fa-check"></i><b>7.1.2</b> Measures of Spread</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="uni-bi-stats.html"><a href="uni-bi-stats.html#bivariate-analysis"><i class="fa fa-check"></i><b>7.2</b> Bivariate Analysis</a><ul>
<li class="chapter" data-level="7.2.1" data-path="uni-bi-stats.html"><a href="uni-bi-stats.html#covariance"><i class="fa fa-check"></i><b>7.2.1</b> Covariance</a></li>
<li class="chapter" data-level="7.2.2" data-path="uni-bi-stats.html"><a href="uni-bi-stats.html#correlation"><i class="fa fa-check"></i><b>7.2.2</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="uni-bi-stats.html"><a href="uni-bi-stats.html#exercises-3"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inf-stats.html"><a href="inf-stats.html"><i class="fa fa-check"></i><b>8</b> Inferential Statistics</a><ul>
<li class="chapter" data-level="8.1" data-path="inf-stats.html"><a href="inf-stats.html#introduction-to-probability"><i class="fa fa-check"></i><b>8.1</b> Introduction to Probability</a><ul>
<li class="chapter" data-level="8.1.1" data-path="inf-stats.html"><a href="inf-stats.html#probability-distributions"><i class="fa fa-check"></i><b>8.1.1</b> Probability Distributions</a></li>
<li class="chapter" data-level="8.1.2" data-path="inf-stats.html"><a href="inf-stats.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.2</b> Conditional Probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="inf-stats.html"><a href="inf-stats.html#central-limit-theorem"><i class="fa fa-check"></i><b>8.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="8.3" data-path="inf-stats.html"><a href="inf-stats.html#confidence-intervals"><i class="fa fa-check"></i><b>8.3</b> Confidence Intervals</a><ul>
<li class="chapter" data-level="8.3.1" data-path="inf-stats.html"><a href="inf-stats.html#hypothesis-testing"><i class="fa fa-check"></i><b>8.3.1</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="8.3.2" data-path="inf-stats.html"><a href="inf-stats.html#alpha"><i class="fa fa-check"></i><b>8.3.2</b> Alpha</a></li>
<li class="chapter" data-level="8.3.3" data-path="inf-stats.html"><a href="inf-stats.html#beta"><i class="fa fa-check"></i><b>8.3.3</b> Beta</a></li>
<li class="chapter" data-level="8.3.4" data-path="inf-stats.html"><a href="inf-stats.html#type-i-ii-errors"><i class="fa fa-check"></i><b>8.3.4</b> Type I &amp; II Errors</a></li>
<li class="chapter" data-level="8.3.5" data-path="inf-stats.html"><a href="inf-stats.html#p-values"><i class="fa fa-check"></i><b>8.3.5</b> P-Values</a></li>
<li class="chapter" data-level="8.3.6" data-path="inf-stats.html"><a href="inf-stats.html#bonferroni-correction"><i class="fa fa-check"></i><b>8.3.6</b> Bonferroni Correction</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="inf-stats.html"><a href="inf-stats.html#parametric-vs.nonparametric-tests"><i class="fa fa-check"></i><b>8.4</b> Parametric vs. Nonparametric Tests</a></li>
<li class="chapter" data-level="8.5" data-path="inf-stats.html"><a href="inf-stats.html#exercises-4"><i class="fa fa-check"></i><b>8.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-ext-prep.html"><a href="data-ext-prep.html"><i class="fa fa-check"></i><b>9</b> Data Extraction and Preparation</a><ul>
<li class="chapter" data-level="9.1" data-path="data-ext-prep.html"><a href="data-ext-prep.html#data-wrangling"><i class="fa fa-check"></i><b>9.1</b> Data Wrangling</a></li>
<li class="chapter" data-level="9.2" data-path="data-ext-prep.html"><a href="data-ext-prep.html#data-screening-cleaning"><i class="fa fa-check"></i><b>9.2</b> Data Screening &amp; Cleaning</a></li>
<li class="chapter" data-level="9.3" data-path="data-ext-prep.html"><a href="data-ext-prep.html#one-hot-encoding"><i class="fa fa-check"></i><b>9.3</b> One-Hot Encoding</a></li>
<li class="chapter" data-level="9.4" data-path="data-ext-prep.html"><a href="data-ext-prep.html#feature-engineering"><i class="fa fa-check"></i><b>9.4</b> Feature Engineering</a></li>
<li class="chapter" data-level="9.5" data-path="data-ext-prep.html"><a href="data-ext-prep.html#exercises-5"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="aod.html"><a href="aod.html"><i class="fa fa-check"></i><b>10</b> Analysis of Differences</a><ul>
<li class="chapter" data-level="10.1" data-path="aod.html"><a href="aod.html#comparing-2-distributions"><i class="fa fa-check"></i><b>10.1</b> Comparing 2 Distributions</a></li>
<li class="chapter" data-level="10.2" data-path="aod.html"><a href="aod.html#comparing-3-distributions"><i class="fa fa-check"></i><b>10.2</b> Comparing 3+ Distributions</a></li>
<li class="chapter" data-level="10.3" data-path="aod.html"><a href="aod.html#exercises-6"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>11</b> Linear Regression</a><ul>
<li class="chapter" data-level="11.1" data-path="lm.html"><a href="lm.html#simple-linear-regression"><i class="fa fa-check"></i><b>11.1</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="11.1.1" data-path="lm.html"><a href="lm.html#parameter-estimation"><i class="fa fa-check"></i><b>11.1.1</b> Parameter Estimation</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="lm.html"><a href="lm.html#multiple-linear-regression"><i class="fa fa-check"></i><b>11.2</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="11.2.1" data-path="lm.html"><a href="lm.html#moderation"><i class="fa fa-check"></i><b>11.2.1</b> Moderation</a></li>
<li class="chapter" data-level="11.2.2" data-path="lm.html"><a href="lm.html#mediation"><i class="fa fa-check"></i><b>11.2.2</b> Mediation</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="lm.html"><a href="lm.html#polynomial-regression"><i class="fa fa-check"></i><b>11.3</b> Polynomial Regression</a></li>
<li class="chapter" data-level="11.4" data-path="lm.html"><a href="lm.html#hierarchical-models"><i class="fa fa-check"></i><b>11.4</b> Hierarchical Models</a></li>
<li class="chapter" data-level="11.5" data-path="lm.html"><a href="lm.html#exercises-7"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>12</b> Generalized Linear Regression</a><ul>
<li class="chapter" data-level="12.1" data-path="glm.html"><a href="glm.html#logistic-regression"><i class="fa fa-check"></i><b>12.1</b> Logistic Regression</a><ul>
<li class="chapter" data-level="12.1.1" data-path="glm.html"><a href="glm.html#binomial-logistic-regression"><i class="fa fa-check"></i><b>12.1.1</b> Binomial Logistic Regression</a></li>
<li class="chapter" data-level="12.1.2" data-path="glm.html"><a href="glm.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>12.1.2</b> Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="12.1.3" data-path="glm.html"><a href="glm.html#ordinal-logistic-regression"><i class="fa fa-check"></i><b>12.1.3</b> Ordinal Logistic Regression</a></li>
<li class="chapter" data-level="12.1.4" data-path="glm.html"><a href="glm.html#proportional-odds-logistic-regression"><i class="fa fa-check"></i><b>12.1.4</b> Proportional Odds Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="glm.html"><a href="glm.html#poisson-regression"><i class="fa fa-check"></i><b>12.2</b> Poisson Regression</a></li>
<li class="chapter" data-level="12.3" data-path="glm.html"><a href="glm.html#exercises-8"><i class="fa fa-check"></i><b>12.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="surv-anal.html"><a href="surv-anal.html"><i class="fa fa-check"></i><b>13</b> Survival Analysis</a><ul>
<li class="chapter" data-level="13.1" data-path="surv-anal.html"><a href="surv-anal.html#exercises-9"><i class="fa fa-check"></i><b>13.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="pred-mod.html"><a href="pred-mod.html"><i class="fa fa-check"></i><b>14</b> Predictive Models</a><ul>
<li class="chapter" data-level="14.1" data-path="pred-mod.html"><a href="pred-mod.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>14.1</b> Bias-Variance Trade-Off</a></li>
<li class="chapter" data-level="14.2" data-path="pred-mod.html"><a href="pred-mod.html#cross-validation"><i class="fa fa-check"></i><b>14.2</b> Cross-Validation</a></li>
<li class="chapter" data-level="14.3" data-path="pred-mod.html"><a href="pred-mod.html#balancing-classes"><i class="fa fa-check"></i><b>14.3</b> Balancing Classes</a></li>
<li class="chapter" data-level="14.4" data-path="pred-mod.html"><a href="pred-mod.html#model-performance"><i class="fa fa-check"></i><b>14.4</b> Model Performance</a></li>
<li class="chapter" data-level="14.5" data-path="pred-mod.html"><a href="pred-mod.html#automated-machine-learning-automl"><i class="fa fa-check"></i><b>14.5</b> Automated Machine Learning (AutoML)</a></li>
<li class="chapter" data-level="14.6" data-path="pred-mod.html"><a href="pred-mod.html#exercises-10"><i class="fa fa-check"></i><b>14.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="unsup-lrn.html"><a href="unsup-lrn.html"><i class="fa fa-check"></i><b>15</b> Unsupervised Learning</a><ul>
<li class="chapter" data-level="15.1" data-path="unsup-lrn.html"><a href="unsup-lrn.html#factor-analysis"><i class="fa fa-check"></i><b>15.1</b> Factor Analysis</a></li>
<li class="chapter" data-level="15.2" data-path="unsup-lrn.html"><a href="unsup-lrn.html#clustering"><i class="fa fa-check"></i><b>15.2</b> Clustering</a></li>
<li class="chapter" data-level="15.3" data-path="unsup-lrn.html"><a href="unsup-lrn.html#exercises-11"><i class="fa fa-check"></i><b>15.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="net-anal.html"><a href="net-anal.html"><i class="fa fa-check"></i><b>16</b> Network Analysis</a><ul>
<li class="chapter" data-level="16.1" data-path="net-anal.html"><a href="net-anal.html#centrality-measures"><i class="fa fa-check"></i><b>16.1</b> Centrality Measures</a></li>
<li class="chapter" data-level="16.2" data-path="net-anal.html"><a href="net-anal.html#exercises-12"><i class="fa fa-check"></i><b>16.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>17</b> Data Visualization</a><ul>
<li class="chapter" data-level="17.1" data-path="data-viz.html"><a href="data-viz.html#design-guidelines"><i class="fa fa-check"></i><b>17.1</b> Design Guidelines</a></li>
<li class="chapter" data-level="17.2" data-path="data-viz.html"><a href="data-viz.html#visualization-types"><i class="fa fa-check"></i><b>17.2</b> Visualization Types</a><ul>
<li class="chapter" data-level="17.2.1" data-path="data-viz.html"><a href="data-viz.html#tables"><i class="fa fa-check"></i><b>17.2.1</b> Tables</a></li>
<li class="chapter" data-level="17.2.2" data-path="data-viz.html"><a href="data-viz.html#heatmaps"><i class="fa fa-check"></i><b>17.2.2</b> Heatmaps</a></li>
<li class="chapter" data-level="17.2.3" data-path="data-viz.html"><a href="data-viz.html#scatterplots"><i class="fa fa-check"></i><b>17.2.3</b> Scatterplots</a></li>
<li class="chapter" data-level="17.2.4" data-path="data-viz.html"><a href="data-viz.html#line-graphs"><i class="fa fa-check"></i><b>17.2.4</b> Line Graphs</a></li>
<li class="chapter" data-level="17.2.5" data-path="data-viz.html"><a href="data-viz.html#slopegraphs"><i class="fa fa-check"></i><b>17.2.5</b> Slopegraphs</a></li>
<li class="chapter" data-level="17.2.6" data-path="data-viz.html"><a href="data-viz.html#bar-charts"><i class="fa fa-check"></i><b>17.2.6</b> Bar Charts</a></li>
<li class="chapter" data-level="17.2.7" data-path="data-viz.html"><a href="data-viz.html#waterfall-charts"><i class="fa fa-check"></i><b>17.2.7</b> Waterfall Charts</a></li>
<li class="chapter" data-level="17.2.8" data-path="data-viz.html"><a href="data-viz.html#area-charts"><i class="fa fa-check"></i><b>17.2.8</b> Area Charts</a></li>
<li class="chapter" data-level="17.2.9" data-path="data-viz.html"><a href="data-viz.html#pie-charts"><i class="fa fa-check"></i><b>17.2.9</b> Pie Charts</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="data-viz.html"><a href="data-viz.html#exercises-13"><i class="fa fa-check"></i><b>17.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="storytelling.html"><a href="storytelling.html"><i class="fa fa-check"></i><b>18</b> Data Storytelling</a><ul>
<li class="chapter" data-level="18.1" data-path="storytelling.html"><a href="storytelling.html#know-your-audience"><i class="fa fa-check"></i><b>18.1</b> Know Your Audience</a></li>
<li class="chapter" data-level="18.2" data-path="storytelling.html"><a href="storytelling.html#tldr"><i class="fa fa-check"></i><b>18.2</b> TL;DR</a></li>
<li class="chapter" data-level="18.3" data-path="storytelling.html"><a href="storytelling.html#telling-the-story"><i class="fa fa-check"></i><b>18.3</b> Telling the Story</a></li>
<li class="chapter" data-level="18.4" data-path="storytelling.html"><a href="storytelling.html#reference-material"><i class="fa fa-check"></i><b>18.4</b> Reference Material</a></li>
<li class="chapter" data-level="18.5" data-path="storytelling.html"><a href="storytelling.html#exercises-14"><i class="fa fa-check"></i><b>18.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="bibli.html"><a href="bibli.html"><i class="fa fa-check"></i><b>19</b> Bibliography</a></li>
<li class="chapter" data-level="20" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>20</b> Appendix</a><ul>
<li class="chapter" data-level="20.1" data-path="appendix.html"><a href="appendix.html#exercise-solutions"><i class="fa fa-check"></i><b>20.1</b> Exercise Solutions</a></li>
<li class="chapter" data-level="20.2" data-path="appendix.html"><a href="appendix.html#d-framework-1"><i class="fa fa-check"></i><b>20.2</b> 4D Framework</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Practitioner’s Guide through the People Analytics Lifecycle</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-ext-prep" class="section level1">
<h1><span class="header-section-number">9</span> Data Extraction and Preparation</h1>
<div id="data-wrangling" class="section level2">
<h2><span class="header-section-number">9.1</span> Data Wrangling</h2>
<p><strong>SQL</strong></p>
<p>When working with large datasets, it is best to filter records on the database side to avoid reading superfluous records into R only to then filter data to the relevant subset. Fewer records can help with enhancing the performance of R scripts – especially when R is running on a local machine, such as a laptop, rather than on a more powerful server. <strong>Structured Query Language (SQL)</strong> is the most common language used to extract and organize data contained in a relational database. SQL is an essential skill for anyone working in analytics.</p>
<p>There are three main <em>clauses</em> in a SQL query: (a) <code>SELECT</code>, (b) <code>FROM</code>, and (c) <code>WHERE</code>. The <code>SELECT</code> and <code>FROM</code> clauses are required, though the optional <code>WHERE</code> clause is frequently utilized.</p>
<ul>
<li><strong>SELECT</strong>: Specifies the columns to include in the output</li>
<li><strong>FROM</strong>: Specifies the table(s) in which the relevant data are contained</li>
<li><strong>WHERE</strong>: Specifies the rows to search</li>
</ul>
<p>Despite the clauses being ordered as shown above (<code>SELECT</code> then <code>FROM</code> then <code>WHERE</code>), the <code>FROM</code> clause is actually the first to execute since we first need to identify the relevant table(s) before filtering rows and selecting columns. The <code>SELECT</code> clause is the last to execute.</p>
<p>Additional clauses are available for more advanced operations.</p>
<ul>
<li><strong>GROUP BY</strong>: Specifies the columns by which data should be grouped when using aggregate functions</li>
<li><strong>HAVING</strong>: Specifies conditions for filtering rows based on aggregate functions</li>
<li><strong>ORDER BY</strong>: Specifies how data should be sorted in the output</li>
</ul>
<p>When implementing aggregate functions in a <code>SELECT</code> clause, such as counting, summing, or averaging a numeric field, all other non-aggregated fields must be included in the <code>GROUP BY</code> clause.</p>
<p>Though it is important to execute SQL queries directly on the database to minimize the amount of data read into R, we will use the <code>sqldf</code> library within R to demonstrate the mechanics of a SQL query. The <code>sqldf</code> library allows us to write SQL to query a data frame in R in lieu of a database. While the syntax of SQL may vary by database, the core structure of queries is univeral.</p>
<p>First, let’s load the <code>sqldf</code> library and store data to a data frame named <code>demographics</code>:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" data-line-number="1"><span class="co"># Load SQL library</span></a>
<a class="sourceLine" id="cb187-2" data-line-number="2"><span class="kw">library</span>(sqldf)</a>
<a class="sourceLine" id="cb187-3" data-line-number="3"></a>
<a class="sourceLine" id="cb187-4" data-line-number="4"><span class="co"># Read employee demographics data</span></a>
<a class="sourceLine" id="cb187-5" data-line-number="5">demographics &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/crstarbuck/peopleanalytics_lifecycle_book/master/data/files/employee_demographics.csv&quot;</span>)</a></code></pre></div>
<p>Next, we will apply the <code>sqldf</code> function to our data frame to extract specific rows and columns. A best practice in writing SQL is to capitalize the names of clauses and functions and to use separate lines and indentation to make the SQL statements more readable:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1"><span class="co"># Store SQL query as a character string using the paste() function</span></a>
<a class="sourceLine" id="cb188-2" data-line-number="2">sql_string &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;SELECT</span></a>
<a class="sourceLine" id="cb188-3" data-line-number="3"><span class="st">                      employee_id</span></a>
<a class="sourceLine" id="cb188-4" data-line-number="4"><span class="st">                    FROM</span></a>
<a class="sourceLine" id="cb188-5" data-line-number="5"><span class="st">                      demographics</span></a>
<a class="sourceLine" id="cb188-6" data-line-number="6"><span class="st">                    WHERE</span></a>
<a class="sourceLine" id="cb188-7" data-line-number="7"><span class="st">                      team = &#39;Social Marketing&#39;&quot;</span>)</a>
<a class="sourceLine" id="cb188-8" data-line-number="8"></a>
<a class="sourceLine" id="cb188-9" data-line-number="9"><span class="co"># Execute SQL query</span></a>
<a class="sourceLine" id="cb188-10" data-line-number="10"><span class="kw">sqldf</span>(sql_string)</a></code></pre></div>
<pre><code>##     employee_id
## 1          1013
## 2          1034
## 3          1035
## 4          1036
## 5          1037
## 6          1038
## 7          1139
## 8          1140
## 9          1141
## 10         1142
## 11         1143
## 12         1144
## 13         1145
## 14         1146
## 15         1147
## 16         1148
## 17         1149
## 18         1150
## 19         1151
## 20         1152
## 21         1153
## 22         1154
## 23         1155
## 24         1156
## 25         1157
## 26         1158
## 27         1159
## 28         1160
## 29         1161
## 30         1162
## 31         1163
## 32         1197
## 33         1198
## 34         1199
## 35         1200
## 36         1201
## 37         1202
## 38         1203
## 39         1204
## 40         1205
## 41         1206
## 42         1207
## 43         1208
## 44         1209
## 45         1210
## 46         1211
## 47         1212
## 48         1213
## 49         1214
## 50         1215
## 51         1216
## 52         1217
## 53         1218
## 54         1219
## 55         1220
## 56         1221
## 57         1222
## 58         1223
## 59         1224
## 60         1225
## 61         1226
## 62         1227
## 63         1228
## 64         1229
## 65         1230
## 66         1231
## 67         1232
## 68         1233
## 69         1234
## 70         1235
## 71         1236
## 72         1237
## 73         1238
## 74         1239
## 75         1240
## 76         1241
## 77         1242
## 78         1243
## 79         1244
## 80         1245
## 81         1246
## 82         1247
## 83         1248
## 84         1249
## 85         1250
## 86         1251
## 87         1252
## 88         1253
## 89         1254
## 90         1255
## 91         1256
## 92         1257
## 93         1258
## 94         1259
## 95         1260
## 96         1261
## 97         1262
## 98         1263
## 99         1264
## 100        1265
## 101        1266
## 102        1267
## 103        1268
## 104        1269
## 105        1270
## 106        1271
## 107        1272
## 108        1273
## 109        1274
## 110        1275
## 111        1276
## 112        1277
## 113        1278
## 114        1279
## 115        1280
## 116        1281
## 117        1282
## 118        1283
## 119        1284
## 120        1285
## 121        1286
## 122        1287
## 123        1288
## 124        1289
## 125        1290
## 126        1291
## 127        1292
## 128        1293
## 129        1294
## 130        1295
## 131        1296
## 132        1297
## 133        1298
## 134        1299
## 135        1300
## 136        1301
## 137        1302
## 138        1303
## 139        1304
## 140        1305
## 141        1306
## 142        1307
## 143        1308
## 144        1309
## 145        1310
## 146        1311
## 147        1312
## 148        1313
## 149        1314
## 150        1315
## 151        1316
## 152        1317
## 153        1318
## 154        1319
## 155        1320
## 156        1321
## 157        1322
## 158        1323
## 159        1324
## 160        1325
## 161        1326
## 162        1327
## 163        1328
## 164        1329
## 165        1330
## 166        1331
## 167        1332
## 168        1333
## 169        1334
## 170        1335
## 171        1336
## 172        1337
## 173        1338
## 174        1339
## 175        1340
## 176        1341
## 177        1342
## 178        1343
## 179        1344
## 180        1345
## 181        1346
## 182        1347
## 183        1348
## 184        1349
## 185        1350
## 186        1351
## 187        1352
## 188        1353
## 189        1354
## 190        1355
## 191        1356
## 192        1357
## 193        1358
## 194        1359
## 195        1360
## 196        1361
## 197        1362
## 198        1363
## 199        1364
## 200        1365
## 201        1366
## 202        1367
## 203        1368
## 204        1369
## 205        1370
## 206        1371
## 207        1372
## 208        1373
## 209        1374
## 210        1375
## 211        1376
## 212        1377
## 213        1378
## 214        1379
## 215        1380
## 216        1381
## 217        1382
## 218        1383
## 219        1384
## 220        1385
## 221        1386
## 222        1387
## 223        1388
## 224        1389
## 225        1390
## 226        1391
## 227        1392
## 228        1393
## 229        1394
## 230        1395
## 231        1396
## 232        1397
## 233        1398
## 234        1399
## 235        1400
## 236        1401
## 237        1402
## 238        1403
## 239        1404
## 240        1405
## 241        1406
## 242        1407
## 243        1408
## 244        1409
## 245        1410
## 246        1411
## 247        1412
## 248        1413
## 249        3450
## 250        3471
## 251        3472
## 252        3473
## 253        3474
## 254        3475
## 255        3576
## 256        3577
## 257        3578
## 258        3579
## 259        3580
## 260        3581
## 261        3582
## 262        3583
## 263        3584
## 264        3585
## 265        3586
## 266        3587
## 267        3588
## 268        3589
## 269        3590
## 270        3591
## 271        3592
## 272        3593
## 273        3594
## 274        3595
## 275        3596
## 276        3597
## 277        3598
## 278        3599
## 279        3600
## 280        3634
## 281        3635
## 282        3636
## 283        3637
## 284        3638
## 285        3639
## 286        3640
## 287        3641
## 288        3642
## 289        3643
## 290        3644
## 291        3645
## 292        3646
## 293        3647
## 294        3648
## 295        3649
## 296        3650
## 297        3651
## 298        3652
## 299        3653
## 300        3654
## 301        3655
## 302        3656
## 303        3657
## 304        3658
## 305        3659
## 306        3660
## 307        3661
## 308        3662
## 309        3663
## 310        3664
## 311        3665
## 312        3666
## 313        3667
## 314        3668
## 315        3669
## 316        3670
## 317        3671
## 318        3672
## 319        3673
## 320        3674
## 321        3675
## 322        3676
## 323        3677
## 324        3678
## 325        3679
## 326        3680
## 327        3681
## 328        3682
## 329        3683
## 330        3684
## 331        3685
## 332        3686
## 333        3687
## 334        3688
## 335        3689
## 336        3690
## 337        3691
## 338        3692
## 339        3693
## 340        3694
## 341        3695
## 342        3696
## 343        3697
## 344        3698
## 345        3699
## 346        3700
## 347        3701
## 348        3702
## 349        3703
## 350        3704
## 351        3705
## 352        3706
## 353        3707
## 354        3708
## 355        3709
## 356        3710
## 357        3711
## 358        3712
## 359        3713
## 360        3714
## 361        3715
## 362        3716
## 363        3717
## 364        3718
## 365        3719
## 366        3720
## 367        3721
## 368        3722
## 369        3723
## 370        3724
## 371        3725
## 372        3726
## 373        3727
## 374        3728
## 375        3729
## 376        3730
## 377        3731
## 378        3732
## 379        3733
## 380        3734
## 381        3735
## 382        3736
## 383        3737
## 384        3738
## 385        3739
## 386        3740
## 387        3741
## 388        3742
## 389        3743
## 390        3744
## 391        3745
## 392        3746
## 393        3747
## 394        3748
## 395        3749
## 396        3750
## 397        3751
## 398        3752
## 399        3753
## 400        3754
## 401        3755
## 402        3756
## 403        3757
## 404        3758
## 405        3759
## 406        3760
## 407        3761
## 408        3762
## 409        3763
## 410        3764
## 411        3765
## 412        3766
## 413        3767
## 414        3768
## 415        3769
## 416        3770
## 417        3771
## 418        3772
## 419        3773
## 420        3774
## 421        3775
## 422        3776
## 423        3777
## 424        3778
## 425        3779
## 426        3780
## 427        3781
## 428        3782
## 429        3783
## 430        3784
## 431        3785
## 432        3786
## 433        3787
## 434        3788
## 435        3789
## 436        3790
## 437        3791
## 438        3792
## 439        3793
## 440        3794
## 441        3795
## 442        3796
## 443        3797
## 444        3798
## 445        3799
## 446        3800
## 447        3801
## 448        3802
## 449        3803
## 450        3804
## 451        3805
## 452        3806
## 453        3807
## 454        3808
## 455        3809
## 456        3810
## 457        3811
## 458        3812
## 459        3813
## 460        3814
## 461        3815
## 462        3816
## 463        3817
## 464        3818
## 465        3819
## 466        3820
## 467        3821
## 468        3822
## 469        3823
## 470        3824
## 471        3825
## 472        3826
## 473        3827
## 474        3828
## 475        3829
## 476        3830
## 477        3831
## 478        3832
## 479        3833
## 480        3834
## 481        3835
## 482        3836
## 483        3837
## 484        3838
## 485        3839
## 486        3840
## 487        3841
## 488        3842
## 489        3843
## 490        3844
## 491        3845
## 492        3846
## 493        3847
## 494        3848
## 495        3849
## 496        3850</code></pre>
<p>This query returned a list of employee ids for the 496 employees on the Social Marketing team.</p>
<p>Next, let’s take a look at the average organization tenure by job for those on the Social Marketing team:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="co"># Store SQL query as a character string using the paste() function</span></a>
<a class="sourceLine" id="cb190-2" data-line-number="2">sql_string &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;SELECT</span></a>
<a class="sourceLine" id="cb190-3" data-line-number="3"><span class="st">                      job_title,</span></a>
<a class="sourceLine" id="cb190-4" data-line-number="4"><span class="st">                      AVG(org_tenure)</span></a>
<a class="sourceLine" id="cb190-5" data-line-number="5"><span class="st">                    FROM</span></a>
<a class="sourceLine" id="cb190-6" data-line-number="6"><span class="st">                      demographics</span></a>
<a class="sourceLine" id="cb190-7" data-line-number="7"><span class="st">                    WHERE</span></a>
<a class="sourceLine" id="cb190-8" data-line-number="8"><span class="st">                      team = &#39;Social Marketing&#39;</span></a>
<a class="sourceLine" id="cb190-9" data-line-number="9"><span class="st">                    GROUP BY</span></a>
<a class="sourceLine" id="cb190-10" data-line-number="10"><span class="st">                      job_title&quot;</span>)</a>
<a class="sourceLine" id="cb190-11" data-line-number="11"></a>
<a class="sourceLine" id="cb190-12" data-line-number="12"><span class="co"># Execute SQL query</span></a>
<a class="sourceLine" id="cb190-13" data-line-number="13"><span class="kw">sqldf</span>(sql_string)</a></code></pre></div>
<pre><code>##                       job_title AVG(org_tenure)
## 1         Community Coordinator        9.224138
## 2            Content Strategist        8.152778
## 3            Creative Assistant        9.454545
## 4                  Data Analyst        8.666667
## 5  Digital Marketing Specialist        8.228571
## 6                      Director        8.100000
## 7                       Manager        9.340000
## 8                SEO Specialist        9.596774
## 9       Social Media Strategist       10.000000
## 10               Vice President        7.500000</code></pre>
<p>There are 10 distinct job titles among employees on the Social Marketing team, and the average organization tenure for these ranges from <code>7.5</code> to <code>10</code>.</p>
<p>Since there could be few employees in certain jobs, in which case average organization tenure may not be as meaningful, we can use the <code>COUNT(*)</code> function to count the number of rows for each group. In this case, <code>COUNT(*)</code> will return the number of employees in each job on the Social Marketing team. We will also utilize aliases via <code>AS</code> in the <code>SELECT</code> clause to assign different names to the output fields:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1"><span class="co"># Store SQL query as a character string using the paste() function</span></a>
<a class="sourceLine" id="cb192-2" data-line-number="2">sql_string &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;SELECT</span></a>
<a class="sourceLine" id="cb192-3" data-line-number="3"><span class="st">                      job_title,</span></a>
<a class="sourceLine" id="cb192-4" data-line-number="4"><span class="st">                      COUNT(*) AS employee_cnt,</span></a>
<a class="sourceLine" id="cb192-5" data-line-number="5"><span class="st">                      AVG(org_tenure) AS avg_org_tenure</span></a>
<a class="sourceLine" id="cb192-6" data-line-number="6"><span class="st">                    FROM</span></a>
<a class="sourceLine" id="cb192-7" data-line-number="7"><span class="st">                      demographics</span></a>
<a class="sourceLine" id="cb192-8" data-line-number="8"><span class="st">                    WHERE</span></a>
<a class="sourceLine" id="cb192-9" data-line-number="9"><span class="st">                      team = &#39;Social Marketing&#39;</span></a>
<a class="sourceLine" id="cb192-10" data-line-number="10"><span class="st">                    GROUP BY</span></a>
<a class="sourceLine" id="cb192-11" data-line-number="11"><span class="st">                      job_title</span></a>
<a class="sourceLine" id="cb192-12" data-line-number="12"><span class="st">                    ORDER BY</span></a>
<a class="sourceLine" id="cb192-13" data-line-number="13"><span class="st">                      job_title&quot;</span>)</a>
<a class="sourceLine" id="cb192-14" data-line-number="14"></a>
<a class="sourceLine" id="cb192-15" data-line-number="15"><span class="co"># Execute SQL query</span></a>
<a class="sourceLine" id="cb192-16" data-line-number="16"><span class="kw">sqldf</span>(sql_string)</a></code></pre></div>
<pre><code>##                       job_title employee_cnt avg_org_tenure
## 1         Community Coordinator           58       9.224138
## 2            Content Strategist           72       8.152778
## 3            Creative Assistant           44       9.454545
## 4                  Data Analyst           72       8.666667
## 5  Digital Marketing Specialist           70       8.228571
## 6                      Director           10       8.100000
## 7                       Manager           50       9.340000
## 8                SEO Specialist           62       9.596774
## 9       Social Media Strategist           56      10.000000
## 10               Vice President            2       7.500000</code></pre>
<p>The output shows that there are only 2 Vice Presidents and 10 Directors on the Social Marketing team, while other job titles are much more common.</p>
<p>Since relatively few employees are Vice Presidents or Directors, let’s use the <code>HAVING</code> clause to only show average organization tenure for Social Marketing team jobs with more than 10 employees:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1"><span class="co"># Store SQL query as a character string using the paste() function</span></a>
<a class="sourceLine" id="cb194-2" data-line-number="2">sql_string &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;SELECT</span></a>
<a class="sourceLine" id="cb194-3" data-line-number="3"><span class="st">                      job_title,</span></a>
<a class="sourceLine" id="cb194-4" data-line-number="4"><span class="st">                      COUNT(*) AS employee_cnt,</span></a>
<a class="sourceLine" id="cb194-5" data-line-number="5"><span class="st">                      AVG(org_tenure) AS avg_org_tenure</span></a>
<a class="sourceLine" id="cb194-6" data-line-number="6"><span class="st">                    FROM</span></a>
<a class="sourceLine" id="cb194-7" data-line-number="7"><span class="st">                      demographics</span></a>
<a class="sourceLine" id="cb194-8" data-line-number="8"><span class="st">                    WHERE</span></a>
<a class="sourceLine" id="cb194-9" data-line-number="9"><span class="st">                      team = &#39;Social Marketing&#39;</span></a>
<a class="sourceLine" id="cb194-10" data-line-number="10"><span class="st">                    GROUP BY</span></a>
<a class="sourceLine" id="cb194-11" data-line-number="11"><span class="st">                      job_title</span></a>
<a class="sourceLine" id="cb194-12" data-line-number="12"><span class="st">                    HAVING</span></a>
<a class="sourceLine" id="cb194-13" data-line-number="13"><span class="st">                      COUNT(*) &gt; 10</span></a>
<a class="sourceLine" id="cb194-14" data-line-number="14"><span class="st">                    ORDER BY</span></a>
<a class="sourceLine" id="cb194-15" data-line-number="15"><span class="st">                      job_title&quot;</span>)</a>
<a class="sourceLine" id="cb194-16" data-line-number="16"></a>
<a class="sourceLine" id="cb194-17" data-line-number="17"><span class="co"># Execute SQL query</span></a>
<a class="sourceLine" id="cb194-18" data-line-number="18"><span class="kw">sqldf</span>(sql_string)</a></code></pre></div>
<pre><code>##                      job_title employee_cnt avg_org_tenure
## 1        Community Coordinator           58       9.224138
## 2           Content Strategist           72       8.152778
## 3           Creative Assistant           44       9.454545
## 4                 Data Analyst           72       8.666667
## 5 Digital Marketing Specialist           70       8.228571
## 6                      Manager           50       9.340000
## 7               SEO Specialist           62       9.596774
## 8      Social Media Strategist           56      10.000000</code></pre>
<p>In a practical setting, the required data are rarely contained within a single table. Therefore, we must query multiple tables and join them together. This is done using a <strong>Primary Key (PK)</strong>, which is a unique identifier that can be used to relate records from one table to corresponding records in another.</p>
<p>To illustrate how this works, let’s partition the fields used in the previous SQL queries into three separate data frames. For many people analytics projects, employee id is the PK since this identifer for one employee should not be assigned to another employee – past, present, or future. Email or network id may also be a suitable PK. We will ensure the employee_id column is present in each of the three data frames to facilitate subsequent joins:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1"><span class="co"># Partition select columns into three data frames</span></a>
<a class="sourceLine" id="cb196-2" data-line-number="2">job_df &lt;-<span class="st"> </span>demographics[, <span class="kw">c</span>(<span class="st">&quot;employee_id&quot;</span>, <span class="st">&quot;job_title&quot;</span>)]</a>
<a class="sourceLine" id="cb196-3" data-line-number="3">tenure_df &lt;-<span class="st"> </span>demographics[, <span class="kw">c</span>(<span class="st">&quot;employee_id&quot;</span>, <span class="st">&quot;org_tenure&quot;</span>)]</a>
<a class="sourceLine" id="cb196-4" data-line-number="4">team_df &lt;-<span class="st"> </span>demographics[, <span class="kw">c</span>(<span class="st">&quot;employee_id&quot;</span>, <span class="st">&quot;team&quot;</span>)]</a></code></pre></div>
<p>Next, we will query our three new dataframes to return the average organization tenure for Social Marketing team jobs with more than 10 employees. For this, we will leverage an <code>INNER JOIN</code>, which will return records only for employee ids which are present in all three data frames. For example, if a record exists in <code>job_df</code> and <code>tenure_df</code> for a particular employee id, but there is no team designation for it in <code>team_df</code>, that employee id would not be included in the output.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1"><span class="co"># Store SQL query as a character string using the paste() function</span></a>
<a class="sourceLine" id="cb197-2" data-line-number="2">sql_string &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;SELECT</span></a>
<a class="sourceLine" id="cb197-3" data-line-number="3"><span class="st">                      job_title,</span></a>
<a class="sourceLine" id="cb197-4" data-line-number="4"><span class="st">                      COUNT(*) AS employee_cnt,</span></a>
<a class="sourceLine" id="cb197-5" data-line-number="5"><span class="st">                      AVG(org_tenure) AS avg_org_tenure</span></a>
<a class="sourceLine" id="cb197-6" data-line-number="6"><span class="st">                    FROM</span></a>
<a class="sourceLine" id="cb197-7" data-line-number="7"><span class="st">                      job_df</span></a>
<a class="sourceLine" id="cb197-8" data-line-number="8"><span class="st">                        INNER JOIN</span></a>
<a class="sourceLine" id="cb197-9" data-line-number="9"><span class="st">                      tenure_df</span></a>
<a class="sourceLine" id="cb197-10" data-line-number="10"><span class="st">                        ON</span></a>
<a class="sourceLine" id="cb197-11" data-line-number="11"><span class="st">                      job_df.employee_id = tenure_df.employee_id</span></a>
<a class="sourceLine" id="cb197-12" data-line-number="12"><span class="st">                        INNER JOIN</span></a>
<a class="sourceLine" id="cb197-13" data-line-number="13"><span class="st">                      team_df</span></a>
<a class="sourceLine" id="cb197-14" data-line-number="14"><span class="st">                        ON</span></a>
<a class="sourceLine" id="cb197-15" data-line-number="15"><span class="st">                      job_df.employee_id = team_df.employee_id</span></a>
<a class="sourceLine" id="cb197-16" data-line-number="16"><span class="st">                    WHERE</span></a>
<a class="sourceLine" id="cb197-17" data-line-number="17"><span class="st">                      team = &#39;Social Marketing&#39;</span></a>
<a class="sourceLine" id="cb197-18" data-line-number="18"><span class="st">                    GROUP BY</span></a>
<a class="sourceLine" id="cb197-19" data-line-number="19"><span class="st">                      job_title</span></a>
<a class="sourceLine" id="cb197-20" data-line-number="20"><span class="st">                    HAVING</span></a>
<a class="sourceLine" id="cb197-21" data-line-number="21"><span class="st">                      COUNT(*) &gt; 10</span></a>
<a class="sourceLine" id="cb197-22" data-line-number="22"><span class="st">                    ORDER BY</span></a>
<a class="sourceLine" id="cb197-23" data-line-number="23"><span class="st">                      job_title&quot;</span>)</a>
<a class="sourceLine" id="cb197-24" data-line-number="24"></a>
<a class="sourceLine" id="cb197-25" data-line-number="25"><span class="co"># Execute SQL query</span></a>
<a class="sourceLine" id="cb197-26" data-line-number="26"><span class="kw">sqldf</span>(sql_string)</a></code></pre></div>
<pre><code>##                      job_title employee_cnt avg_org_tenure
## 1        Community Coordinator           58       9.224138
## 2           Content Strategist           72       8.152778
## 3           Creative Assistant           44       9.454545
## 4                 Data Analyst           72       8.666667
## 5 Digital Marketing Specialist           70       8.228571
## 6                      Manager           50       9.340000
## 7               SEO Specialist           62       9.596774
## 8      Social Media Strategist           56      10.000000</code></pre>
<p>Note that the <code>INNER JOIN</code> in this SQL query was structured such that both <code>tenure_df</code> and <code>team_df</code> were joined to <code>job_df</code> via the <code>employee_id</code> column. We could have instead joined <code>job_df</code> to <code>team_df</code> and achieved the same result since all employee ids exist in all three data frames in this case.</p>
<p>If it were possible for all employee ids to exist in <code>job_df</code> but not in either <code>tenure_df</code> or <code>team_df</code>, we could leverage a <code>LEFT JOIN</code> to ensure all records from <code>job_df</code> are included in the output irrespective of whether they have matches in <code>tenure_df</code> or <code>team_df</code>:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1"><span class="co"># Store SQL query as a character string using the paste() function</span></a>
<a class="sourceLine" id="cb199-2" data-line-number="2">sql_string &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;SELECT</span></a>
<a class="sourceLine" id="cb199-3" data-line-number="3"><span class="st">                      job_title,</span></a>
<a class="sourceLine" id="cb199-4" data-line-number="4"><span class="st">                      COUNT(*) AS employee_cnt,</span></a>
<a class="sourceLine" id="cb199-5" data-line-number="5"><span class="st">                      AVG(org_tenure) AS avg_org_tenure</span></a>
<a class="sourceLine" id="cb199-6" data-line-number="6"><span class="st">                    FROM</span></a>
<a class="sourceLine" id="cb199-7" data-line-number="7"><span class="st">                      job_df</span></a>
<a class="sourceLine" id="cb199-8" data-line-number="8"><span class="st">                        LEFT JOIN</span></a>
<a class="sourceLine" id="cb199-9" data-line-number="9"><span class="st">                      tenure_df</span></a>
<a class="sourceLine" id="cb199-10" data-line-number="10"><span class="st">                        ON</span></a>
<a class="sourceLine" id="cb199-11" data-line-number="11"><span class="st">                      job_df.employee_id = tenure_df.employee_id</span></a>
<a class="sourceLine" id="cb199-12" data-line-number="12"><span class="st">                        LEFT JOIN</span></a>
<a class="sourceLine" id="cb199-13" data-line-number="13"><span class="st">                      team_df</span></a>
<a class="sourceLine" id="cb199-14" data-line-number="14"><span class="st">                        ON</span></a>
<a class="sourceLine" id="cb199-15" data-line-number="15"><span class="st">                      job_df.employee_id = team_df.employee_id</span></a>
<a class="sourceLine" id="cb199-16" data-line-number="16"><span class="st">                    WHERE</span></a>
<a class="sourceLine" id="cb199-17" data-line-number="17"><span class="st">                      team = &#39;Social Marketing&#39;</span></a>
<a class="sourceLine" id="cb199-18" data-line-number="18"><span class="st">                    GROUP BY</span></a>
<a class="sourceLine" id="cb199-19" data-line-number="19"><span class="st">                      job_title</span></a>
<a class="sourceLine" id="cb199-20" data-line-number="20"><span class="st">                    HAVING</span></a>
<a class="sourceLine" id="cb199-21" data-line-number="21"><span class="st">                      COUNT(*) &gt; 10</span></a>
<a class="sourceLine" id="cb199-22" data-line-number="22"><span class="st">                    ORDER BY</span></a>
<a class="sourceLine" id="cb199-23" data-line-number="23"><span class="st">                      job_title&quot;</span>)</a>
<a class="sourceLine" id="cb199-24" data-line-number="24"></a>
<a class="sourceLine" id="cb199-25" data-line-number="25"><span class="co"># Execute SQL query</span></a>
<a class="sourceLine" id="cb199-26" data-line-number="26"><span class="kw">sqldf</span>(sql_string)</a></code></pre></div>
<pre><code>##                      job_title employee_cnt avg_org_tenure
## 1        Community Coordinator           58       9.224138
## 2           Content Strategist           72       8.152778
## 3           Creative Assistant           44       9.454545
## 4                 Data Analyst           72       8.666667
## 5 Digital Marketing Specialist           70       8.228571
## 6                      Manager           50       9.340000
## 7               SEO Specialist           62       9.596774
## 8      Social Media Strategist           56      10.000000</code></pre>
<p><strong>Subqueries</strong> are nested SQL queries that allow us to pass results from an inner query to the main outer query.</p>
<p>For example, instead of applying the <code>team = 'Social Marketing</code> condition in the <code>WHERE</code> clause, we can use a subquery to pass a list of Social Marketing employee ids into the outer query for filtering. In this case, we would not need to include <code>team_df</code> in the join conditions of our main query:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1"><span class="co"># Store SQL query as a character string using the paste() function</span></a>
<a class="sourceLine" id="cb201-2" data-line-number="2">sql_string &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;SELECT</span></a>
<a class="sourceLine" id="cb201-3" data-line-number="3"><span class="st">                      job_title,</span></a>
<a class="sourceLine" id="cb201-4" data-line-number="4"><span class="st">                      COUNT(*) AS employee_cnt,</span></a>
<a class="sourceLine" id="cb201-5" data-line-number="5"><span class="st">                      AVG(org_tenure) AS avg_org_tenure</span></a>
<a class="sourceLine" id="cb201-6" data-line-number="6"><span class="st">                    FROM</span></a>
<a class="sourceLine" id="cb201-7" data-line-number="7"><span class="st">                      job_df</span></a>
<a class="sourceLine" id="cb201-8" data-line-number="8"><span class="st">                        LEFT JOIN</span></a>
<a class="sourceLine" id="cb201-9" data-line-number="9"><span class="st">                      tenure_df</span></a>
<a class="sourceLine" id="cb201-10" data-line-number="10"><span class="st">                        ON</span></a>
<a class="sourceLine" id="cb201-11" data-line-number="11"><span class="st">                      job_df.employee_id = tenure_df.employee_id</span></a>
<a class="sourceLine" id="cb201-12" data-line-number="12"><span class="st">                    WHERE</span></a>
<a class="sourceLine" id="cb201-13" data-line-number="13"><span class="st">                      job_df.employee_id IN (SELECT employee_id FROM team_df WHERE team = &#39;Social Marketing&#39;)</span></a>
<a class="sourceLine" id="cb201-14" data-line-number="14"><span class="st">                    GROUP BY</span></a>
<a class="sourceLine" id="cb201-15" data-line-number="15"><span class="st">                      job_title</span></a>
<a class="sourceLine" id="cb201-16" data-line-number="16"><span class="st">                    HAVING</span></a>
<a class="sourceLine" id="cb201-17" data-line-number="17"><span class="st">                      COUNT(*) &gt; 10</span></a>
<a class="sourceLine" id="cb201-18" data-line-number="18"><span class="st">                    ORDER BY</span></a>
<a class="sourceLine" id="cb201-19" data-line-number="19"><span class="st">                      job_title&quot;</span>)</a>
<a class="sourceLine" id="cb201-20" data-line-number="20"></a>
<a class="sourceLine" id="cb201-21" data-line-number="21"><span class="co"># Execute SQL query</span></a>
<a class="sourceLine" id="cb201-22" data-line-number="22"><span class="kw">sqldf</span>(sql_string)</a></code></pre></div>
<pre><code>##                      job_title employee_cnt avg_org_tenure
## 1        Community Coordinator           58       9.224138
## 2           Content Strategist           72       8.152778
## 3           Creative Assistant           44       9.454545
## 4                 Data Analyst           72       8.666667
## 5 Digital Marketing Specialist           70       8.228571
## 6                      Manager           50       9.340000
## 7               SEO Specialist           62       9.596774
## 8      Social Media Strategist           56      10.000000</code></pre>
<p>An alternative to a subquery is creating a <strong>derived table</strong> in the <code>FROM</code> clause using a SQL statement. When using an <code>INNER JOIN</code> to connect <code>job_df</code> and <code>tenure_df</code> to the derived table containing Social Marketing employee ids, any records in <code>job_df</code> or <code>tenure_df</code> that do not relate to Social Marketing employees will be dropped. With this approach, we would not need a <code>WHERE</code> clause:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1"><span class="co"># Store SQL query as a character string using the paste() function</span></a>
<a class="sourceLine" id="cb203-2" data-line-number="2">sql_string &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;SELECT</span></a>
<a class="sourceLine" id="cb203-3" data-line-number="3"><span class="st">                      job_title,</span></a>
<a class="sourceLine" id="cb203-4" data-line-number="4"><span class="st">                      COUNT(*) AS employee_cnt,</span></a>
<a class="sourceLine" id="cb203-5" data-line-number="5"><span class="st">                      AVG(org_tenure) AS avg_org_tenure</span></a>
<a class="sourceLine" id="cb203-6" data-line-number="6"><span class="st">                    FROM</span></a>
<a class="sourceLine" id="cb203-7" data-line-number="7"><span class="st">                      job_df</span></a>
<a class="sourceLine" id="cb203-8" data-line-number="8"><span class="st">                        INNER JOIN</span></a>
<a class="sourceLine" id="cb203-9" data-line-number="9"><span class="st">                      tenure_df</span></a>
<a class="sourceLine" id="cb203-10" data-line-number="10"><span class="st">                        ON</span></a>
<a class="sourceLine" id="cb203-11" data-line-number="11"><span class="st">                      job_df.employee_id = tenure_df.employee_id</span></a>
<a class="sourceLine" id="cb203-12" data-line-number="12"><span class="st">                        INNER JOIN</span></a>
<a class="sourceLine" id="cb203-13" data-line-number="13"><span class="st">                      (SELECT employee_id FROM team_df WHERE team = &#39;Social Marketing&#39;) social_mktg_ids</span></a>
<a class="sourceLine" id="cb203-14" data-line-number="14"><span class="st">                        ON</span></a>
<a class="sourceLine" id="cb203-15" data-line-number="15"><span class="st">                      job_df.employee_id = social_mktg_ids.employee_id</span></a>
<a class="sourceLine" id="cb203-16" data-line-number="16"><span class="st">                    GROUP BY</span></a>
<a class="sourceLine" id="cb203-17" data-line-number="17"><span class="st">                      job_title</span></a>
<a class="sourceLine" id="cb203-18" data-line-number="18"><span class="st">                    HAVING</span></a>
<a class="sourceLine" id="cb203-19" data-line-number="19"><span class="st">                      COUNT(*) &gt; 10</span></a>
<a class="sourceLine" id="cb203-20" data-line-number="20"><span class="st">                    ORDER BY</span></a>
<a class="sourceLine" id="cb203-21" data-line-number="21"><span class="st">                      job_title&quot;</span>)</a>
<a class="sourceLine" id="cb203-22" data-line-number="22"></a>
<a class="sourceLine" id="cb203-23" data-line-number="23"><span class="co"># Execute SQL query</span></a>
<a class="sourceLine" id="cb203-24" data-line-number="24"><span class="kw">sqldf</span>(sql_string)</a></code></pre></div>
<pre><code>##                      job_title employee_cnt avg_org_tenure
## 1        Community Coordinator           58       9.224138
## 2           Content Strategist           72       8.152778
## 3           Creative Assistant           44       9.454545
## 4                 Data Analyst           72       8.666667
## 5 Digital Marketing Specialist           70       8.228571
## 6                      Manager           50       9.340000
## 7               SEO Specialist           62       9.596774
## 8      Social Media Strategist           56      10.000000</code></pre>
<p><strong>Window functions</strong> are used for performing calculations over a set of rows without collapsing the records. Unlike the aggregate functions we’ve covered, window functions do not collapse rows into a single value; the calculated value is returned for each of the rows over which the calculation was performed.</p>
<p>For example, we can assign an organization tenure rank by Social Marketing job using the <code>RANK()</code> and <code>OVER()</code> functions in the <code>SELECT</code> clause. The <code>PARTITION BY</code> argument functions like a <code>GROUP BY</code> clause but without collapsing rows, while the <code>ORDER BY</code> argument sorts the records in ascending (<code>ASC</code>) or descending (<code>DESC</code>) order for proper ranking:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1"><span class="co"># Store SQL query as a character string using the paste() function</span></a>
<a class="sourceLine" id="cb205-2" data-line-number="2"><span class="co"># Since employee_id is a column in multiple tables used in this query, we need to indicate a specific table to include employee_id in the output</span></a>
<a class="sourceLine" id="cb205-3" data-line-number="3">sql_string &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;SELECT</span></a>
<a class="sourceLine" id="cb205-4" data-line-number="4"><span class="st">                      job_df.employee_id,</span></a>
<a class="sourceLine" id="cb205-5" data-line-number="5"><span class="st">                      job_title,</span></a>
<a class="sourceLine" id="cb205-6" data-line-number="6"><span class="st">                      org_tenure,</span></a>
<a class="sourceLine" id="cb205-7" data-line-number="7"><span class="st">                      RANK () OVER (PARTITION BY job_title ORDER BY org_tenure DESC) AS org_tenure_rank</span></a>
<a class="sourceLine" id="cb205-8" data-line-number="8"><span class="st">                    FROM</span></a>
<a class="sourceLine" id="cb205-9" data-line-number="9"><span class="st">                      job_df</span></a>
<a class="sourceLine" id="cb205-10" data-line-number="10"><span class="st">                        INNER JOIN</span></a>
<a class="sourceLine" id="cb205-11" data-line-number="11"><span class="st">                      tenure_df</span></a>
<a class="sourceLine" id="cb205-12" data-line-number="12"><span class="st">                        ON</span></a>
<a class="sourceLine" id="cb205-13" data-line-number="13"><span class="st">                      job_df.employee_id = tenure_df.employee_id</span></a>
<a class="sourceLine" id="cb205-14" data-line-number="14"><span class="st">                        INNER JOIN</span></a>
<a class="sourceLine" id="cb205-15" data-line-number="15"><span class="st">                      (SELECT employee_id FROM team_df WHERE team = &#39;Social Marketing&#39;) social_mktg_ids</span></a>
<a class="sourceLine" id="cb205-16" data-line-number="16"><span class="st">                        ON</span></a>
<a class="sourceLine" id="cb205-17" data-line-number="17"><span class="st">                      job_df.employee_id = social_mktg_ids.employee_id</span></a>
<a class="sourceLine" id="cb205-18" data-line-number="18"><span class="st">                    ORDER BY</span></a>
<a class="sourceLine" id="cb205-19" data-line-number="19"><span class="st">                      job_title,</span></a>
<a class="sourceLine" id="cb205-20" data-line-number="20"><span class="st">                      org_tenure_rank&quot;</span>)</a>
<a class="sourceLine" id="cb205-21" data-line-number="21"></a>
<a class="sourceLine" id="cb205-22" data-line-number="22"><span class="co"># Execute SQL query</span></a>
<a class="sourceLine" id="cb205-23" data-line-number="23"><span class="kw">sqldf</span>(sql_string)</a></code></pre></div>
<pre><code>##     employee_id                    job_title org_tenure org_tenure_rank
## 1          1236        Community Coordinator         20               1
## 2          1322        Community Coordinator         20               1
## 3          1264        Community Coordinator         19               3
## 4          1348        Community Coordinator         19               3
## 5          3759        Community Coordinator         19               3
## 6          3694        Community Coordinator         18               6
## 7          1257        Community Coordinator         17               7
## 8          3702        Community Coordinator         17               7
## 9          1344        Community Coordinator         16               9
## 10         3659        Community Coordinator         16               9
## 11         1261        Community Coordinator         14              11
## 12         1340        Community Coordinator         14              11
## 13         1265        Community Coordinator         13              13
## 14         3698        Community Coordinator         13              13
## 15         3672        Community Coordinator         12              15
## 16         3680        Community Coordinator         12              15
## 17         1241        Community Coordinator         11              17
## 18         1406        Community Coordinator         11              17
## 19         3701        Community Coordinator         11              17
## 20         3827        Community Coordinator         11              17
## 21         1312        Community Coordinator         10              21
## 22         3781        Community Coordinator         10              21
## 23         3790        Community Coordinator         10              21
## 24         1239        Community Coordinator          9              24
## 25         1243        Community Coordinator          9              24
## 26         1278        Community Coordinator          9              24
## 27         1350        Community Coordinator          9              24
## 28         1343        Community Coordinator          8              28
## 29         1351        Community Coordinator          8              28
## 30         3657        Community Coordinator          8              28
## 31         3678        Community Coordinator          8              28
## 32         3710        Community Coordinator          8              28
## 33         1226        Community Coordinator          7              33
## 34         1287        Community Coordinator          7              33
## 35         3663        Community Coordinator          7              33
## 36         3679        Community Coordinator          7              33
## 37         3780        Community Coordinator          7              33
## 38         1220        Community Coordinator          6              38
## 39         1360        Community Coordinator          6              38
## 40         3673        Community Coordinator          6              38
## 41         3777        Community Coordinator          6              38
## 42         3785        Community Coordinator          6              38
## 43         3788        Community Coordinator          6              38
## 44         1222        Community Coordinator          5              44
## 45         1242        Community Coordinator          5              44
## 46         1390        Community Coordinator          5              44
## 47         3676        Community Coordinator          5              44
## 48         3724        Community Coordinator          5              44
## 49         1235        Community Coordinator          4              49
## 50         1273        Community Coordinator          4              49
## 51         3715        Community Coordinator          4              49
## 52         3830        Community Coordinator          4              49
## 53         1393        Community Coordinator          3              53
## 54         3797        Community Coordinator          3              53
## 55         1353        Community Coordinator          2              55
## 56         3749        Community Coordinator          2              55
## 57         3787        Community Coordinator          2              55
## 58         3843        Community Coordinator          2              55
## 59         1209           Content Strategist         20               1
## 60         1197           Content Strategist         19               2
## 61         1221           Content Strategist         18               3
## 62         1363           Content Strategist         18               3
## 63         3783           Content Strategist         18               3
## 64         1201           Content Strategist         17               6
## 65         3667           Content Strategist         17               6
## 66         3703           Content Strategist         17               6
## 67         3823           Content Strategist         16               9
## 68         3666           Content Strategist         14              10
## 69         1229           Content Strategist         13              11
## 70         1262           Content Strategist         13              11
## 71         1367           Content Strategist         13              11
## 72         3638           Content Strategist         13              11
## 73         3820           Content Strategist         13              11
## 74         1247           Content Strategist         12              16
## 75         1260           Content Strategist         12              16
## 76         1266           Content Strategist         12              16
## 77         1293           Content Strategist         12              16
## 78         1394           Content Strategist         11              20
## 79         1217           Content Strategist         10              21
## 80         1250           Content Strategist         10              21
## 81         1218           Content Strategist          9              23
## 82         1223           Content Strategist          9              23
## 83         1263           Content Strategist          9              23
## 84         3660           Content Strategist          9              23
## 85         3716           Content Strategist          8              27
## 86         3729           Content Strategist          8              27
## 87         3763           Content Strategist          8              27
## 88         3800           Content Strategist          8              27
## 89         1299           Content Strategist          7              31
## 90         3635           Content Strategist          7              31
## 91         3658           Content Strategist          7              31
## 92         3739           Content Strategist          7              31
## 93         3831           Content Strategist          7              31
## 94         3832           Content Strategist          7              31
## 95         1279           Content Strategist          6              37
## 96         1283           Content Strategist          6              37
## 97         1326           Content Strategist          6              37
## 98         1402           Content Strategist          6              37
## 99         3645           Content Strategist          6              37
## 100        3700           Content Strategist          6              37
## 101        3720           Content Strategist          6              37
## 102        3736           Content Strategist          6              37
## 103        3804           Content Strategist          6              37
## 104        1198           Content Strategist          5              46
## 105        1230           Content Strategist          5              46
## 106        1302           Content Strategist          5              46
## 107        3684           Content Strategist          5              46
## 108        3687           Content Strategist          5              46
## 109        3730           Content Strategist          5              46
## 110        3784           Content Strategist          5              46
## 111        1208           Content Strategist          4              53
## 112        1216           Content Strategist          4              53
## 113        1276           Content Strategist          4              53
## 114        1292           Content Strategist          4              53
## 115        1347           Content Strategist          4              53
## 116        1361           Content Strategist          4              53
## 117        1395           Content Strategist          4              53
## 118        3634           Content Strategist          4              53
## 119        3646           Content Strategist          4              53
## 120        3697           Content Strategist          4              53
## 121        3699           Content Strategist          4              53
## 122        3713           Content Strategist          4              53
## 123        3839           Content Strategist          4              53
## 124        1346           Content Strategist          3              66
## 125        1383           Content Strategist          3              66
## 126        3654           Content Strategist          3              66
## 127        3655           Content Strategist          3              66
## 128        1386           Content Strategist          2              70
## 129        3653           Content Strategist          2              70
## 130        3798           Content Strategist          2              70
## 131        3786           Creative Assistant         20               1
## 132        3808           Creative Assistant         20               1
## 133        1281           Creative Assistant         19               3
## 134        1297           Creative Assistant         19               3
## 135        1345           Creative Assistant         19               3
## 136        1296           Creative Assistant         18               6
## 137        1413           Creative Assistant         18               6
## 138        3769           Creative Assistant         18               6
## 139        1240           Creative Assistant         15               9
## 140        1254           Creative Assistant         15               9
## 141        1392           Creative Assistant         15               9
## 142        3691           Creative Assistant         14              12
## 143        3774           Creative Assistant         14              12
## 144        1337           Creative Assistant         12              14
## 145        1401           Creative Assistant         12              14
## 146        3718           Creative Assistant         11              16
## 147        1238           Creative Assistant         10              17
## 148        1373           Creative Assistant          9              18
## 149        3770           Creative Assistant          9              18
## 150        3840           Creative Assistant          9              18
## 151        1272           Creative Assistant          8              21
## 152        1219           Creative Assistant          7              22
## 153        1280           Creative Assistant          7              22
## 154        3717           Creative Assistant          7              22
## 155        3848           Creative Assistant          7              22
## 156        1329           Creative Assistant          6              26
## 157        1371           Creative Assistant          6              26
## 158        1411           Creative Assistant          6              26
## 159        3733           Creative Assistant          6              26
## 160        3734           Creative Assistant          6              26
## 161        3782           Creative Assistant          6              26
## 162        1333           Creative Assistant          5              32
## 163        1403           Creative Assistant          5              32
## 164        3677           Creative Assistant          5              32
## 165        3709           Creative Assistant          5              32
## 166        3838           Creative Assistant          5              32
## 167        3675           Creative Assistant          4              37
## 168        3810           Creative Assistant          4              37
## 169        3829           Creative Assistant          4              37
## 170        1332           Creative Assistant          3              40
## 171        3656           Creative Assistant          3              40
## 172        1349           Creative Assistant          2              42
## 173        3850           Creative Assistant          2              42
## 174        3766           Creative Assistant          1              44
## 175        1200                 Data Analyst         19               1
## 176        1245                 Data Analyst         19               1
## 177        1400                 Data Analyst         19               1
## 178        3826                 Data Analyst         19               1
## 179        1275                 Data Analyst         18               5
## 180        3708                 Data Analyst         18               5
## 181        1412                 Data Analyst         17               7
## 182        1290                 Data Analyst         15               8
## 183        1389                 Data Analyst         15               8
## 184        3802                 Data Analyst         15               8
## 185        1369                 Data Analyst         14              11
## 186        3761                 Data Analyst         14              11
## 187        3776                 Data Analyst         14              11
## 188        3836                 Data Analyst         14              11
## 189        1365                 Data Analyst         13              15
## 190        3747                 Data Analyst         13              15
## 191        3758                 Data Analyst         13              15
## 192        1359                 Data Analyst         12              18
## 193        3661                 Data Analyst         12              18
## 194        3682                 Data Analyst         12              18
## 195        3835                 Data Analyst         12              18
## 196        1212                 Data Analyst         11              22
## 197        1271                 Data Analyst         11              22
## 198        3732                 Data Analyst         11              22
## 199        1310                 Data Analyst         10              25
## 200        1398                 Data Analyst         10              25
## 201        3636                 Data Analyst         10              25
## 202        1249                 Data Analyst          9              28
## 203        1274                 Data Analyst          9              28
## 204        1339                 Data Analyst          9              28
## 205        1399                 Data Analyst          9              28
## 206        3744                 Data Analyst          9              28
## 207        1356                 Data Analyst          8              33
## 208        3647                 Data Analyst          8              33
## 209        3711                 Data Analyst          8              33
## 210        3817                 Data Analyst          8              33
## 211        1210                 Data Analyst          7              37
## 212        1324                 Data Analyst          7              37
## 213        3686                 Data Analyst          7              37
## 214        3707                 Data Analyst          7              37
## 215        3793                 Data Analyst          7              37
## 216        1227                 Data Analyst          6              42
## 217        1268                 Data Analyst          6              42
## 218        1270                 Data Analyst          6              42
## 219        1295                 Data Analyst          6              42
## 220        1303                 Data Analyst          6              42
## 221        1307                 Data Analyst          6              42
## 222        3712                 Data Analyst          6              42
## 223        3772                 Data Analyst          6              42
## 224        3806                 Data Analyst          6              42
## 225        1224                 Data Analyst          5              51
## 226        3664                 Data Analyst          5              51
## 227        3727                 Data Analyst          5              51
## 228        3740                 Data Analyst          5              51
## 229        3754                 Data Analyst          5              51
## 230        3849                 Data Analyst          5              51
## 231        1225                 Data Analyst          4              57
## 232        1380                 Data Analyst          4              57
## 233        3649                 Data Analyst          4              57
## 234        3662                 Data Analyst          4              57
## 235        3796                 Data Analyst          4              57
## 236        3822                 Data Analyst          4              57
## 237        1199                 Data Analyst          3              63
## 238        1237                 Data Analyst          3              63
## 239        1317                 Data Analyst          3              63
## 240        1335                 Data Analyst          3              63
## 241        1385                 Data Analyst          3              63
## 242        3674                 Data Analyst          3              63
## 243        3637                 Data Analyst          2              69
## 244        3705                 Data Analyst          2              69
## 245        1321                 Data Analyst          1              71
## 246        3837                 Data Analyst          1              71
## 247        3641 Digital Marketing Specialist         20               1
## 248        3778 Digital Marketing Specialist         20               1
## 249        1311 Digital Marketing Specialist         19               3
## 250        3745 Digital Marketing Specialist         19               3
## 251        1410 Digital Marketing Specialist         18               5
## 252        3643 Digital Marketing Specialist         17               6
## 253        3668 Digital Marketing Specialist         15               7
## 254        3752 Digital Marketing Specialist         15               7
## 255        1234 Digital Marketing Specialist         14               9
## 256        1284 Digital Marketing Specialist         14               9
## 257        1341 Digital Marketing Specialist         14               9
## 258        1381 Digital Marketing Specialist         14               9
## 259        3721 Digital Marketing Specialist         14               9
## 260        3741 Digital Marketing Specialist         14               9
## 261        3771 Digital Marketing Specialist         14               9
## 262        1304 Digital Marketing Specialist         12              16
## 263        1248 Digital Marketing Specialist         11              17
## 264        1308 Digital Marketing Specialist         11              17
## 265        1334 Digital Marketing Specialist         11              17
## 266        3685 Digital Marketing Specialist         11              17
## 267        3640 Digital Marketing Specialist         10              21
## 268        3834 Digital Marketing Specialist         10              21
## 269        1231 Digital Marketing Specialist          9              23
## 270        1300 Digital Marketing Specialist          9              23
## 271        3650 Digital Marketing Specialist          9              23
## 272        3688 Digital Marketing Specialist          9              23
## 273        3748 Digital Marketing Specialist          9              23
## 274        3811 Digital Marketing Specialist          9              23
## 275        1328 Digital Marketing Specialist          8              29
## 276        3719 Digital Marketing Specialist          8              29
## 277        3753 Digital Marketing Specialist          8              29
## 278        3791 Digital Marketing Specialist          8              29
## 279        3818 Digital Marketing Specialist          8              29
## 280        3847 Digital Marketing Specialist          8              29
## 281        1206 Digital Marketing Specialist          7              35
## 282        1213 Digital Marketing Specialist          7              35
## 283        3665 Digital Marketing Specialist          7              35
## 284        3760 Digital Marketing Specialist          7              35
## 285        1251 Digital Marketing Specialist          6              39
## 286        1282 Digital Marketing Specialist          6              39
## 287        1323 Digital Marketing Specialist          6              39
## 288        1327 Digital Marketing Specialist          6              39
## 289        1374 Digital Marketing Specialist          6              39
## 290        3764 Digital Marketing Specialist          6              39
## 291        3794 Digital Marketing Specialist          6              39
## 292        1244 Digital Marketing Specialist          5              46
## 293        1316 Digital Marketing Specialist          5              46
## 294        1338 Digital Marketing Specialist          5              46
## 295        1354 Digital Marketing Specialist          5              46
## 296        3723 Digital Marketing Specialist          5              46
## 297        3737 Digital Marketing Specialist          5              46
## 298        1203 Digital Marketing Specialist          4              52
## 299        1228 Digital Marketing Specialist          4              52
## 300        1286 Digital Marketing Specialist          4              52
## 301        1289 Digital Marketing Specialist          4              52
## 302        1315 Digital Marketing Specialist          4              52
## 303        1397 Digital Marketing Specialist          4              52
## 304        3681 Digital Marketing Specialist          4              52
## 305        3746 Digital Marketing Specialist          4              52
## 306        1204 Digital Marketing Specialist          3              60
## 307        1336 Digital Marketing Specialist          3              60
## 308        3671 Digital Marketing Specialist          3              60
## 309        3765 Digital Marketing Specialist          3              60
## 310        3773 Digital Marketing Specialist          3              60
## 311        3775 Digital Marketing Specialist          3              60
## 312        1232 Digital Marketing Specialist          2              66
## 313        3726 Digital Marketing Specialist          2              66
## 314        1309 Digital Marketing Specialist          1              68
## 315        1357 Digital Marketing Specialist          1              68
## 316        3669 Digital Marketing Specialist          1              68
## 317        3475                     Director         15               1
## 318        3471                     Director         12               2
## 319        1035                     Director         10               3
## 320        1037                     Director          9               4
## 321        1034                     Director          7               5
## 322        3472                     Director          7               5
## 323        1036                     Director          6               7
## 324        1038                     Director          6               7
## 325        3473                     Director          5               9
## 326        3474                     Director          4              10
## 327        1157                      Manager         20               1
## 328        1161                      Manager         20               1
## 329        3578                      Manager         20               1
## 330        3599                      Manager         20               1
## 331        3588                      Manager         18               5
## 332        3590                      Manager         17               6
## 333        3580                      Manager         16               7
## 334        1146                      Manager         15               8
## 335        1156                      Manager         15               8
## 336        3576                      Manager         15               8
## 337        3583                      Manager         14              11
## 338        1152                      Manager         13              12
## 339        3600                      Manager         13              12
## 340        1139                      Manager         12              14
## 341        1150                      Manager         12              14
## 342        3598                      Manager         12              14
## 343        1141                      Manager         11              17
## 344        1144                      Manager         11              17
## 345        3591                      Manager         11              17
## 346        1148                      Manager         10              20
## 347        3581                      Manager          9              21
## 348        3584                      Manager          9              21
## 349        1140                      Manager          8              23
## 350        1154                      Manager          8              23
## 351        3596                      Manager          8              23
## 352        1151                      Manager          7              26
## 353        1155                      Manager          7              26
## 354        1158                      Manager          7              26
## 355        1162                      Manager          7              26
## 356        1163                      Manager          7              26
## 357        3577                      Manager          7              26
## 358        3594                      Manager          7              26
## 359        3597                      Manager          7              26
## 360        3579                      Manager          6              34
## 361        3582                      Manager          6              34
## 362        3585                      Manager          6              34
## 363        3589                      Manager          6              34
## 364        3593                      Manager          6              34
## 365        1147                      Manager          5              39
## 366        1153                      Manager          5              39
## 367        1159                      Manager          5              39
## 368        1143                      Manager          4              42
## 369        1149                      Manager          4              42
## 370        1160                      Manager          4              42
## 371        3595                      Manager          4              42
## 372        1142                      Manager          3              46
## 373        3586                      Manager          3              46
## 374        3587                      Manager          3              46
## 375        3592                      Manager          3              46
## 376        1145                      Manager          1              50
## 377        1325               SEO Specialist         20               1
## 378        3750               SEO Specialist         20               1
## 379        3845               SEO Specialist         20               1
## 380        1253               SEO Specialist         19               4
## 381        1294               SEO Specialist         19               4
## 382        1330               SEO Specialist         19               4
## 383        1377               SEO Specialist         19               4
## 384        3689               SEO Specialist         19               4
## 385        3690               SEO Specialist         19               4
## 386        3693               SEO Specialist         18              10
## 387        3819               SEO Specialist         17              11
## 388        1314               SEO Specialist         16              12
## 389        3813               SEO Specialist         16              12
## 390        3762               SEO Specialist         15              14
## 391        3809               SEO Specialist         15              14
## 392        1376               SEO Specialist         14              16
## 393        3695               SEO Specialist         14              16
## 394        1258               SEO Specialist         13              18
## 395        1313               SEO Specialist         13              18
## 396        3757               SEO Specialist         13              18
## 397        3767               SEO Specialist         13              18
## 398        3844               SEO Specialist         13              18
## 399        1404               SEO Specialist         12              23
## 400        1375               SEO Specialist         11              24
## 401        1342               SEO Specialist         10              25
## 402        1320               SEO Specialist          9              26
## 403        1408               SEO Specialist          9              26
## 404        3751               SEO Specialist          9              26
## 405        3814               SEO Specialist          9              26
## 406        1372               SEO Specialist          8              30
## 407        1405               SEO Specialist          8              30
## 408        1256               SEO Specialist          7              32
## 409        1259               SEO Specialist          7              32
## 410        1378               SEO Specialist          7              32
## 411        3725               SEO Specialist          7              32
## 412        3815               SEO Specialist          7              32
## 413        3821               SEO Specialist          7              32
## 414        1288               SEO Specialist          6              38
## 415        1382               SEO Specialist          6              38
## 416        1409               SEO Specialist          6              38
## 417        3670               SEO Specialist          6              38
## 418        3706               SEO Specialist          6              38
## 419        3779               SEO Specialist          6              38
## 420        3807               SEO Specialist          6              38
## 421        1233               SEO Specialist          5              45
## 422        1252               SEO Specialist          5              45
## 423        1355               SEO Specialist          5              45
## 424        1391               SEO Specialist          5              45
## 425        3648               SEO Specialist          5              45
## 426        3841               SEO Specialist          5              45
## 427        1370               SEO Specialist          4              51
## 428        1384               SEO Specialist          4              51
## 429        3731               SEO Specialist          4              51
## 430        1211               SEO Specialist          3              54
## 431        1269               SEO Specialist          3              54
## 432        1407               SEO Specialist          3              54
## 433        3696               SEO Specialist          3              54
## 434        3828               SEO Specialist          3              54
## 435        3792               SEO Specialist          2              59
## 436        3812               SEO Specialist          1              60
## 437        3842               SEO Specialist          1              60
## 438        3846               SEO Specialist          1              60
## 439        1368      Social Media Strategist         20               1
## 440        3768      Social Media Strategist         19               2
## 441        3789      Social Media Strategist         19               2
## 442        3833      Social Media Strategist         19               2
## 443        1267      Social Media Strategist         18               5
## 444        1352      Social Media Strategist         18               5
## 445        1362      Social Media Strategist         18               5
## 446        3692      Social Media Strategist         18               5
## 447        3755      Social Media Strategist         18               5
## 448        3651      Social Media Strategist         16              10
## 449        1202      Social Media Strategist         15              11
## 450        1291      Social Media Strategist         15              11
## 451        1319      Social Media Strategist         14              13
## 452        3642      Social Media Strategist         13              14
## 453        3714      Social Media Strategist         13              14
## 454        3738      Social Media Strategist         13              14
## 455        3801      Social Media Strategist         13              14
## 456        1246      Social Media Strategist         12              18
## 457        1255      Social Media Strategist         12              18
## 458        1298      Social Media Strategist         12              18
## 459        3704      Social Media Strategist         12              18
## 460        3722      Social Media Strategist         12              18
## 461        3742      Social Media Strategist         12              18
## 462        1207      Social Media Strategist         11              24
## 463        1305      Social Media Strategist         11              24
## 464        3735      Social Media Strategist         11              24
## 465        1285      Social Media Strategist         10              27
## 466        1364      Social Media Strategist         10              27
## 467        1387      Social Media Strategist         10              27
## 468        1205      Social Media Strategist          8              30
## 469        1277      Social Media Strategist          8              30
## 470        1396      Social Media Strategist          8              30
## 471        3639      Social Media Strategist          8              30
## 472        3803      Social Media Strategist          8              30
## 473        1388      Social Media Strategist          7              35
## 474        3683      Social Media Strategist          7              35
## 475        3756      Social Media Strategist          7              35
## 476        3805      Social Media Strategist          7              35
## 477        1214      Social Media Strategist          6              39
## 478        1306      Social Media Strategist          6              39
## 479        1318      Social Media Strategist          6              39
## 480        3816      Social Media Strategist          6              39
## 481        1331      Social Media Strategist          5              43
## 482        3728      Social Media Strategist          5              43
## 483        3743      Social Media Strategist          5              43
## 484        3795      Social Media Strategist          5              43
## 485        1215      Social Media Strategist          4              47
## 486        1301      Social Media Strategist          4              47
## 487        1366      Social Media Strategist          4              47
## 488        1379      Social Media Strategist          4              47
## 489        3824      Social Media Strategist          4              47
## 490        3825      Social Media Strategist          4              47
## 491        3644      Social Media Strategist          3              53
## 492        3799      Social Media Strategist          3              53
## 493        1358      Social Media Strategist          2              55
## 494        3652      Social Media Strategist          2              55
## 495        1013               Vice President         10               1
## 496        3450               Vice President          5               2</code></pre>
<p>Notice that in the case of organization tenure ties, the <code>RANK()</code> function assigns the same rank and then adds the number of ties to that rank to determine the rank for the next highest tenure value.</p>
</div>
<div id="data-screening-cleaning" class="section level2">
<h2><span class="header-section-number">9.2</span> Data Screening &amp; Cleaning</h2>
<p><strong>Missingness</strong></p>
<p>Before considering whether and how to handle missing data, it is important to distinguish between <em>structural missingness</em> and <em>informative missingness</em> (Kuhn &amp; Johnson, 2013).</p>
<p><strong>Structural missingness</strong> relates to data that is missing for a logical reason. For example, we would not expect a new joiner with a few days of tenure to have a performance score. Likewise, we would not expect an active employee who is not a rehire to have a termination date. Therefore, we would not want to address missing values in these cases.</p>
<p><strong>Informative missingness</strong> relates to missing data that is informative regarding an outcome of interest. For example, in a survey context we may find a relationship between missing values on manager effectiveness questions and unfavorability on a psychological safety scale. This may indicate that employees who are fearful of retaliation are uncomfortable providing honest feedback about their managers, while employees who feel it is safe to speak up about issues are more comfortable responding in prosocial ways.</p>
<p>In some cases, we have the luxury of simply removing observations with missing values and using the remaining complete cases for analysis. However, since we are often working with wide datasets containing relatively few observations in people analytics, this may not be feasible. As we will cover in later chapters, sample size considerations are fundamental to achieving adequate power in statistical testing, so case removal is only possible with larger datasets.</p>
<p><strong>Data imputation</strong> refers to the methods by which missing data are replaced with substituted values when case removal is not appropriate. The most common data imputation method is replacing missing values with a descriptive statistic such as the mean or mode based on available data. For example, if most employees have an age in the system, the average or most frequent age could be used in place of the cases with a missing age. To be more precise, the average or most frequent age of those with <em>similar characteristics</em> may be used (e.g., similar years of experience, job, level). We would expect there to be less variability around a mean and mode value of age within a well-defined segment relative to the entire employee population, so this would likely be a more accurate substitute for an individual’s actual age.</p>
<p>There are more sophisticated methods of data imputation that involve models to estimate missing values. <em>Linear regression</em> and <em>K-Nearest Neighbor (KNN)</em> models are commonly used for this. These modeling techniques leverage a similar approach to the method outlined above in that the target values of cases with similar characteristics to those with missing values are used to aid estimation. These models will be covered in detail in later chapters.</p>
<p><strong>Outliers</strong></p>
<p>The treatment of outliers is a controversial topic. Appropriate methods for defining and addressing outliers are domain-specific, and there are many important considerations that should inform whether and how outliers should be treated.</p>
<p><strong>Low Variability</strong></p>
<p>Variables with <strong>low variability</strong> often do not provide sufficient information for identifying patterns in data. For example, if we are interested in using information on stock options to understand why employees vary in their levels of retention risk, but find that the employee stock purchase plan (ESPP) terms are identical for nearly all employees, including a stock option variable in the analysis is unlikely to provide any meaningful signal.</p>
<p>When working with survey data, checking for <strong>straightlining</strong> should be an early data screening step. Straightlining refers to a constant response across all survey items, which may be evidence that the respondent lost motivation or was not attentive and thoughtful when taking the survey. Since straight-line responses may influence results, it is often best to discard these cases – especially when the sample size is adequately large for the planned analyses without them. If the same response is given for both positively and negatively worded versions of a question (e.g., comparing “I plan to be here in a year” to “I do not plan to be here in a year”), which we expect to be inversely related, this gives added support for discarding these responses.</p>
<p><strong>Inconsistent Categories</strong></p>
<p><strong>Data Binning</strong></p>
</div>
<div id="one-hot-encoding" class="section level2">
<h2><span class="header-section-number">9.3</span> One-Hot Encoding</h2>
<p><strong>One-hot encoding</strong>, also known as <strong>dummy coding</strong>, involves transforming a categorical variable into numeric values on which statistical procedures can be performed.</p>
</div>
<div id="feature-engineering" class="section level2">
<h2><span class="header-section-number">9.4</span> Feature Engineering</h2>
<p>Level one people analytics tends to utilize only the delivered fields from the HRIS (e.g., location, job profile, org tenure, etc.), but a good next step is to derive smarter variables from these fields. These can then be used to slice and dice turnover and engagement data differently, use as inputs in attrition risk models, etc. Below are some ideas to get you started:</p>
<ul>
<li>Number of jobs per unit of tenure (larger proportions tend to see greater career pathing)</li>
<li>Office/remote worker (binary variable dummy coded as 1/0)</li>
<li>Local/remote manager (binary variable dummy coded as 1/0)</li>
<li>Hire/Rehire (binary variable dummy coded as 1/0)</li>
<li>Hired/acquired (proxy for culture shock effects)</li>
<li>Gender isolation (ratio of employee’s gender to number of the same within immediate work
group)</li>
<li>Generation isolation (comparison of age bracket to most frequent generational bracket within
immediate work group)</li>
<li>Ethnic isolation (ratio of employee’s ethnicity to number of the same within immediate work
group)</li>
<li>Difference between employee and manager age</li>
<li>Percentage change between last two performance appraisal scores (per competency and/or
overall)</li>
<li>Team and department quit outbreak indicators (ratio of terms over x months relative to average
headcount over x months)</li>
<li>Industry experience (binary or length in years)</li>
</ul>
<p>Remember to compute variables consistent with a need (e.g., is there reason to believe generationally isolated employees are more likely to term?). There may be a time and place for undertaking data mining initiatives with no a priori theories about what may be uncovered; however, more often than not, our efforts should be tied to specific hypotheses the business needs tested, which have sound theoretical underpinnings.</p>
</div>
<div id="exercises-5" class="section level2">
<h2><span class="header-section-number">9.5</span> Exercises</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inf-stats.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aod.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["People_Analytics_Lifecycle.pdf", "People_Analytics_Lifecycle.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
