<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Introduction to SQL | The Fundamentals of People Analytics: With Applications in R</title>
  <meta name="description" content="An end-to-end guide for successful analytics projects in the social sciences" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Introduction to SQL | The Fundamentals of People Analytics: With Applications in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An end-to-end guide for successful analytics projects in the social sciences" />
  <meta name="github-repo" content="crstarbuck/peopleanalytics-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Introduction to SQL | The Fundamentals of People Analytics: With Applications in R" />
  
  <meta name="twitter:description" content="An end-to-end guide for successful analytics projects in the social sciences" />
  

<meta name="author" content="Craig Starbuck" />


<meta name="date" content="2022-10-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-intro.html"/>
<link rel="next" href="research.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Fundamentals of People Analytics: With Applications in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="dedication.html"><a href="dedication.html"><i class="fa fa-check"></i>Dedication</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#guiding-principles"><i class="fa fa-check"></i><b>1.1</b> Guiding Principles</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="getting-started.html"><a href="getting-started.html#pro-employee-thinking"><i class="fa fa-check"></i><b>1.1.1</b> Pro-Employee Thinking</a></li>
<li class="chapter" data-level="1.1.2" data-path="getting-started.html"><a href="getting-started.html#quality"><i class="fa fa-check"></i><b>1.1.2</b> Quality</a></li>
<li class="chapter" data-level="1.1.3" data-path="getting-started.html"><a href="getting-started.html#prioritization"><i class="fa fa-check"></i><b>1.1.3</b> Prioritization</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#tooling"><i class="fa fa-check"></i><b>1.2</b> Tooling</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#data-sets"><i class="fa fa-check"></i><b>1.3</b> Data Sets</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="getting-started.html"><a href="getting-started.html#employees"><i class="fa fa-check"></i><b>1.3.1</b> Employees</a></li>
<li class="chapter" data-level="1.3.2" data-path="getting-started.html"><a href="getting-started.html#turnover-trends"><i class="fa fa-check"></i><b>1.3.2</b> Turnover Trends</a></li>
<li class="chapter" data-level="1.3.3" data-path="getting-started.html"><a href="getting-started.html#survey-responses"><i class="fa fa-check"></i><b>1.3.3</b> Survey Responses</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#d-framework"><i class="fa fa-check"></i><b>1.4</b> 4D Framework</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-intro.html"><a href="r-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-intro.html"><a href="r-intro.html#getting-started-1"><i class="fa fa-check"></i><b>2.1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="r-intro.html"><a href="r-intro.html#installing-r"><i class="fa fa-check"></i><b>2.1.1</b> Installing R</a></li>
<li class="chapter" data-level="2.1.2" data-path="r-intro.html"><a href="r-intro.html#installing-r-studio"><i class="fa fa-check"></i><b>2.1.2</b> Installing R Studio</a></li>
<li class="chapter" data-level="2.1.3" data-path="r-intro.html"><a href="r-intro.html#installing-packages"><i class="fa fa-check"></i><b>2.1.3</b> Installing Packages</a></li>
<li class="chapter" data-level="2.1.4" data-path="r-intro.html"><a href="r-intro.html#loading-data"><i class="fa fa-check"></i><b>2.1.4</b> Loading data</a></li>
<li class="chapter" data-level="2.1.5" data-path="r-intro.html"><a href="r-intro.html#case-sensitivity"><i class="fa fa-check"></i><b>2.1.5</b> Case Sensitivity</a></li>
<li class="chapter" data-level="2.1.6" data-path="r-intro.html"><a href="r-intro.html#help"><i class="fa fa-check"></i><b>2.1.6</b> Help</a></li>
<li class="chapter" data-level="2.1.7" data-path="r-intro.html"><a href="r-intro.html#objects"><i class="fa fa-check"></i><b>2.1.7</b> Objects</a></li>
<li class="chapter" data-level="2.1.8" data-path="r-intro.html"><a href="r-intro.html#comments"><i class="fa fa-check"></i><b>2.1.8</b> Comments</a></li>
<li class="chapter" data-level="2.1.9" data-path="r-intro.html"><a href="r-intro.html#testing-early-and-often"><i class="fa fa-check"></i><b>2.1.9</b> Testing Early and Often</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-intro.html"><a href="r-intro.html#vectors"><i class="fa fa-check"></i><b>2.2</b> Vectors</a></li>
<li class="chapter" data-level="2.3" data-path="r-intro.html"><a href="r-intro.html#matrices"><i class="fa fa-check"></i><b>2.3</b> Matrices</a></li>
<li class="chapter" data-level="2.4" data-path="r-intro.html"><a href="r-intro.html#factors"><i class="fa fa-check"></i><b>2.4</b> Factors</a></li>
<li class="chapter" data-level="2.5" data-path="r-intro.html"><a href="r-intro.html#data-frames"><i class="fa fa-check"></i><b>2.5</b> Data Frames</a></li>
<li class="chapter" data-level="2.6" data-path="r-intro.html"><a href="r-intro.html#lists"><i class="fa fa-check"></i><b>2.6</b> Lists</a></li>
<li class="chapter" data-level="2.7" data-path="r-intro.html"><a href="r-intro.html#loops"><i class="fa fa-check"></i><b>2.7</b> Loops</a></li>
<li class="chapter" data-level="2.8" data-path="r-intro.html"><a href="r-intro.html#user-defined-functions-udfs"><i class="fa fa-check"></i><b>2.8</b> User-Defined Functions (UDFs)</a></li>
<li class="chapter" data-level="2.9" data-path="r-intro.html"><a href="r-intro.html#graphics"><i class="fa fa-check"></i><b>2.9</b> Graphics</a></li>
<li class="chapter" data-level="2.10" data-path="r-intro.html"><a href="r-intro.html#review-questions"><i class="fa fa-check"></i><b>2.10</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sql-intro.html"><a href="sql-intro.html"><i class="fa fa-check"></i><b>3</b> Introduction to SQL</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sql-intro.html"><a href="sql-intro.html#basics"><i class="fa fa-check"></i><b>3.1</b> Basics</a></li>
<li class="chapter" data-level="3.2" data-path="sql-intro.html"><a href="sql-intro.html#aggregate-functions"><i class="fa fa-check"></i><b>3.2</b> Aggregate Functions</a></li>
<li class="chapter" data-level="3.3" data-path="sql-intro.html"><a href="sql-intro.html#joins"><i class="fa fa-check"></i><b>3.3</b> Joins</a></li>
<li class="chapter" data-level="3.4" data-path="sql-intro.html"><a href="sql-intro.html#subqueries"><i class="fa fa-check"></i><b>3.4</b> Subqueries</a></li>
<li class="chapter" data-level="3.5" data-path="sql-intro.html"><a href="sql-intro.html#virtual-tables"><i class="fa fa-check"></i><b>3.5</b> Virtual Tables</a></li>
<li class="chapter" data-level="3.6" data-path="sql-intro.html"><a href="sql-intro.html#window-functions"><i class="fa fa-check"></i><b>3.6</b> Window Functions</a></li>
<li class="chapter" data-level="3.7" data-path="sql-intro.html"><a href="sql-intro.html#common-table-expressions-ctes"><i class="fa fa-check"></i><b>3.7</b> Common Table Expressions (CTEs)</a></li>
<li class="chapter" data-level="3.8" data-path="sql-intro.html"><a href="sql-intro.html#review-questions-1"><i class="fa fa-check"></i><b>3.8</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="research.html"><a href="research.html"><i class="fa fa-check"></i><b>4</b> Research Design</a>
<ul>
<li class="chapter" data-level="4.1" data-path="research.html"><a href="research.html#research-questions"><i class="fa fa-check"></i><b>4.1</b> Research Questions</a></li>
<li class="chapter" data-level="4.2" data-path="research.html"><a href="research.html#research-hypotheses"><i class="fa fa-check"></i><b>4.2</b> Research Hypotheses</a></li>
<li class="chapter" data-level="4.3" data-path="research.html"><a href="research.html#internal-and-external-validity"><i class="fa fa-check"></i><b>4.3</b> Internal and External Validity</a></li>
<li class="chapter" data-level="4.4" data-path="research.html"><a href="research.html#research-methods"><i class="fa fa-check"></i><b>4.4</b> Research Methods</a></li>
<li class="chapter" data-level="4.5" data-path="research.html"><a href="research.html#research-designs"><i class="fa fa-check"></i><b>4.5</b> Research Designs</a></li>
<li class="chapter" data-level="4.6" data-path="research.html"><a href="research.html#review-questions-2"><i class="fa fa-check"></i><b>4.6</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="measure-sampl.html"><a href="measure-sampl.html"><i class="fa fa-check"></i><b>5</b> Measurement &amp; Sampling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="measure-sampl.html"><a href="measure-sampl.html#variable-types"><i class="fa fa-check"></i><b>5.1</b> Variable Types</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="measure-sampl.html"><a href="measure-sampl.html#independent-variables-iv"><i class="fa fa-check"></i><b>5.1.1</b> Independent Variables (IV)</a></li>
<li class="chapter" data-level="5.1.2" data-path="measure-sampl.html"><a href="measure-sampl.html#dependent-variables-dv"><i class="fa fa-check"></i><b>5.1.2</b> Dependent Variables (DV)</a></li>
<li class="chapter" data-level="5.1.3" data-path="measure-sampl.html"><a href="measure-sampl.html#control-variables-cv"><i class="fa fa-check"></i><b>5.1.3</b> Control Variables (CV)</a></li>
<li class="chapter" data-level="5.1.4" data-path="measure-sampl.html"><a href="measure-sampl.html#moderating-variables"><i class="fa fa-check"></i><b>5.1.4</b> Moderating Variables</a></li>
<li class="chapter" data-level="5.1.5" data-path="measure-sampl.html"><a href="measure-sampl.html#mediating-variables"><i class="fa fa-check"></i><b>5.1.5</b> Mediating Variables</a></li>
<li class="chapter" data-level="5.1.6" data-path="measure-sampl.html"><a href="measure-sampl.html#endogenous-vs.-exogenous-variables"><i class="fa fa-check"></i><b>5.1.6</b> Endogenous vs. Exogenous Variables</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="measure-sampl.html"><a href="measure-sampl.html#measurement-scales"><i class="fa fa-check"></i><b>5.2</b> Measurement Scales</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="measure-sampl.html"><a href="measure-sampl.html#discrete-variables"><i class="fa fa-check"></i><b>5.2.1</b> Discrete Variables</a></li>
<li class="chapter" data-level="5.2.2" data-path="measure-sampl.html"><a href="measure-sampl.html#continuous-variables"><i class="fa fa-check"></i><b>5.2.2</b> Continuous Variables</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="measure-sampl.html"><a href="measure-sampl.html#sampling-methods"><i class="fa fa-check"></i><b>5.3</b> Sampling Methods</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="measure-sampl.html"><a href="measure-sampl.html#probability-sampling"><i class="fa fa-check"></i><b>5.3.1</b> Probability Sampling</a></li>
<li class="chapter" data-level="5.3.2" data-path="measure-sampl.html"><a href="measure-sampl.html#non-probability-sampling"><i class="fa fa-check"></i><b>5.3.2</b> Non-Probability Sampling</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="measure-sampl.html"><a href="measure-sampl.html#sampling-nonsampling-error"><i class="fa fa-check"></i><b>5.4</b> Sampling &amp; Nonsampling Error</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="measure-sampl.html"><a href="measure-sampl.html#sampling-error"><i class="fa fa-check"></i><b>5.4.1</b> Sampling Error</a></li>
<li class="chapter" data-level="5.4.2" data-path="measure-sampl.html"><a href="measure-sampl.html#nonsampling-error"><i class="fa fa-check"></i><b>5.4.2</b> Nonsampling Error</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="measure-sampl.html"><a href="measure-sampl.html#scale-reliability-and-validity"><i class="fa fa-check"></i><b>5.5</b> Scale Reliability and Validity</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="measure-sampl.html"><a href="measure-sampl.html#reliability"><i class="fa fa-check"></i><b>5.5.1</b> Reliability</a></li>
<li class="chapter" data-level="5.5.2" data-path="measure-sampl.html"><a href="measure-sampl.html#validity"><i class="fa fa-check"></i><b>5.5.2</b> Validity</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="measure-sampl.html"><a href="measure-sampl.html#review-questions-3"><i class="fa fa-check"></i><b>5.6</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>6</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-prep.html"><a href="data-prep.html#data-extraction"><i class="fa fa-check"></i><b>6.1</b> Data Extraction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-prep.html"><a href="data-prep.html#data-architecture"><i class="fa fa-check"></i><b>6.1.1</b> Data Architecture</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-prep.html"><a href="data-prep.html#data-screening-cleaning"><i class="fa fa-check"></i><b>6.2</b> Data Screening &amp; Cleaning</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-prep.html"><a href="data-prep.html#missingness"><i class="fa fa-check"></i><b>6.2.1</b> Missingness</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-prep.html"><a href="data-prep.html#outliers"><i class="fa fa-check"></i><b>6.2.2</b> Outliers</a></li>
<li class="chapter" data-level="6.2.3" data-path="data-prep.html"><a href="data-prep.html#low-variability"><i class="fa fa-check"></i><b>6.2.3</b> Low Variability</a></li>
<li class="chapter" data-level="6.2.4" data-path="data-prep.html"><a href="data-prep.html#inconsistent-categories"><i class="fa fa-check"></i><b>6.2.4</b> Inconsistent Categories</a></li>
<li class="chapter" data-level="6.2.5" data-path="data-prep.html"><a href="data-prep.html#data-binning"><i class="fa fa-check"></i><b>6.2.5</b> Data Binning</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-prep.html"><a href="data-prep.html#one-hot-encoding"><i class="fa fa-check"></i><b>6.3</b> One-Hot Encoding</a></li>
<li class="chapter" data-level="6.4" data-path="data-prep.html"><a href="data-prep.html#feature-engineering"><i class="fa fa-check"></i><b>6.4</b> Feature Engineering</a></li>
<li class="chapter" data-level="6.5" data-path="data-prep.html"><a href="data-prep.html#review-questions-4"><i class="fa fa-check"></i><b>6.5</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="desc-stats.html"><a href="desc-stats.html"><i class="fa fa-check"></i><b>7</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="desc-stats.html"><a href="desc-stats.html#univariate-analysis"><i class="fa fa-check"></i><b>7.1</b> Univariate Analysis</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="desc-stats.html"><a href="desc-stats.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>7.1.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="7.1.2" data-path="desc-stats.html"><a href="desc-stats.html#measures-of-spread"><i class="fa fa-check"></i><b>7.1.2</b> Measures of Spread</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="desc-stats.html"><a href="desc-stats.html#bivariate-analysis"><i class="fa fa-check"></i><b>7.2</b> Bivariate Analysis</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="desc-stats.html"><a href="desc-stats.html#covariance"><i class="fa fa-check"></i><b>7.2.1</b> Covariance</a></li>
<li class="chapter" data-level="7.2.2" data-path="desc-stats.html"><a href="desc-stats.html#correlation"><i class="fa fa-check"></i><b>7.2.2</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="desc-stats.html"><a href="desc-stats.html#review-questions-5"><i class="fa fa-check"></i><b>7.3</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inf-stats.html"><a href="inf-stats.html"><i class="fa fa-check"></i><b>8</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="inf-stats.html"><a href="inf-stats.html#introduction-to-probability"><i class="fa fa-check"></i><b>8.1</b> Introduction to Probability</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="inf-stats.html"><a href="inf-stats.html#probability-distributions"><i class="fa fa-check"></i><b>8.1.1</b> Probability Distributions</a></li>
<li class="chapter" data-level="8.1.2" data-path="inf-stats.html"><a href="inf-stats.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.2</b> Conditional Probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="inf-stats.html"><a href="inf-stats.html#central-limit-theorem"><i class="fa fa-check"></i><b>8.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="8.3" data-path="inf-stats.html"><a href="inf-stats.html#confidence-intervals"><i class="fa fa-check"></i><b>8.3</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="inf-stats.html"><a href="inf-stats.html#hypothesis-testing"><i class="fa fa-check"></i><b>8.3.1</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="8.3.2" data-path="inf-stats.html"><a href="inf-stats.html#alpha"><i class="fa fa-check"></i><b>8.3.2</b> Alpha</a></li>
<li class="chapter" data-level="8.3.3" data-path="inf-stats.html"><a href="inf-stats.html#type-i-ii-errors"><i class="fa fa-check"></i><b>8.3.3</b> Type I &amp; II Errors</a></li>
<li class="chapter" data-level="8.3.4" data-path="inf-stats.html"><a href="inf-stats.html#textbf-p-values"><i class="fa fa-check"></i><b>8.3.4</b> <span class="math inline">\(\textbf p\)</span>-Values</a></li>
<li class="chapter" data-level="8.3.5" data-path="inf-stats.html"><a href="inf-stats.html#bonferroni-correction"><i class="fa fa-check"></i><b>8.3.5</b> Bonferroni Correction</a></li>
<li class="chapter" data-level="8.3.6" data-path="inf-stats.html"><a href="inf-stats.html#statistical-power"><i class="fa fa-check"></i><b>8.3.6</b> Statistical Power</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="inf-stats.html"><a href="inf-stats.html#review-questions-6"><i class="fa fa-check"></i><b>8.4</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="aod.html"><a href="aod.html"><i class="fa fa-check"></i><b>9</b> Analysis of Differences</a>
<ul>
<li class="chapter" data-level="9.1" data-path="aod.html"><a href="aod.html#parametric-vs.-nonparametric-tests"><i class="fa fa-check"></i><b>9.1</b> Parametric vs. Nonparametric Tests</a></li>
<li class="chapter" data-level="9.2" data-path="aod.html"><a href="aod.html#differences-in-discrete-data"><i class="fa fa-check"></i><b>9.2</b> Differences in Discrete Data</a></li>
<li class="chapter" data-level="9.3" data-path="aod.html"><a href="aod.html#differences-in-continuous-data"><i class="fa fa-check"></i><b>9.3</b> Differences in Continuous Data</a></li>
<li class="chapter" data-level="9.4" data-path="aod.html"><a href="aod.html#review-questions-7"><i class="fa fa-check"></i><b>9.4</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>10</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="lm.html"><a href="lm.html#sample-size"><i class="fa fa-check"></i><b>10.1</b> Sample Size</a></li>
<li class="chapter" data-level="10.2" data-path="lm.html"><a href="lm.html#simple-linear-regression"><i class="fa fa-check"></i><b>10.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="10.3" data-path="lm.html"><a href="lm.html#multiple-linear-regression"><i class="fa fa-check"></i><b>10.3</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="10.4" data-path="lm.html"><a href="lm.html#moderation"><i class="fa fa-check"></i><b>10.4</b> Moderation</a></li>
<li class="chapter" data-level="10.5" data-path="lm.html"><a href="lm.html#mediation"><i class="fa fa-check"></i><b>10.5</b> Mediation</a></li>
<li class="chapter" data-level="10.6" data-path="lm.html"><a href="lm.html#review-questions-8"><i class="fa fa-check"></i><b>10.6</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lme.html"><a href="lme.html"><i class="fa fa-check"></i><b>11</b> Linear Model Extensions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lme.html"><a href="lme.html#model-comparisons"><i class="fa fa-check"></i><b>11.1</b> Model Comparisons</a></li>
<li class="chapter" data-level="11.2" data-path="lme.html"><a href="lme.html#hierarchical-regression"><i class="fa fa-check"></i><b>11.2</b> Hierarchical Regression</a></li>
<li class="chapter" data-level="11.3" data-path="lme.html"><a href="lme.html#multilevel-models"><i class="fa fa-check"></i><b>11.3</b> Multilevel Models</a></li>
<li class="chapter" data-level="11.4" data-path="lme.html"><a href="lme.html#polynomial-regression"><i class="fa fa-check"></i><b>11.4</b> Polynomial Regression</a></li>
<li class="chapter" data-level="11.5" data-path="lme.html"><a href="lme.html#review-questions-9"><i class="fa fa-check"></i><b>11.5</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="log.html"><a href="log.html"><i class="fa fa-check"></i><b>12</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="log.html"><a href="log.html#binomial-logistic-regression"><i class="fa fa-check"></i><b>12.1</b> Binomial Logistic Regression</a></li>
<li class="chapter" data-level="12.2" data-path="log.html"><a href="log.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>12.2</b> Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="12.3" data-path="log.html"><a href="log.html#ordinal-logistic-regression"><i class="fa fa-check"></i><b>12.3</b> Ordinal Logistic Regression</a></li>
<li class="chapter" data-level="12.4" data-path="log.html"><a href="log.html#review-questions-10"><i class="fa fa-check"></i><b>12.4</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="pred-mod.html"><a href="pred-mod.html"><i class="fa fa-check"></i><b>13</b> Predictive Modeling</a>
<ul>
<li class="chapter" data-level="13.1" data-path="pred-mod.html"><a href="pred-mod.html#cross-validation"><i class="fa fa-check"></i><b>13.1</b> Cross-Validation</a></li>
<li class="chapter" data-level="13.2" data-path="pred-mod.html"><a href="pred-mod.html#model-performance"><i class="fa fa-check"></i><b>13.2</b> Model Performance</a></li>
<li class="chapter" data-level="13.3" data-path="pred-mod.html"><a href="pred-mod.html#bias-variance-tradeoff"><i class="fa fa-check"></i><b>13.3</b> Bias-Variance Tradeoff</a></li>
<li class="chapter" data-level="13.4" data-path="pred-mod.html"><a href="pred-mod.html#tree-based-algorithms"><i class="fa fa-check"></i><b>13.4</b> Tree-Based Algorithms</a></li>
<li class="chapter" data-level="13.5" data-path="pred-mod.html"><a href="pred-mod.html#predictive-modeling"><i class="fa fa-check"></i><b>13.5</b> Predictive Modeling</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="pred-mod.html"><a href="pred-mod.html#classification"><i class="fa fa-check"></i><b>13.5.1</b> Classification</a></li>
<li class="chapter" data-level="13.5.2" data-path="pred-mod.html"><a href="pred-mod.html#forecasting"><i class="fa fa-check"></i><b>13.5.2</b> Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="pred-mod.html"><a href="pred-mod.html#review-questions-11"><i class="fa fa-check"></i><b>13.6</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="unsup-lrn.html"><a href="unsup-lrn.html"><i class="fa fa-check"></i><b>14</b> Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="14.1" data-path="unsup-lrn.html"><a href="unsup-lrn.html#factor-analysis"><i class="fa fa-check"></i><b>14.1</b> Factor Analysis</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="unsup-lrn.html"><a href="unsup-lrn.html#exploratory-factor-analysis-efa"><i class="fa fa-check"></i><b>14.1.1</b> Exploratory Factor Analysis (EFA)</a></li>
<li class="chapter" data-level="14.1.2" data-path="unsup-lrn.html"><a href="unsup-lrn.html#confirmatory-factor-analysis-cfa"><i class="fa fa-check"></i><b>14.1.2</b> Confirmatory Factor Analysis (CFA)</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="unsup-lrn.html"><a href="unsup-lrn.html#clustering"><i class="fa fa-check"></i><b>14.2</b> Clustering</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="unsup-lrn.html"><a href="unsup-lrn.html#k-means-clustering"><i class="fa fa-check"></i><b>14.2.1</b> <span class="math inline">\(K\)</span>-Means Clustering</a></li>
<li class="chapter" data-level="14.2.2" data-path="unsup-lrn.html"><a href="unsup-lrn.html#hierarchical-clustering"><i class="fa fa-check"></i><b>14.2.2</b> Hierarchical Clustering</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="unsup-lrn.html"><a href="unsup-lrn.html#review-questions-12"><i class="fa fa-check"></i><b>14.3</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>15</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="15.1" data-path="data-viz.html"><a href="data-viz.html#best-practices"><i class="fa fa-check"></i><b>15.1</b> Best Practices</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="data-viz.html"><a href="data-viz.html#color-palette"><i class="fa fa-check"></i><b>15.1.1</b> Color Palette</a></li>
<li class="chapter" data-level="15.1.2" data-path="data-viz.html"><a href="data-viz.html#chart-borders"><i class="fa fa-check"></i><b>15.1.2</b> Chart Borders</a></li>
<li class="chapter" data-level="15.1.3" data-path="data-viz.html"><a href="data-viz.html#zero-baseline"><i class="fa fa-check"></i><b>15.1.3</b> Zero Baseline</a></li>
<li class="chapter" data-level="15.1.4" data-path="data-viz.html"><a href="data-viz.html#intuitive-layout"><i class="fa fa-check"></i><b>15.1.4</b> Intuitive Layout</a></li>
<li class="chapter" data-level="15.1.5" data-path="data-viz.html"><a href="data-viz.html#preattentive-attributes"><i class="fa fa-check"></i><b>15.1.5</b> Preattentive Attributes</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="data-viz.html"><a href="data-viz.html#step-by-step-visual-upgrade"><i class="fa fa-check"></i><b>15.2</b> Step-by-Step Visual Upgrade</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="data-viz.html"><a href="data-viz.html#step-1-build-bar-chart-with-defaults"><i class="fa fa-check"></i><b>15.2.1</b> Step 1: Build Bar Chart with Defaults</a></li>
<li class="chapter" data-level="15.2.2" data-path="data-viz.html"><a href="data-viz.html#step-2-remove-legend"><i class="fa fa-check"></i><b>15.2.2</b> Step 2: Remove Legend</a></li>
<li class="chapter" data-level="15.2.3" data-path="data-viz.html"><a href="data-viz.html#step-3-assign-colors-strategically"><i class="fa fa-check"></i><b>15.2.3</b> Step 3: Assign Colors Strategically</a></li>
<li class="chapter" data-level="15.2.4" data-path="data-viz.html"><a href="data-viz.html#step-4-add-axis-titles-and-margins"><i class="fa fa-check"></i><b>15.2.4</b> Step 4: Add Axis Titles and Margins</a></li>
<li class="chapter" data-level="15.2.5" data-path="data-viz.html"><a href="data-viz.html#step-5-add-left-justified-title"><i class="fa fa-check"></i><b>15.2.5</b> Step 5: Add Left-Justified Title</a></li>
<li class="chapter" data-level="15.2.6" data-path="data-viz.html"><a href="data-viz.html#step-6-remove-background"><i class="fa fa-check"></i><b>15.2.6</b> Step 6: Remove Background</a></li>
<li class="chapter" data-level="15.2.7" data-path="data-viz.html"><a href="data-viz.html#step-7-remove-axis-ticks"><i class="fa fa-check"></i><b>15.2.7</b> Step 7: Remove Axis Ticks</a></li>
<li class="chapter" data-level="15.2.8" data-path="data-viz.html"><a href="data-viz.html#step-8-mute-titles"><i class="fa fa-check"></i><b>15.2.8</b> Step 8: Mute Titles</a></li>
<li class="chapter" data-level="15.2.9" data-path="data-viz.html"><a href="data-viz.html#step-9-flip-axes"><i class="fa fa-check"></i><b>15.2.9</b> Step 9: Flip Axes</a></li>
<li class="chapter" data-level="15.2.10" data-path="data-viz.html"><a href="data-viz.html#step-10-sort-data"><i class="fa fa-check"></i><b>15.2.10</b> Step 10: Sort Data</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="data-viz.html"><a href="data-viz.html#visualization-types"><i class="fa fa-check"></i><b>15.3</b> Visualization Types</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="data-viz.html"><a href="data-viz.html#tables"><i class="fa fa-check"></i><b>15.3.1</b> Tables</a></li>
<li class="chapter" data-level="15.3.2" data-path="data-viz.html"><a href="data-viz.html#heatmaps"><i class="fa fa-check"></i><b>15.3.2</b> Heatmaps</a></li>
<li class="chapter" data-level="15.3.3" data-path="data-viz.html"><a href="data-viz.html#scatterplots"><i class="fa fa-check"></i><b>15.3.3</b> Scatterplots</a></li>
<li class="chapter" data-level="15.3.4" data-path="data-viz.html"><a href="data-viz.html#line-graphs"><i class="fa fa-check"></i><b>15.3.4</b> Line Graphs</a></li>
<li class="chapter" data-level="15.3.5" data-path="data-viz.html"><a href="data-viz.html#slopegraphs"><i class="fa fa-check"></i><b>15.3.5</b> Slopegraphs</a></li>
<li class="chapter" data-level="15.3.6" data-path="data-viz.html"><a href="data-viz.html#bar-charts"><i class="fa fa-check"></i><b>15.3.6</b> Bar Charts</a></li>
<li class="chapter" data-level="15.3.7" data-path="data-viz.html"><a href="data-viz.html#combination-charts"><i class="fa fa-check"></i><b>15.3.7</b> Combination Charts</a></li>
<li class="chapter" data-level="15.3.8" data-path="data-viz.html"><a href="data-viz.html#waterfall-charts"><i class="fa fa-check"></i><b>15.3.8</b> Waterfall Charts</a></li>
<li class="chapter" data-level="15.3.9" data-path="data-viz.html"><a href="data-viz.html#waffle-charts"><i class="fa fa-check"></i><b>15.3.9</b> Waffle Charts</a></li>
<li class="chapter" data-level="15.3.10" data-path="data-viz.html"><a href="data-viz.html#sankey-diagrams"><i class="fa fa-check"></i><b>15.3.10</b> Sankey Diagrams</a></li>
<li class="chapter" data-level="15.3.11" data-path="data-viz.html"><a href="data-viz.html#pie-charts"><i class="fa fa-check"></i><b>15.3.11</b> Pie Charts</a></li>
<li class="chapter" data-level="15.3.12" data-path="data-viz.html"><a href="data-viz.html#d-visuals"><i class="fa fa-check"></i><b>15.3.12</b> 3D Visuals</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="data-viz.html"><a href="data-viz.html#elegant-data-visualization"><i class="fa fa-check"></i><b>15.4</b> Elegant Data Visualization</a></li>
<li class="chapter" data-level="15.5" data-path="data-viz.html"><a href="data-viz.html#review-questions-13"><i class="fa fa-check"></i><b>15.5</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="storytelling.html"><a href="storytelling.html"><i class="fa fa-check"></i><b>16</b> Data Storytelling</a>
<ul>
<li class="chapter" data-level="16.1" data-path="storytelling.html"><a href="storytelling.html#know-your-audience"><i class="fa fa-check"></i><b>16.1</b> Know Your Audience</a></li>
<li class="chapter" data-level="16.2" data-path="storytelling.html"><a href="storytelling.html#production-status"><i class="fa fa-check"></i><b>16.2</b> Production Status</a></li>
<li class="chapter" data-level="16.3" data-path="storytelling.html"><a href="storytelling.html#structural-elements"><i class="fa fa-check"></i><b>16.3</b> Structural Elements</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="storytelling.html"><a href="storytelling.html#tldr"><i class="fa fa-check"></i><b>16.3.1</b> TL;DR</a></li>
<li class="chapter" data-level="16.3.2" data-path="storytelling.html"><a href="storytelling.html#purpose"><i class="fa fa-check"></i><b>16.3.2</b> Purpose</a></li>
<li class="chapter" data-level="16.3.3" data-path="storytelling.html"><a href="storytelling.html#methodology"><i class="fa fa-check"></i><b>16.3.3</b> Methodology</a></li>
<li class="chapter" data-level="16.3.4" data-path="storytelling.html"><a href="storytelling.html#results"><i class="fa fa-check"></i><b>16.3.4</b> Results</a></li>
<li class="chapter" data-level="16.3.5" data-path="storytelling.html"><a href="storytelling.html#limitations"><i class="fa fa-check"></i><b>16.3.5</b> Limitations</a></li>
<li class="chapter" data-level="16.3.6" data-path="storytelling.html"><a href="storytelling.html#next-steps"><i class="fa fa-check"></i><b>16.3.6</b> Next Steps</a></li>
<li class="chapter" data-level="16.3.7" data-path="storytelling.html"><a href="storytelling.html#appendix"><i class="fa fa-check"></i><b>16.3.7</b> Appendix</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="storytelling.html"><a href="storytelling.html#qa"><i class="fa fa-check"></i><b>16.4</b> Q&amp;A</a></li>
<li class="chapter" data-level="16.5" data-path="storytelling.html"><a href="storytelling.html#review-questions-14"><i class="fa fa-check"></i><b>16.5</b> Review Questions</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="bibli.html"><a href="bibli.html"><i class="fa fa-check"></i><b>17</b> Bibliography</a></li>
<li class="chapter" data-level="18" data-path="storytelling.html"><a href="storytelling.html#appendix"><i class="fa fa-check"></i><b>18</b> Appendix</a>
<ul>
<li class="chapter" data-level="18.1" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>18.1</b> 4D Framework</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="appendix.html"><a href="appendix.html#discover"><i class="fa fa-check"></i><b>18.1.1</b> Discover</a></li>
<li class="chapter" data-level="18.1.2" data-path="appendix.html"><a href="appendix.html#design"><i class="fa fa-check"></i><b>18.1.2</b> Design</a></li>
<li class="chapter" data-level="18.1.3" data-path="appendix.html"><a href="appendix.html#develop"><i class="fa fa-check"></i><b>18.1.3</b> Develop</a></li>
<li class="chapter" data-level="18.1.4" data-path="appendix.html"><a href="appendix.html#deliver"><i class="fa fa-check"></i><b>18.1.4</b> Deliver</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="appendix.html"><a href="appendix.html#data-visualization"><i class="fa fa-check"></i><b>18.2</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="appendix.html"><a href="appendix.html#step-by-step-visual-upgrade-1"><i class="fa fa-check"></i><b>18.2.1</b> Step-by-Step Visual Upgrade</a></li>
<li class="chapter" data-level="18.2.2" data-path="appendix.html"><a href="appendix.html#tables-1"><i class="fa fa-check"></i><b>18.2.2</b> Tables</a></li>
<li class="chapter" data-level="18.2.3" data-path="appendix.html"><a href="appendix.html#heatmaps-1"><i class="fa fa-check"></i><b>18.2.3</b> Heatmaps</a></li>
<li class="chapter" data-level="18.2.4" data-path="appendix.html"><a href="appendix.html#scatterplots-1"><i class="fa fa-check"></i><b>18.2.4</b> Scatterplots</a></li>
<li class="chapter" data-level="18.2.5" data-path="appendix.html"><a href="appendix.html#line-charts"><i class="fa fa-check"></i><b>18.2.5</b> Line Charts</a></li>
<li class="chapter" data-level="18.2.6" data-path="appendix.html"><a href="appendix.html#slopegraphs-1"><i class="fa fa-check"></i><b>18.2.6</b> Slopegraphs</a></li>
<li class="chapter" data-level="18.2.7" data-path="appendix.html"><a href="appendix.html#bar-charts-1"><i class="fa fa-check"></i><b>18.2.7</b> Bar Charts</a></li>
<li class="chapter" data-level="18.2.8" data-path="appendix.html"><a href="appendix.html#combination-charts-1"><i class="fa fa-check"></i><b>18.2.8</b> Combination Charts</a></li>
<li class="chapter" data-level="18.2.9" data-path="appendix.html"><a href="appendix.html#waterfall-charts-1"><i class="fa fa-check"></i><b>18.2.9</b> Waterfall Charts</a></li>
<li class="chapter" data-level="18.2.10" data-path="appendix.html"><a href="appendix.html#waffle-charts-1"><i class="fa fa-check"></i><b>18.2.10</b> Waffle Charts</a></li>
<li class="chapter" data-level="18.2.11" data-path="appendix.html"><a href="appendix.html#sankey-diagrams-1"><i class="fa fa-check"></i><b>18.2.11</b> Sankey Diagrams</a></li>
<li class="chapter" data-level="18.2.12" data-path="appendix.html"><a href="appendix.html#pie-charts-1"><i class="fa fa-check"></i><b>18.2.12</b> Pie Charts</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Fundamentals of People Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sql-intro" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Introduction to SQL<a href="sql-intro.html#sql-intro" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Structured Query Language (SQL)</strong> is the most common language used to extract and wrangle data contained in a relational database. SQL is an essential skill for anyone working in analytics.</p>
<div id="basics" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Basics<a href="sql-intro.html#basics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are three main <em>clauses</em> in a SQL query: (a) <code>SELECT</code>, (b) <code>FROM</code>, and (c) <code>WHERE</code>. The <code>SELECT</code> and <code>FROM</code> clauses are required, though the optional <code>WHERE</code> clause is frequently needed.</p>
<ul>
<li><strong>SELECT</strong>: Specifies the columns to include in the output</li>
<li><strong>FROM</strong>: Specifies the table(s) in which the relevant data are contained</li>
<li><strong>WHERE</strong>: Specifies the rows to search</li>
</ul>
<p>Despite the clauses being ordered as shown above (<code>SELECT</code> then <code>FROM</code> then <code>WHERE</code>), the <code>FROM</code> clause is the first to execute since we first need to identify the relevant table(s) before filtering rows and selecting columns. The <code>SELECT</code> clause is the last to execute.</p>
<p>Additional clauses are available for grouping and sorting data.</p>
<ul>
<li><strong>GROUP BY</strong>: Specifies the columns by which data should be grouped when using aggregate functions</li>
<li><strong>HAVING</strong>: Specifies conditions for filtering rows based on aggregate functions</li>
<li><strong>ORDER BY</strong>: Specifies how data should be sorted in the output</li>
</ul>
<p>When implementing aggregate functions in a <code>SELECT</code> clause, such as counting, summing, or averaging a numeric field, all other non-aggregated fields must be included in the <code>GROUP BY</code> clause.</p>
<p>When working with large datasets, it is best to filter records on the database side to avoid reading superfluous records into an analytics tool such as R only to then filter data to the relevant subset. For example, if we are performing an analysis on employees in the Research &amp; Development department, we should ideally filter to this subset on the database side rather than loading data on the entire workforce and then paring down to the relevant records within R. Fewer records can help enhance the performance of R scripts – especially when R is running on a local machine, such as a laptop, rather than on a more powerful server.</p>
<p>Though it is important to execute SQL queries directly on the database to minimize the amount of data read into R, we will use the <code>sqldf</code> library within R to demonstrate the mechanics of a SQL query for easily replicable examples. The <code>sqldf</code> library allows us to write SQL to query data frames via an embedded database engine (SQLite by default). In a practical setting, we would pass a string containing the SQL query, execute it directly against the database, and then store the query’s results to an object within R. While the syntax of SQL may vary by database, the core structure of queries is universal.</p>
<p>First, let’s load the data sets:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="sql-intro.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb102-2"><a href="sql-intro.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(peopleanalytics)</span>
<span id="cb102-3"><a href="sql-intro.html#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="sql-intro.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb102-5"><a href="sql-intro.html#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;employees&quot;</span>)</span>
<span id="cb102-6"><a href="sql-intro.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;benefits&quot;</span>)</span>
<span id="cb102-7"><a href="sql-intro.html#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;demographics&quot;</span>)</span>
<span id="cb102-8"><a href="sql-intro.html#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;job&quot;</span>)</span>
<span id="cb102-9"><a href="sql-intro.html#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;payroll&quot;</span>)</span>
<span id="cb102-10"><a href="sql-intro.html#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;performance&quot;</span>)</span>
<span id="cb102-11"><a href="sql-intro.html#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;prior_employment&quot;</span>)</span>
<span id="cb102-12"><a href="sql-intro.html#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;sentiment&quot;</span>)</span>
<span id="cb102-13"><a href="sql-intro.html#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;status&quot;</span>)</span>
<span id="cb102-14"><a href="sql-intro.html#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;tenure&quot;</span>)</span>
<span id="cb102-15"><a href="sql-intro.html#cb102-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-16"><a href="sql-intro.html#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Return row and column counts</span></span>
<span id="cb102-17"><a href="sql-intro.html#cb102-17" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(employees)</span></code></pre></div>
<pre><code>## [1] 1470   36</code></pre>
<p>Next, we will apply the <code>sqldf()</code> function to our data frame to extract specific rows and columns. In addition to the <code>SELECT</code>, <code>FROM</code>, and <code>WHERE</code> clauses, we will use the <code>LIMIT</code> clause to limit the number of rows that are displayed given the data frame’s size (<span class="math inline">\(n = 1,470\)</span>). In a practical setting, the <code>LIMIT</code> clause is only used for efficient data profiling and troubleshooting, as we would not want to arbitrarily truncate a data set used for analysis.</p>
<p>A best practice in writing SQL is to capitalize the names of clauses and functions and to use separate lines and indentation to make the SQL statements more readable:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="sql-intro.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb104-2"><a href="sql-intro.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sqldf)</span>
<span id="cb104-3"><a href="sql-intro.html#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="sql-intro.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string using the paste() function</span></span>
<span id="cb104-5"><a href="sql-intro.html#cb104-5" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb104-6"><a href="sql-intro.html#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="st">                      employee_id</span></span>
<span id="cb104-7"><a href="sql-intro.html#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="st">                    FROM</span></span>
<span id="cb104-8"><a href="sql-intro.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="st">                      employees</span></span>
<span id="cb104-9"><a href="sql-intro.html#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHERE</span></span>
<span id="cb104-10"><a href="sql-intro.html#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="st">                      dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb104-11"><a href="sql-intro.html#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="st">                    LIMIT 10&quot;</span>)</span>
<span id="cb104-12"><a href="sql-intro.html#cb104-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-13"><a href="sql-intro.html#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb104-14"><a href="sql-intro.html#cb104-14" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##    employee_id
## 1         1002
## 2         1003
## 3         1004
## 4         1005
## 5         1006
## 6         1007
## 7         1008
## 8         1009
## 9         1010
## 10        1011</code></pre>
<p>This query returned a list of employee ids for employees in the Research &amp; Development department.</p>
<p>To optimize query performance, it is important to order conditions in the <code>WHERE</code> clause beginning with the condition that will exclude the largest number of records. Conditions are executed sequentially, and each subsequent condition must evaluate all records that remain following any preceding filtering. Limiting the number of records that must be searched when evaluating each condition will reduce the time it takes the query to return results. For example, if two conditions are needed and one excludes 5,000 records while the other excludes 10, the condition that excludes 5,000 records should be listed first in the <code>WHERE</code> clause.</p>
</div>
<div id="aggregate-functions" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Aggregate Functions<a href="sql-intro.html#aggregate-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next, let’s take a look at average organization tenure by job for those in the Research &amp; Development department:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="sql-intro.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb106-2"><a href="sql-intro.html#cb106-2" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb106-3"><a href="sql-intro.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title,</span></span>
<span id="cb106-4"><a href="sql-intro.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="st">                      AVG(org_tenure)</span></span>
<span id="cb106-5"><a href="sql-intro.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="st">                    FROM</span></span>
<span id="cb106-6"><a href="sql-intro.html#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="st">                      employees</span></span>
<span id="cb106-7"><a href="sql-intro.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHERE</span></span>
<span id="cb106-8"><a href="sql-intro.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="st">                      dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb106-9"><a href="sql-intro.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="st">                    GROUP BY</span></span>
<span id="cb106-10"><a href="sql-intro.html#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title&quot;</span>)</span>
<span id="cb106-11"><a href="sql-intro.html#cb106-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-12"><a href="sql-intro.html#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb106-13"><a href="sql-intro.html#cb106-13" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##                   job_title AVG(org_tenure)
## 1 Healthcare Representative        8.618321
## 2     Laboratory Technician        5.019305
## 3                   Manager       13.673077
## 4    Manufacturing Director        7.600000
## 5         Research Director       10.937500
## 6        Research Scientist        5.113014
## 7            Vice President        9.500000</code></pre>
<p>There are 7 distinct job titles among employees in the Research &amp; Development department, and the average organization tenure for these ranges from <code>5</code> to <code>13.7</code> years.</p>
<p>Since there could be a small number of employees in certain jobs, in which case average organization tenure may not be as meaningful, we can use the <code>COUNT(*)</code> function to count the number of rows for each group. In this case, <code>COUNT(*)</code> will return the number of employees in each job in the Research &amp; Development department. We can also assign column aliases via <code>AS</code> in the <code>SELECT</code> clause to assign different names to the output fields:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="sql-intro.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb108-2"><a href="sql-intro.html#cb108-2" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb108-3"><a href="sql-intro.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title,</span></span>
<span id="cb108-4"><a href="sql-intro.html#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) AS employee_cnt,</span></span>
<span id="cb108-5"><a href="sql-intro.html#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="st">                      AVG(org_tenure) AS avg_org_tenure</span></span>
<span id="cb108-6"><a href="sql-intro.html#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="st">                    FROM</span></span>
<span id="cb108-7"><a href="sql-intro.html#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="st">                      employees</span></span>
<span id="cb108-8"><a href="sql-intro.html#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHERE</span></span>
<span id="cb108-9"><a href="sql-intro.html#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="st">                      dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb108-10"><a href="sql-intro.html#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="st">                    GROUP BY</span></span>
<span id="cb108-11"><a href="sql-intro.html#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title</span></span>
<span id="cb108-12"><a href="sql-intro.html#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="st">                    ORDER BY</span></span>
<span id="cb108-13"><a href="sql-intro.html#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title&quot;</span>)</span>
<span id="cb108-14"><a href="sql-intro.html#cb108-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-15"><a href="sql-intro.html#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb108-16"><a href="sql-intro.html#cb108-16" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##                   job_title employee_cnt avg_org_tenure
## 1 Healthcare Representative          131       8.618321
## 2     Laboratory Technician          259       5.019305
## 3                   Manager           52      13.673077
## 4    Manufacturing Director          145       7.600000
## 5         Research Director           80      10.937500
## 6        Research Scientist          292       5.113014
## 7            Vice President            2       9.500000</code></pre>
<p>The output shows that there are only 2 Vice Presidents in the Research &amp; Development department, while other job titles are much more prevalent.</p>
<p>Since relatively few employees are Vice Presidents, let’s use the <code>HAVING</code> clause to only show average organization tenure for Research &amp; Development department jobs with more than 10 employees. We can also use the <code>ROUND()</code> function to truncate average organization tenure to one significant digit:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="sql-intro.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb110-2"><a href="sql-intro.html#cb110-2" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb110-3"><a href="sql-intro.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title,</span></span>
<span id="cb110-4"><a href="sql-intro.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) AS employee_cnt,</span></span>
<span id="cb110-5"><a href="sql-intro.html#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="st">                      ROUND(AVG(org_tenure), 1) AS avg_org_tenure</span></span>
<span id="cb110-6"><a href="sql-intro.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="st">                    FROM</span></span>
<span id="cb110-7"><a href="sql-intro.html#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="st">                      employees</span></span>
<span id="cb110-8"><a href="sql-intro.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHERE</span></span>
<span id="cb110-9"><a href="sql-intro.html#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="st">                      dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb110-10"><a href="sql-intro.html#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="st">                    GROUP BY</span></span>
<span id="cb110-11"><a href="sql-intro.html#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title</span></span>
<span id="cb110-12"><a href="sql-intro.html#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="st">                    HAVING</span></span>
<span id="cb110-13"><a href="sql-intro.html#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) &gt; 10</span></span>
<span id="cb110-14"><a href="sql-intro.html#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="st">                    ORDER BY</span></span>
<span id="cb110-15"><a href="sql-intro.html#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title&quot;</span>)</span>
<span id="cb110-16"><a href="sql-intro.html#cb110-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-17"><a href="sql-intro.html#cb110-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb110-18"><a href="sql-intro.html#cb110-18" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##                   job_title employee_cnt avg_org_tenure
## 1 Healthcare Representative          131            8.6
## 2     Laboratory Technician          259            5.0
## 3                   Manager           52           13.7
## 4    Manufacturing Director          145            7.6
## 5         Research Director           80           10.9
## 6        Research Scientist          292            5.1</code></pre>
</div>
<div id="joins" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Joins<a href="sql-intro.html#joins" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In a practical setting, the required data are rarely contained within a single table. Therefore, we must query multiple tables and join them together.</p>
<p>Figure <a href="sql-intro.html#fig:data-schemas">3.1</a> illustrates how worker, position, and recruiting schemas may be related. For example, a candidate submits a job application to a posted requisition, which is connected to an open position Finance approved as part of the company’s workforce plan; when the selected candidate is hired, they become a worker with one or many events (hire, promotion, transfer, termination) and activities (learning, performance appraisals, surveys) during their tenure with the company.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:data-schemas"></span>
<img src="https://raw.githubusercontent.com/crstarbuck/peopleanalytics_book/master/graphics/dw_schema.png" alt="Related tables organized within schemas" width="100%" />
<p class="caption">
Figure 3.1: Related tables organized within schemas
</p>
</div>
<p>Tables are related using a set of keys. Each table needs a <strong>Primary Key (PK)</strong>, which is a unique identifier for each row in the table. A PK may be a single column or multiple columns; a multi-column PK is known as a <em>composite key</em>. It is generally best to leverage non-recyclable system-generated ids for PKs. A <strong>Foreign Key (FK)</strong> is a column whose values correspond to the values of a PK in another table. <strong>Referential integrity</strong> is the logical dependency of a FK on a PK, and this is an important concept in the context of relational data structures. Referential integrity constraints protect against orphaned FK values in child tables by deleting PK values from an associated parent table.</p>
<p>Figure <a href="sql-intro.html#fig:erd">3.2</a> shows an <strong>Entity Relationship Diagram (ERD)</strong> that depicts PK/FK relationships among the Position, Worker, and Requisition tables. Notice that the PK for each table shown in Figure <a href="sql-intro.html#fig:data-schemas">3.1</a> is listed as a FK in related tables.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:erd"></span>
<img src="https://raw.githubusercontent.com/crstarbuck/peopleanalytics_book/master/graphics/dw_erd.png" alt="Entity Relationship Diagram (ERD)" width="75%" />
<p class="caption">
Figure 3.2: Entity Relationship Diagram (ERD)
</p>
</div>
<p>With knowledge of the keys required to connect records across tables, there are several methods of joining the tables. Figure <a href="sql-intro.html#fig:sql-joins">3.3</a> illustrates SQL join types using Venn diagrams:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sql-joins"></span>
<img src="https://raw.githubusercontent.com/crstarbuck/peopleanalytics_book/master/graphics/sql_joins.png" alt="Types of SQL joins" width="100%" />
<p class="caption">
Figure 3.3: Types of SQL joins
</p>
</div>
<p>Both the join type and keys for related tables need to be specified in the SQL statement. The structure of SQL queries for each method of joining <code>Table A</code> and <code>Table B</code> is represented in the following code blocks:</p>
<p><strong>LEFT INCLUSIVE</strong></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="sql-intro.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  SELECT [Output Field List]</span></span>
<span id="cb112-2"><a href="sql-intro.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  FROM A </span></span>
<span id="cb112-3"><a href="sql-intro.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  LEFT OUTER JOIN B</span></span>
<span id="cb112-4"><a href="sql-intro.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  ON A.Key = B.Key</span></span></code></pre></div>
<p><strong>LEFT EXCLUSIVE</strong></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="sql-intro.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  SELECT [Output Field List]</span></span>
<span id="cb113-2"><a href="sql-intro.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  FROM A </span></span>
<span id="cb113-3"><a href="sql-intro.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  LEFT OUTER JOIN B</span></span>
<span id="cb113-4"><a href="sql-intro.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  ON A.Key = B.Key</span></span>
<span id="cb113-5"><a href="sql-intro.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  WHERE B.Key IS NULL</span></span></code></pre></div>
<p><strong>FULL OUTER INCLUSIVE</strong></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="sql-intro.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  SELECT [Output Field List]</span></span>
<span id="cb114-2"><a href="sql-intro.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  FROM A </span></span>
<span id="cb114-3"><a href="sql-intro.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  FULL OUTER JOIN B</span></span>
<span id="cb114-4"><a href="sql-intro.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  ON A.Key = B.Key</span></span></code></pre></div>
<p><strong>FULL OUTER EXCLUSIVE</strong></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="sql-intro.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  SELECT [Output Field List]</span></span>
<span id="cb115-2"><a href="sql-intro.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  FROM A </span></span>
<span id="cb115-3"><a href="sql-intro.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  FULL OUTER JOIN B</span></span>
<span id="cb115-4"><a href="sql-intro.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  ON A.Key = B.Key</span></span>
<span id="cb115-5"><a href="sql-intro.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  WHERE A.Key IS NULL OR B.Key IS NULL  </span></span></code></pre></div>
<p><strong>RIGHT INCLUSIVE</strong></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="sql-intro.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  SELECT [Output Field List]</span></span>
<span id="cb116-2"><a href="sql-intro.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  FROM A </span></span>
<span id="cb116-3"><a href="sql-intro.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  RIGHT OUTER JOIN B</span></span>
<span id="cb116-4"><a href="sql-intro.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  ON A.Key = B.Key</span></span></code></pre></div>
<p><strong>RIGHT EXCLUSIVE</strong></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="sql-intro.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  SELECT [Output Field List]</span></span>
<span id="cb117-2"><a href="sql-intro.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  FROM A </span></span>
<span id="cb117-3"><a href="sql-intro.html#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  LEFT OUTER JOIN B</span></span>
<span id="cb117-4"><a href="sql-intro.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  ON A.Key = B.Key</span></span>
<span id="cb117-5"><a href="sql-intro.html#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  WHERE A.Key IS NULL</span></span></code></pre></div>
<p><strong>INNER JOIN</strong></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="sql-intro.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  SELECT [Output Field List]</span></span>
<span id="cb118-2"><a href="sql-intro.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  FROM A </span></span>
<span id="cb118-3"><a href="sql-intro.html#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  INNER JOIN B</span></span>
<span id="cb118-4"><a href="sql-intro.html#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  ON A.Key = B.Key</span></span></code></pre></div>
<p>To illustrate how SQL joins work, we will leverage three of the data sets used to produce the consolidated <code>employees</code> data set that will be leveraged throughout this book: <code>job</code>, <code>tenure</code>, and <code>demographics</code>. In a people analytics context, employee id is often the PK since this identifier should not be shared by two or more employees – past, present, or future. Email or network id may also be a suitable PK. We will use the <code>employee_id</code> column in each of the three data frames to facilitate joins.</p>
<p>Let’s query these data frames to return the average organization tenure and average commute distance for employees in the Research &amp; Development department, grouped by jobs with more than 10 employees. To accomplish this, we will leverage an <code>INNER JOIN</code>, which will return records only for employee ids which are present in all three data frames. For example, if a record exists in <code>demographics</code> and <code>tenure</code> for a particular employee id, but there is no corresponding record in <code>job</code>, that employee id would not be included in the output.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="sql-intro.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb119-2"><a href="sql-intro.html#cb119-2" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb119-3"><a href="sql-intro.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title,</span></span>
<span id="cb119-4"><a href="sql-intro.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) AS employee_cnt,</span></span>
<span id="cb119-5"><a href="sql-intro.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="st">                      ROUND(AVG(org_tenure), 1) AS avg_org_tenure,</span></span>
<span id="cb119-6"><a href="sql-intro.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="st">                      ROUND(AVG(commute_dist), 1) AS avg_commute_dist</span></span>
<span id="cb119-7"><a href="sql-intro.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="st">                    FROM</span></span>
<span id="cb119-8"><a href="sql-intro.html#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics</span></span>
<span id="cb119-9"><a href="sql-intro.html#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="st">                      INNER JOIN</span></span>
<span id="cb119-10"><a href="sql-intro.html#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="st">                        tenure</span></span>
<span id="cb119-11"><a href="sql-intro.html#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="st">                      ON</span></span>
<span id="cb119-12"><a href="sql-intro.html#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id = tenure.employee_id</span></span>
<span id="cb119-13"><a href="sql-intro.html#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="st">                      INNER JOIN</span></span>
<span id="cb119-14"><a href="sql-intro.html#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="st">                        job</span></span>
<span id="cb119-15"><a href="sql-intro.html#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="st">                      ON</span></span>
<span id="cb119-16"><a href="sql-intro.html#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id = job.employee_id</span></span>
<span id="cb119-17"><a href="sql-intro.html#cb119-17" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHERE</span></span>
<span id="cb119-18"><a href="sql-intro.html#cb119-18" aria-hidden="true" tabindex="-1"></a><span class="st">                      dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb119-19"><a href="sql-intro.html#cb119-19" aria-hidden="true" tabindex="-1"></a><span class="st">                    GROUP BY</span></span>
<span id="cb119-20"><a href="sql-intro.html#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title</span></span>
<span id="cb119-21"><a href="sql-intro.html#cb119-21" aria-hidden="true" tabindex="-1"></a><span class="st">                    HAVING</span></span>
<span id="cb119-22"><a href="sql-intro.html#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) &gt; 10</span></span>
<span id="cb119-23"><a href="sql-intro.html#cb119-23" aria-hidden="true" tabindex="-1"></a><span class="st">                    ORDER BY</span></span>
<span id="cb119-24"><a href="sql-intro.html#cb119-24" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title&quot;</span>)</span>
<span id="cb119-25"><a href="sql-intro.html#cb119-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-26"><a href="sql-intro.html#cb119-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb119-27"><a href="sql-intro.html#cb119-27" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##                   job_title employee_cnt avg_org_tenure avg_commute_dist
## 1 Healthcare Representative          131            8.6              9.8
## 2     Laboratory Technician          259            5.0              9.4
## 3                   Manager           52           13.7              7.2
## 4    Manufacturing Director          145            7.6              9.5
## 5         Research Director           80           10.9              8.4
## 6        Research Scientist          292            5.1              9.0</code></pre>
<p>Note that the <code>INNER JOIN</code> in this SQL query was structured such that both <code>tenure</code> and <code>job</code> were joined to <code>demographics</code> via the <code>employee_id</code> column. We could have instead joined <code>job</code> to <code>tenure</code> since we joined <code>tenure</code> to <code>demographics</code>; this would have achieved the same result since all employee ids exist in each of the three data frames.</p>
<p>If it were possible for all employee ids to exist in <code>demographics</code> but not in either <code>tenure</code> or <code>job</code>, we could leverage a <code>LEFT JOIN</code> to ensure all records from <code>demographics</code> are included in the output irrespective of whether they have matches in <code>tenure</code> or <code>job</code>:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="sql-intro.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb121-2"><a href="sql-intro.html#cb121-2" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb121-3"><a href="sql-intro.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title,</span></span>
<span id="cb121-4"><a href="sql-intro.html#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) AS employee_cnt,</span></span>
<span id="cb121-5"><a href="sql-intro.html#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="st">                      ROUND(AVG(org_tenure), 1) AS avg_org_tenure,</span></span>
<span id="cb121-6"><a href="sql-intro.html#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="st">                      ROUND(AVG(commute_dist), 1) AS avg_commute_dist</span></span>
<span id="cb121-7"><a href="sql-intro.html#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="st">                    FROM</span></span>
<span id="cb121-8"><a href="sql-intro.html#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics</span></span>
<span id="cb121-9"><a href="sql-intro.html#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="st">                      LEFT JOIN</span></span>
<span id="cb121-10"><a href="sql-intro.html#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="st">                        tenure</span></span>
<span id="cb121-11"><a href="sql-intro.html#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="st">                      ON</span></span>
<span id="cb121-12"><a href="sql-intro.html#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id = tenure.employee_id</span></span>
<span id="cb121-13"><a href="sql-intro.html#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="st">                      LEFT JOIN</span></span>
<span id="cb121-14"><a href="sql-intro.html#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="st">                        job</span></span>
<span id="cb121-15"><a href="sql-intro.html#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="st">                      ON</span></span>
<span id="cb121-16"><a href="sql-intro.html#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id = job.employee_id</span></span>
<span id="cb121-17"><a href="sql-intro.html#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHERE</span></span>
<span id="cb121-18"><a href="sql-intro.html#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="st">                      dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb121-19"><a href="sql-intro.html#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="st">                    GROUP BY</span></span>
<span id="cb121-20"><a href="sql-intro.html#cb121-20" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title</span></span>
<span id="cb121-21"><a href="sql-intro.html#cb121-21" aria-hidden="true" tabindex="-1"></a><span class="st">                    HAVING</span></span>
<span id="cb121-22"><a href="sql-intro.html#cb121-22" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) &gt; 10</span></span>
<span id="cb121-23"><a href="sql-intro.html#cb121-23" aria-hidden="true" tabindex="-1"></a><span class="st">                    ORDER BY</span></span>
<span id="cb121-24"><a href="sql-intro.html#cb121-24" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title&quot;</span>)</span>
<span id="cb121-25"><a href="sql-intro.html#cb121-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-26"><a href="sql-intro.html#cb121-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb121-27"><a href="sql-intro.html#cb121-27" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##                   job_title employee_cnt avg_org_tenure avg_commute_dist
## 1 Healthcare Representative          131            8.6              9.8
## 2     Laboratory Technician          259            5.0              9.4
## 3                   Manager           52           13.7              7.2
## 4    Manufacturing Director          145            7.6              9.5
## 5         Research Director           80           10.9              8.4
## 6        Research Scientist          292            5.1              9.0</code></pre>
<p>In this case, if demographics is the base data set which contains all employee ids (i.e., the ‘LEFT’ data set), it is important for <code>tenure</code> and <code>job</code> to be joined to it. Joining <code>job</code> to <code>tenure</code> may result in information loss if an employee id exists in <code>demographics</code> and <code>job</code> but not in the intermediate <code>tenure</code> data set.</p>
<p>When integrating data within R, the <code>tidyverse</code> provides a more efficient and parsimonious method of joining many data sets using various join types. Within this framework, components are chained together via the <code>|&gt;</code> operator. Though slightly less efficient, the legacy <code>%&gt;%</code> operator could be used as an alternative. The example below joins nine data sets into a single <code>employees</code> data frame using a left join on the <code>employee_id</code> column:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="sql-intro.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb123-2"><a href="sql-intro.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb123-3"><a href="sql-intro.html#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="sql-intro.html#cb123-4" aria-hidden="true" tabindex="-1"></a>employees <span class="ot">&lt;-</span> <span class="fu">list</span>(demographics,</span>
<span id="cb123-5"><a href="sql-intro.html#cb123-5" aria-hidden="true" tabindex="-1"></a>                  status,</span>
<span id="cb123-6"><a href="sql-intro.html#cb123-6" aria-hidden="true" tabindex="-1"></a>                  benefits,</span>
<span id="cb123-7"><a href="sql-intro.html#cb123-7" aria-hidden="true" tabindex="-1"></a>                  job,</span>
<span id="cb123-8"><a href="sql-intro.html#cb123-8" aria-hidden="true" tabindex="-1"></a>                  payroll,</span>
<span id="cb123-9"><a href="sql-intro.html#cb123-9" aria-hidden="true" tabindex="-1"></a>                  performance,</span>
<span id="cb123-10"><a href="sql-intro.html#cb123-10" aria-hidden="true" tabindex="-1"></a>                  prior_employment,</span>
<span id="cb123-11"><a href="sql-intro.html#cb123-11" aria-hidden="true" tabindex="-1"></a>                  sentiment,</span>
<span id="cb123-12"><a href="sql-intro.html#cb123-12" aria-hidden="true" tabindex="-1"></a>                  tenure) <span class="sc">|&gt;</span></span>
<span id="cb123-13"><a href="sql-intro.html#cb123-13" aria-hidden="true" tabindex="-1"></a>                  purrr<span class="sc">::</span><span class="fu">reduce</span>(left_join, <span class="at">by =</span> <span class="st">&quot;employee_id&quot;</span>)</span></code></pre></div>
</div>
<div id="subqueries" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Subqueries<a href="sql-intro.html#subqueries" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Subqueries</strong> are queries nested within other queries. Subqueries are often referred to as <strong>inner queries</strong>, while the main queries are referred to as <strong>outer queries</strong>.</p>
<p>For example, if we are interested in performing an analysis on employees with more than a year of organization tenure, we can use a subquery to pass a list of employee ids that meet this criterion into the outer query for filtering. In this case, we would not need to include <code>tenure</code> in the join conditions of our main query:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="sql-intro.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb124-2"><a href="sql-intro.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Since employee_id exists in multiple data sets, we would need to specify the data set to include this field in the outer query</span></span>
<span id="cb124-3"><a href="sql-intro.html#cb124-3" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb124-4"><a href="sql-intro.html#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title,</span></span>
<span id="cb124-5"><a href="sql-intro.html#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) AS employee_cnt,</span></span>
<span id="cb124-6"><a href="sql-intro.html#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="st">                      ROUND(AVG(commute_dist), 1) AS avg_commute_dist</span></span>
<span id="cb124-7"><a href="sql-intro.html#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="st">                    FROM</span></span>
<span id="cb124-8"><a href="sql-intro.html#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics</span></span>
<span id="cb124-9"><a href="sql-intro.html#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="st">                      LEFT JOIN</span></span>
<span id="cb124-10"><a href="sql-intro.html#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="st">                        job</span></span>
<span id="cb124-11"><a href="sql-intro.html#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="st">                      ON</span></span>
<span id="cb124-12"><a href="sql-intro.html#cb124-12" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id = job.employee_id</span></span>
<span id="cb124-13"><a href="sql-intro.html#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHERE</span></span>
<span id="cb124-14"><a href="sql-intro.html#cb124-14" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id IN (SELECT employee_id FROM tenure WHERE org_tenure &gt; 1)</span></span>
<span id="cb124-15"><a href="sql-intro.html#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="st">                      AND </span></span>
<span id="cb124-16"><a href="sql-intro.html#cb124-16" aria-hidden="true" tabindex="-1"></a><span class="st">                        dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb124-17"><a href="sql-intro.html#cb124-17" aria-hidden="true" tabindex="-1"></a><span class="st">                    GROUP BY</span></span>
<span id="cb124-18"><a href="sql-intro.html#cb124-18" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title</span></span>
<span id="cb124-19"><a href="sql-intro.html#cb124-19" aria-hidden="true" tabindex="-1"></a><span class="st">                    HAVING</span></span>
<span id="cb124-20"><a href="sql-intro.html#cb124-20" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) &gt; 10</span></span>
<span id="cb124-21"><a href="sql-intro.html#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="st">                    ORDER BY</span></span>
<span id="cb124-22"><a href="sql-intro.html#cb124-22" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title&quot;</span>)</span>
<span id="cb124-23"><a href="sql-intro.html#cb124-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-24"><a href="sql-intro.html#cb124-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb124-25"><a href="sql-intro.html#cb124-25" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##                   job_title employee_cnt avg_commute_dist
## 1 Healthcare Representative          118              9.7
## 2     Laboratory Technician          198              9.6
## 3                   Manager           49              6.9
## 4    Manufacturing Director          133              9.7
## 5         Research Director           74              8.3
## 6        Research Scientist          238              9.2</code></pre>
</div>
<div id="virtual-tables" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Virtual Tables<a href="sql-intro.html#virtual-tables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An alternative to a subquery is creating a <strong>virtual table</strong> in the <code>FROM</code> clause. When using an <code>INNER JOIN</code> to connect <code>demographics</code> to the virtual table <code>ids</code>, which provides a list of employee ids for those with more than a year of organization tenure, any records in <code>demographics</code> or <code>job</code> that do not relate to employees with at least a year of organization tenure will be dropped. This is true even though a <code>LEFT JOIN</code> is used to join <code>job</code> to <code>demographics</code> since records in <code>demographics</code> will be filtered based on <code>employee_id</code> matches in the virtual table. With this approach, our <code>WHERE</code> clause is limited to the <code>department = 'Research &amp; Development'</code> condition:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="sql-intro.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb126-2"><a href="sql-intro.html#cb126-2" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb126-3"><a href="sql-intro.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title,</span></span>
<span id="cb126-4"><a href="sql-intro.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) AS employee_cnt,</span></span>
<span id="cb126-5"><a href="sql-intro.html#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="st">                      ROUND(AVG(commute_dist), 1) AS avg_commute_dist</span></span>
<span id="cb126-6"><a href="sql-intro.html#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="st">                    FROM</span></span>
<span id="cb126-7"><a href="sql-intro.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics</span></span>
<span id="cb126-8"><a href="sql-intro.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="st">                      LEFT JOIN</span></span>
<span id="cb126-9"><a href="sql-intro.html#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="st">                        job</span></span>
<span id="cb126-10"><a href="sql-intro.html#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="st">                      ON</span></span>
<span id="cb126-11"><a href="sql-intro.html#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id = job.employee_id</span></span>
<span id="cb126-12"><a href="sql-intro.html#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="st">                      INNER JOIN</span></span>
<span id="cb126-13"><a href="sql-intro.html#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="st">                        (SELECT employee_id FROM tenure WHERE org_tenure &gt; 1) ids</span></span>
<span id="cb126-14"><a href="sql-intro.html#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="st">                      ON</span></span>
<span id="cb126-15"><a href="sql-intro.html#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id = ids.employee_id</span></span>
<span id="cb126-16"><a href="sql-intro.html#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHERE</span></span>
<span id="cb126-17"><a href="sql-intro.html#cb126-17" aria-hidden="true" tabindex="-1"></a><span class="st">                      dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb126-18"><a href="sql-intro.html#cb126-18" aria-hidden="true" tabindex="-1"></a><span class="st">                    GROUP BY</span></span>
<span id="cb126-19"><a href="sql-intro.html#cb126-19" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title</span></span>
<span id="cb126-20"><a href="sql-intro.html#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="st">                    HAVING</span></span>
<span id="cb126-21"><a href="sql-intro.html#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="st">                      COUNT(*) &gt; 10</span></span>
<span id="cb126-22"><a href="sql-intro.html#cb126-22" aria-hidden="true" tabindex="-1"></a><span class="st">                    ORDER BY</span></span>
<span id="cb126-23"><a href="sql-intro.html#cb126-23" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title&quot;</span>)</span>
<span id="cb126-24"><a href="sql-intro.html#cb126-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-25"><a href="sql-intro.html#cb126-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb126-26"><a href="sql-intro.html#cb126-26" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##                   job_title employee_cnt avg_commute_dist
## 1 Healthcare Representative          118              9.7
## 2     Laboratory Technician          198              9.6
## 3                   Manager           49              6.9
## 4    Manufacturing Director          133              9.7
## 5         Research Director           74              8.3
## 6        Research Scientist          238              9.2</code></pre>
<p>As you can see, the output of the query using a virtual table matches the results from the preceding approach that utilized a subquery.</p>
</div>
<div id="window-functions" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Window Functions<a href="sql-intro.html#window-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Window functions</strong> are used for performing calculations over a set of rows without collapsing the records. Unlike the aggregate functions we’ve covered, window functions do not collapse rows into a single value; the calculated value is returned for each of the rows over which the calculation is performed.</p>
<p>For example, we can assign an organization tenure rank by Research &amp; Development job using the <code>RANK()</code> and <code>OVER()</code> functions in the <code>SELECT</code> clause. The <code>PARTITION BY</code> argument functions like a <code>GROUP BY</code> clause but without collapsing rows, while the <code>ORDER BY</code> argument sorts the records in ascending (<code>ASC</code>) or descending (<code>DESC</code>) order for proper ranking:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="sql-intro.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb128-2"><a href="sql-intro.html#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Limit output to 10 records since query does not collapse records</span></span>
<span id="cb128-3"><a href="sql-intro.html#cb128-3" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb128-4"><a href="sql-intro.html#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="st">                      demographics.employee_id,</span></span>
<span id="cb128-5"><a href="sql-intro.html#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title,</span></span>
<span id="cb128-6"><a href="sql-intro.html#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="st">                      commute_dist,</span></span>
<span id="cb128-7"><a href="sql-intro.html#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="st">                      RANK () OVER (PARTITION BY job_title ORDER BY commute_dist DESC) AS commute_dist_rank</span></span>
<span id="cb128-8"><a href="sql-intro.html#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="st">                    FROM</span></span>
<span id="cb128-9"><a href="sql-intro.html#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics</span></span>
<span id="cb128-10"><a href="sql-intro.html#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="st">                      LEFT JOIN</span></span>
<span id="cb128-11"><a href="sql-intro.html#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="st">                        job</span></span>
<span id="cb128-12"><a href="sql-intro.html#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="st">                      ON</span></span>
<span id="cb128-13"><a href="sql-intro.html#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id = job.employee_id</span></span>
<span id="cb128-14"><a href="sql-intro.html#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="st">                      INNER JOIN</span></span>
<span id="cb128-15"><a href="sql-intro.html#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="st">                        (SELECT employee_id FROM tenure WHERE org_tenure &gt; 1) ids</span></span>
<span id="cb128-16"><a href="sql-intro.html#cb128-16" aria-hidden="true" tabindex="-1"></a><span class="st">                      ON</span></span>
<span id="cb128-17"><a href="sql-intro.html#cb128-17" aria-hidden="true" tabindex="-1"></a><span class="st">                        demographics.employee_id = ids.employee_id</span></span>
<span id="cb128-18"><a href="sql-intro.html#cb128-18" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHERE</span></span>
<span id="cb128-19"><a href="sql-intro.html#cb128-19" aria-hidden="true" tabindex="-1"></a><span class="st">                      dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb128-20"><a href="sql-intro.html#cb128-20" aria-hidden="true" tabindex="-1"></a><span class="st">                    ORDER BY</span></span>
<span id="cb128-21"><a href="sql-intro.html#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="st">                      job_title,</span></span>
<span id="cb128-22"><a href="sql-intro.html#cb128-22" aria-hidden="true" tabindex="-1"></a><span class="st">                      commute_dist_rank</span></span>
<span id="cb128-23"><a href="sql-intro.html#cb128-23" aria-hidden="true" tabindex="-1"></a><span class="st">                    LIMIT 10&quot;</span>)</span>
<span id="cb128-24"><a href="sql-intro.html#cb128-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-25"><a href="sql-intro.html#cb128-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb128-26"><a href="sql-intro.html#cb128-26" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##    employee_id                 job_title commute_dist commute_dist_rank
## 1         2325 Healthcare Representative           29                 1
## 2         1414 Healthcare Representative           28                 2
## 3         1010 Healthcare Representative           27                 3
## 4         1573 Healthcare Representative           27                 3
## 5         2200 Healthcare Representative           26                 5
## 6         1730 Healthcare Representative           25                 6
## 7         1833 Healthcare Representative           25                 6
## 8         1993 Healthcare Representative           25                 6
## 9         2415 Healthcare Representative           25                 6
## 10        1164 Healthcare Representative           24                10</code></pre>
<p>Notice that in the case of commute distance ties, the <code>RANK()</code> function assigns the same rank and then adds the number of ties to that rank to determine the rank for the next highest value of commute distance.</p>
<p>We can also treat this query as a virtual table, and then filter on the derived <code>commute_dist_rank</code> field to return the highest commute distance for each job. We can add a <code>DISTINCT()</code> function in the <code>SELECT</code> clause to collapse jobs for which there are more than one employee with the max commute distance, and display the number of ties for each using the <code>COUNT(*)</code> function:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="sql-intro.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb130-2"><a href="sql-intro.html#cb130-2" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SELECT</span></span>
<span id="cb130-3"><a href="sql-intro.html#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="st">                        DISTINCT(job_title) AS job_title,</span></span>
<span id="cb130-4"><a href="sql-intro.html#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="st">                        COUNT(*) AS employee_count,</span></span>
<span id="cb130-5"><a href="sql-intro.html#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="st">                        commute_dist</span></span>
<span id="cb130-6"><a href="sql-intro.html#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="st">                     FROM</span></span>
<span id="cb130-7"><a href="sql-intro.html#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="st">                        (SELECT</span></span>
<span id="cb130-8"><a href="sql-intro.html#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="st">                          demographics.employee_id,</span></span>
<span id="cb130-9"><a href="sql-intro.html#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="st">                          job_title,</span></span>
<span id="cb130-10"><a href="sql-intro.html#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="st">                          commute_dist,</span></span>
<span id="cb130-11"><a href="sql-intro.html#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="st">                          RANK () OVER (PARTITION BY job_title ORDER BY commute_dist DESC) AS commute_dist_rank</span></span>
<span id="cb130-12"><a href="sql-intro.html#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="st">                        FROM</span></span>
<span id="cb130-13"><a href="sql-intro.html#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="st">                            demographics</span></span>
<span id="cb130-14"><a href="sql-intro.html#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="st">                          LEFT JOIN</span></span>
<span id="cb130-15"><a href="sql-intro.html#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="st">                            job</span></span>
<span id="cb130-16"><a href="sql-intro.html#cb130-16" aria-hidden="true" tabindex="-1"></a><span class="st">                          ON</span></span>
<span id="cb130-17"><a href="sql-intro.html#cb130-17" aria-hidden="true" tabindex="-1"></a><span class="st">                            demographics.employee_id = job.employee_id</span></span>
<span id="cb130-18"><a href="sql-intro.html#cb130-18" aria-hidden="true" tabindex="-1"></a><span class="st">                          INNER JOIN</span></span>
<span id="cb130-19"><a href="sql-intro.html#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="st">                            (SELECT employee_id FROM tenure WHERE org_tenure &gt; 1) ids</span></span>
<span id="cb130-20"><a href="sql-intro.html#cb130-20" aria-hidden="true" tabindex="-1"></a><span class="st">                          ON</span></span>
<span id="cb130-21"><a href="sql-intro.html#cb130-21" aria-hidden="true" tabindex="-1"></a><span class="st">                            demographics.employee_id = ids.employee_id</span></span>
<span id="cb130-22"><a href="sql-intro.html#cb130-22" aria-hidden="true" tabindex="-1"></a><span class="st">                        WHERE</span></span>
<span id="cb130-23"><a href="sql-intro.html#cb130-23" aria-hidden="true" tabindex="-1"></a><span class="st">                          dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb130-24"><a href="sql-intro.html#cb130-24" aria-hidden="true" tabindex="-1"></a><span class="st">                        ORDER BY</span></span>
<span id="cb130-25"><a href="sql-intro.html#cb130-25" aria-hidden="true" tabindex="-1"></a><span class="st">                          job_title,</span></span>
<span id="cb130-26"><a href="sql-intro.html#cb130-26" aria-hidden="true" tabindex="-1"></a><span class="st">                          commute_dist_rank) tbl</span></span>
<span id="cb130-27"><a href="sql-intro.html#cb130-27" aria-hidden="true" tabindex="-1"></a><span class="st">                      WHERE</span></span>
<span id="cb130-28"><a href="sql-intro.html#cb130-28" aria-hidden="true" tabindex="-1"></a><span class="st">                        tbl.commute_dist_rank = 1</span></span>
<span id="cb130-29"><a href="sql-intro.html#cb130-29" aria-hidden="true" tabindex="-1"></a><span class="st">                      GROUP BY</span></span>
<span id="cb130-30"><a href="sql-intro.html#cb130-30" aria-hidden="true" tabindex="-1"></a><span class="st">                        job_title&quot;</span>)</span>
<span id="cb130-31"><a href="sql-intro.html#cb130-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-32"><a href="sql-intro.html#cb130-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb130-33"><a href="sql-intro.html#cb130-33" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##                   job_title employee_count commute_dist
## 1 Healthcare Representative              1           29
## 2     Laboratory Technician              6           29
## 3                   Manager              2           29
## 4    Manufacturing Director              4           29
## 5         Research Director              3           28
## 6        Research Scientist              4           29
## 7            Vice President              1            8</code></pre>
</div>
<div id="common-table-expressions-ctes" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Common Table Expressions (CTEs)<a href="sql-intro.html#common-table-expressions-ctes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An alternative to the virtual table approach is to use a <strong>common table expression (CTE)</strong>, which is the result set of a query that exists temporarily and only for use in a larger query. Like the virtual table example, CTEs do not persist data in objects or tables; the data exist only for the duration of the query.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="sql-intro.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SQL query as a character string</span></span>
<span id="cb132-2"><a href="sql-intro.html#cb132-2" aria-hidden="true" tabindex="-1"></a>sql_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;WITH max_commute_job</span></span>
<span id="cb132-3"><a href="sql-intro.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="st">                     AS</span></span>
<span id="cb132-4"><a href="sql-intro.html#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="st">                        (SELECT</span></span>
<span id="cb132-5"><a href="sql-intro.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="st">                          demographics.employee_id,</span></span>
<span id="cb132-6"><a href="sql-intro.html#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="st">                          job_title,</span></span>
<span id="cb132-7"><a href="sql-intro.html#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="st">                          commute_dist,</span></span>
<span id="cb132-8"><a href="sql-intro.html#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="st">                          RANK () OVER (PARTITION BY job_title ORDER BY commute_dist DESC) AS commute_dist_rank</span></span>
<span id="cb132-9"><a href="sql-intro.html#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="st">                        FROM</span></span>
<span id="cb132-10"><a href="sql-intro.html#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="st">                            demographics</span></span>
<span id="cb132-11"><a href="sql-intro.html#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="st">                          LEFT JOIN</span></span>
<span id="cb132-12"><a href="sql-intro.html#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="st">                            job</span></span>
<span id="cb132-13"><a href="sql-intro.html#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="st">                          ON</span></span>
<span id="cb132-14"><a href="sql-intro.html#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="st">                            demographics.employee_id = job.employee_id</span></span>
<span id="cb132-15"><a href="sql-intro.html#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="st">                          INNER JOIN</span></span>
<span id="cb132-16"><a href="sql-intro.html#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="st">                            (SELECT employee_id FROM tenure WHERE org_tenure &gt; 1) ids</span></span>
<span id="cb132-17"><a href="sql-intro.html#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="st">                          ON</span></span>
<span id="cb132-18"><a href="sql-intro.html#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="st">                            demographics.employee_id = ids.employee_id</span></span>
<span id="cb132-19"><a href="sql-intro.html#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="st">                        WHERE</span></span>
<span id="cb132-20"><a href="sql-intro.html#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="st">                          dept = &#39;Research &amp; Development&#39;</span></span>
<span id="cb132-21"><a href="sql-intro.html#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="st">                        ORDER BY</span></span>
<span id="cb132-22"><a href="sql-intro.html#cb132-22" aria-hidden="true" tabindex="-1"></a><span class="st">                          job_title,</span></span>
<span id="cb132-23"><a href="sql-intro.html#cb132-23" aria-hidden="true" tabindex="-1"></a><span class="st">                          commute_dist_rank)</span></span>
<span id="cb132-24"><a href="sql-intro.html#cb132-24" aria-hidden="true" tabindex="-1"></a><span class="st">                      </span></span>
<span id="cb132-25"><a href="sql-intro.html#cb132-25" aria-hidden="true" tabindex="-1"></a><span class="st">                      SELECT</span></span>
<span id="cb132-26"><a href="sql-intro.html#cb132-26" aria-hidden="true" tabindex="-1"></a><span class="st">                        DISTINCT(job_title) AS job_title,</span></span>
<span id="cb132-27"><a href="sql-intro.html#cb132-27" aria-hidden="true" tabindex="-1"></a><span class="st">                        COUNT(*) AS employee_count,</span></span>
<span id="cb132-28"><a href="sql-intro.html#cb132-28" aria-hidden="true" tabindex="-1"></a><span class="st">                        commute_dist</span></span>
<span id="cb132-29"><a href="sql-intro.html#cb132-29" aria-hidden="true" tabindex="-1"></a><span class="st">                     FROM</span></span>
<span id="cb132-30"><a href="sql-intro.html#cb132-30" aria-hidden="true" tabindex="-1"></a><span class="st">                        max_commute_job</span></span>
<span id="cb132-31"><a href="sql-intro.html#cb132-31" aria-hidden="true" tabindex="-1"></a><span class="st">                      WHERE</span></span>
<span id="cb132-32"><a href="sql-intro.html#cb132-32" aria-hidden="true" tabindex="-1"></a><span class="st">                        commute_dist_rank = 1</span></span>
<span id="cb132-33"><a href="sql-intro.html#cb132-33" aria-hidden="true" tabindex="-1"></a><span class="st">                      GROUP BY</span></span>
<span id="cb132-34"><a href="sql-intro.html#cb132-34" aria-hidden="true" tabindex="-1"></a><span class="st">                        job_title&quot;</span>)</span>
<span id="cb132-35"><a href="sql-intro.html#cb132-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-36"><a href="sql-intro.html#cb132-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query</span></span>
<span id="cb132-37"><a href="sql-intro.html#cb132-37" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(sql_string)</span></code></pre></div>
<pre><code>##                   job_title employee_count commute_dist
## 1 Healthcare Representative              1           29
## 2     Laboratory Technician              6           29
## 3                   Manager              2           29
## 4    Manufacturing Director              4           29
## 5         Research Director              3           28
## 6        Research Scientist              4           29
## 7            Vice President              1            8</code></pre>
</div>
<div id="review-questions-1" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Review Questions<a href="sql-intro.html#review-questions-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>What two clauses must always be present in a SQL query?</p></li>
<li><p>What SQL clause is executed first at run time?</p></li>
<li><p>To optimize the performance of a SQL query, how should conditions in the WHERE clause be ordered?</p></li>
<li><p>How do aggregate functions differ from window functions in SQL?</p></li>
<li><p>What is a subquery?</p></li>
<li><p>What is the difference between an INNER JOIN and LEFT JOIN?</p></li>
<li><p>What is the purpose of a common table expression (CTE)?</p></li>
<li><p>What does the PARTITION BY function do?</p></li>
<li><p>Why is it important for queries to limit records on the database side before reading into R?</p></li>
<li><p>In which clause are filter conditions applied to aggregate functions (e.g., <code>COUNT(*) &gt; 5</code>, <code>AVG(salary) &lt; 100000</code>)?</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="research.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["The_Fundamentals_of_People_Analytics.pdf", "The_Fundamentals_of_People_Analytics.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
