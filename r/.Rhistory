# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
treat_diff <- post_group_treat_ind - pre_group_treat_ind
ctrl_diff <- post_group_ctrl_ind - pre_group_ctrl_ind
# Compute Shapiro-Wilk test of normality
shapiro.test(treat_diff)
ggplot2::ggplot() +
ggplot2::aes(treat_diff) +
ggplot2::labs(x = "Pre/Post Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw() +
ggplot2::theme(plot.title = element_text(hjust = 0.5))
post_group_treat_ind - pre_group_treat_ind
post_group_ctrl_ind - pre_group_ctrl_ind
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Store happiness indices for treatment and control groups
pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices for the treatment group
post_group_treat_ind <- pre_group_treat_ind + sample(c(-.1, 0, .1, .2, .3), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(0, .2), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
post_group_treat_ind - pre_group_treat_ind
post_group_ctrl_ind - pre_group_ctrl_ind
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Store happiness indices for treatment and control groups
pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.3, .4), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(.1, .2), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
treat_diff <- post_group_treat_ind - pre_group_treat_ind
ctrl_diff <- post_group_ctrl_ind - pre_group_ctrl_ind
# Compute Shapiro-Wilk test of normality
shapiro.test(treat_diff)
shapiro.test(ctrl_diff)
ggplot2::ggplot() +
ggplot2::aes(treat_diff) +
ggplot2::labs(x = "Pre/Post Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw() +
ggplot2::theme(plot.title = element_text(hjust = 0.5))
# Compute Shapiro-Wilk test of normality
shapiro.test(treat_diff)
shapiro.test(ctrl_diff)
i = 1
for (a in 1:4) {
for (b in 1:4){
for (c in 1:4){
for (d in 1:4){
i = i+1
}
}
}
}
i
4^2
4*3*2*1
i = 1
df = null
i = 1
df = NULL
for (a in 1:4) {
for (b in 1:4){
for (c in 1:4){
for (d in 1:4){
df[i] <- c(a,b,c,d)
i = i+1
}
}
}
}
unique(df)
df
print(a, b, c, d)
paste0(a, b, c, d)
i = 1
df = NULL
for (a in 1:4) {
for (b in 1:4){
for (c in 1:4){
for (d in 1:4){
paste0(a, b, c, d)
i = i+1
}
}
}
}
i = 1
df = NULL
for (a in 1:4) {
for (b in 1:4){
for (c in 1:4){
for (d in 1:4){
print(a, b, c, d)
i = i+1
}
}
}
}
i = 1
df = NULL
for (a in 1:4) {
for (b in 1:4){
for (c in 1:4){
for (d in 1:4){
df <- rbind(df, cbind.data.frame(
result = c(a,b,c,d)))
i = i+1
}
}
}
}
View(df)
i = 1
df = NULL
for (a in 1:4) {
for (b in 1:4){
for (c in 1:4){
for (d in 1:4){
df <- rbind(df, cbind.data.frame(
result = paste0(a,b,c,d)))
i = i+1
}
}
}
}
View(df)
unique(df$result)
length(unique(df$result))
4*3*2*1 / 4*3*2*1
4*3*2*1
2^4 - 4 - 1
pre_group_ctrl_ind
unique(pre_group_ctrl_ind)
ctrl_diff
treat_diff
unique(treat_diff)
unique(ctrl_diff)
post_group_treat_ind
pre_group_treat_ind
post_group_treat_ind - pre_group_treat_ind
post_group_treat_ind
pre_group_treat_ind
unique(post_group_treat_ind)
unique(pre_group_treat_ind)
lapply(post_group_treat_ind, function(x) x - pre_group_treat_ind)
# Calculate pre/post differences
treat_diff <- lapply(post_group_treat_ind, function(x) x - pre_group_treat_ind)
ctrl_diff <- lapply(post_group_ctrl_ind, function(x) x - pre_group_ctrl_ind)
treat_diff
# Calculate pre/post differences
treat_diff <- lapply(post_group_treat_ind, function(x) x - pre_group_treat_ind)
ctrl_diff <- lapply(post_group_ctrl_ind, function(x) x - pre_group_ctrl_ind)
# Compute Shapiro-Wilk test of normality
shapiro.test(treat_diff)
class(treat_diff)
# Calculate pre/post differences
treat_diff <- unlist(lapply(post_group_treat_ind, function(x) x - pre_group_treat_ind))
ctrl_diff <- unlist(lapply(post_group_ctrl_ind, function(x) x - pre_group_ctrl_ind))
# Compute Shapiro-Wilk test of normality
shapiro.test(treat_diff)
treat_diff
length(treat_diff)
length(post_group_treat_ind)
class(post_group_treat_ind)
?subtract
subtract(post_group_treat_ind - pre_group_treat_ind)
post_group_treat_ind - pre_group_treat_ind
a = c(1, 2, 3)
b = c(4, 5, 6)
b-a
post_group_treat_ind - pre_group_treat_ind
post_group_treat_ind + pre_group_treat_ind
?dist
employees$engagement - employees$rel_sat
# Initialize empty df for storing metrics
pre_post_metrics = NULL
# Initialize empty df for storing metrics
pre_post_metrics = NULL
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Initialize empty df for storing metrics
pre_post_metrics = NULL
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.3, .4), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(.1, .2), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
pre_post_metrics$treat_diff <- pre_post_metrics$post_group_treat_ind - pre_post_metrics$pre_group_treat_ind
pre_post_metrics$ctrl_diff <- pre_post_metrics$post_group_ctrl_ind - pre_post_metrics$pre_group_ctrl_ind
View(pre_post_metrics)
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
# Initialize empty list for storing pre/post metrics
pre_post_metrics = list()
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.3, .4), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(.1, .2), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
pre_post_metrics$treat_diff <- pre_post_metrics$post_group_treat_ind - pre_post_metrics$pre_group_treat_ind
pre_post_metrics$ctrl_diff <- pre_post_metrics$post_group_ctrl_ind - pre_post_metrics$pre_group_ctrl_ind
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
class(pre_post_metrics)
ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$treat_diff) +
ggplot2::labs(x = "Pre/Post Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Initialize empty list for central storage of pre/post metrics
pre_post_metrics = list()
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.2, .3, .4), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(0, .1, .2), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
pre_post_metrics$treat_diff <- pre_post_metrics$post_group_treat_ind - pre_post_metrics$pre_group_treat_ind
pre_post_metrics$ctrl_diff <- pre_post_metrics$post_group_ctrl_ind - pre_post_metrics$pre_group_ctrl_ind
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$treat_diff) +
ggplot2::labs(x = "Pre/Post Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Initialize empty list for central storage of pre/post metrics
pre_post_metrics = list()
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.1, .2, .3), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(0, .1, .2), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
pre_post_metrics$treat_diff <- pre_post_metrics$post_group_treat_ind - pre_post_metrics$pre_group_treat_ind
pre_post_metrics$ctrl_diff <- pre_post_metrics$post_group_ctrl_ind - pre_post_metrics$pre_group_ctrl_ind
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Initialize empty list for central storage of pre/post metrics
pre_post_metrics = list()
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.2, .3, .4), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(0, .1, .2), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
pre_post_metrics$treat_diff <- pre_post_metrics$post_group_treat_ind - pre_post_metrics$pre_group_treat_ind
pre_post_metrics$ctrl_diff <- pre_post_metrics$post_group_ctrl_ind - pre_post_metrics$pre_group_ctrl_ind
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$treat_diff) +
ggplot2::labs(x = "Pre/Post Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
library(ggpubr)
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Initialize empty list for central storage of pre/post metrics
pre_post_metrics = list()
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.2, .3, .4), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(0, .1, .2), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
pre_post_metrics$treat_diff <- pre_post_metrics$post_group_treat_ind - pre_post_metrics$pre_group_treat_ind
pre_post_metrics$ctrl_diff <- pre_post_metrics$post_group_ctrl_ind - pre_post_metrics$pre_group_ctrl_ind
p_treat <- ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$treat_diff) +
ggplot2::labs(title = "Pre/Post Treatment Group Differences", x = "Pre/Post Happiness Index Difference", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
p_ctrl <- ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$ctrl_diff) +
ggplot2::labs(title = "Pre/Post Control Group Differences", x = "Pre/Post Happiness Index Difference", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
ggpubr::ggarrange(p_treat, p_ctrl,
ncol = 2, nrow = 1)
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Initialize empty list for central storage of pre/post metrics
pre_post_metrics = list()
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.2, .3), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(.1, .2), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
pre_post_metrics$treat_diff <- pre_post_metrics$post_group_treat_ind - pre_post_metrics$pre_group_treat_ind
pre_post_metrics$ctrl_diff <- pre_post_metrics$post_group_ctrl_ind - pre_post_metrics$pre_group_ctrl_ind
# Histogram for distribution of pre/post treatment group differences
p_treat <- ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$treat_diff) +
ggplot2::labs(title = "Treatment Group", x = "Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
# Histogram for distribution of pre/post control group differences
p_ctrl <- ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$ctrl_diff) +
ggplot2::labs(title = "Control Group", x = "Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
# Display histograms side-by-side
ggpubr::ggarrange(p_treat, p_ctrl, ncol = 2, nrow = 1)
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Initialize empty list for central storage of pre/post metrics
pre_post_metrics = list()
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.2, .3), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(0, .1), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
pre_post_metrics$treat_diff <- pre_post_metrics$post_group_treat_ind - pre_post_metrics$pre_group_treat_ind
pre_post_metrics$ctrl_diff <- pre_post_metrics$post_group_ctrl_ind - pre_post_metrics$pre_group_ctrl_ind
# Histogram for distribution of pre/post treatment group differences
p_treat <- ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$treat_diff) +
ggplot2::labs(title = "Treatment Group", x = "Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
# Histogram for distribution of pre/post control group differences
p_ctrl <- ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$ctrl_diff) +
ggplot2::labs(title = "Control Group", x = "Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
# Display histograms side-by-side
ggpubr::ggarrange(p_treat, p_ctrl, ncol = 2, nrow = 1)
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Initialize empty list for central storage of pre/post metrics
pre_post_metrics = list()
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.2, .3), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(0, .1), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Set seed for reproducible results
set.seed(1234)
# Derive happiness index from survey variables
employees$happiness_ind <- (employees$engagement + employees$env_sat + employees$job_sat + employees$rel_sat) / 4
# Sample size of frequent travelers
n = nrow(subset(employees, business_travel == 'Travel_Frequently', select = employee_id))
# Randomly assign half of frequent travelers to treatment and control groups
pre_group_treat_ids <- sample(unlist(subset(employees, business_travel == 'Travel_Frequently', select = employee_id)), floor(n * .5))
pre_group_ctrl_ids <- unlist(subset(employees, business_travel == 'Travel_Frequently' & !employee_id %in% pre_group_treat_ids, select = employee_id))
# Initialize empty list for central storage of pre/post metrics
pre_post_metrics = list()
# Store happiness indices for treatment and control groups
pre_post_metrics$pre_group_treat_ind <- unlist(subset(employees, employee_id %in% pre_group_treat_ids, select = happiness_ind))
pre_post_metrics$pre_group_ctrl_ind <- unlist(subset(employees, employee_id %in% pre_group_ctrl_ids, select = happiness_ind))
# Create vectors with artificially inflated post-intervention happiness indices
post_group_treat_ind <- pre_group_treat_ind + sample(c(.2, .3), 1, replace = TRUE)
post_group_ctrl_ind <- pre_group_ctrl_ind + sample(c(0, .1), 1, replace = TRUE)
# Force an upper bound of 4 to adjusted index scores (variables were measured using a 4-point Likert scale)
pre_post_metrics$post_group_treat_ind <- if(post_group_treat_ind > 4) {4} else {post_group_treat_ind}
pre_post_metrics$post_group_ctrl_ind <- if(post_group_ctrl_ind > 4) {4} else {post_group_ctrl_ind}
# Calculate pre/post differences
pre_post_metrics$treat_diff <- pre_post_metrics$post_group_treat_ind - pre_post_metrics$pre_group_treat_ind
pre_post_metrics$ctrl_diff <- pre_post_metrics$post_group_ctrl_ind - pre_post_metrics$pre_group_ctrl_ind
# Histogram for distribution of pre/post treatment group differences
p_treat <- ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$treat_diff) +
ggplot2::labs(title = "Treatment Group", x = "Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
# Histogram for distribution of pre/post control group differences
p_ctrl <- ggplot2::ggplot() +
ggplot2::aes(pre_post_metrics$ctrl_diff) +
ggplot2::labs(title = "Control Group", x = "Happiness Index Differences", y = "Frequency") +
ggplot2::geom_histogram(fill = "#414141") +
ggplot2::theme_bw()
# Display histograms side-by-side
ggpubr::ggarrange(p_treat, p_ctrl, ncol = 2, nrow = 1)
# Compute Shapiro-Wilk test of normality
shapiro.test(pre_post_metrics$treat_diff)
shapiro.test(pre_post_metrics$ctrl_diff)
