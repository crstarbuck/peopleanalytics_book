ggplot2::aes(mlm.fit$residuals) +
ggplot2::labs(x = "YTD Leads Residuals", y = "Density") +
ggplot2::geom_histogram(aes(y = ..density..), fill = "#414141") +
ggplot2::geom_density(fill = "#ADD8E6", alpha = 0.6) +
ggplot2::theme_bw()
# Compute Shapiro-Wilk test of normality
shapiro.test(mlm.fit$residuals)
# Partition data into overtime and non-overtime groups
data_ot <- subset(data, overtime == 'Yes')
data_nonot <- subset(data, overtime == 'No')
# Regress transformed YTD sales on a combination of predictors for overtime and non-overtime groups
mlm.fit.ot <- lm(sqrt(ytd_sales) ~ engagement + job_lvl + stock_opt_lvl + org_tenure, data_ot)
mlm.fit.nonot <- lm(sqrt(ytd_sales) ~ engagement + job_lvl + stock_opt_lvl + org_tenure, data_nonot)
# Produce tabular summary with standardized coefficients
flextable::as_flextable(mlm.fit.ot)
# Produce tabular summary with standardized coefficients
flextable::as_flextable(mlm.fit.nonot)
mean(data_ot$job_lvl)
mean(data_nonot$job_lvl)
median(data_nonot$job_lvl)
median(data_ot$job_lvl)
# Regress transformed YTD sales on a combination of predictors for overtime and non-overtime groups
mlm.fit.ot <- lm(sqrt(ytd_sales) ~ job_lvl + stock_opt_lvl + org_tenure, data_ot)
# Produce tabular summary with standardized coefficients
flextable::as_flextable(mlm.fit.ot)
# Regress transformed YTD sales on a combination of predictors for overtime and non-overtime groups
mlm.fit.ot <- lm(sqrt(ytd_sales) ~ engagement + job_lvl + stock_opt_lvl + org_tenure, data_ot)
# Produce tabular summary with standardized coefficients
flextable::as_flextable(mlm.fit.ot)
# Produce correlation matrix
GGally::ggpairs(subset(data_ot, select = c(ytd_sales, job_lvl, stock_opt_lvl, org_tenure)))
# Produce correlation matrix
GGally::ggpairs(subset(data_ot, select = c(ytd_sales, engagement, job_lvl, stock_opt_lvl, org_tenure)))
# Produce correlation matrix
GGally::ggpairs(subset(data_ot, select = c(ytd_sales, job_lvl, stock_opt_lvl, org_tenure)))
# Produce correlation matrix
GGally::ggpairs(subset(data_ot, select = c(ytd_sales, job_lvl, stock_opt_lvl, org_tenure)))
GGally::ggpairs(subset(data_ot, select = c(ytd_sales, engagement, job_lvl, stock_opt_lvl, org_tenure)))
GGally::ggpairs(subset(data_ot, select = c(sqrt(ytd_sales), engagement, job_lvl, stock_opt_lvl, org_tenure)))
# Produce correlation matrix
GGally::ggpairs(subset(data_ot, select = c(sqrt(ytd_sales), job_lvl, stock_opt_lvl, org_tenure)))
# Produce correlation matrix
GGally::ggpairs(subset(data_ot, select = c(ytd_sales, job_lvl, stock_opt_lvl, org_tenure)))
GGally::ggpairs(subset(data_ot, select = c(ytd_sales, engagement, job_lvl, stock_opt_lvl, org_tenure)))
# Load library
library(dplyr)
# Load employee data
employees <- read.csv("/Users/craig.starbuck/Library/Mobile Documents/com~apple~CloudDocs/Documents/People Analytics Book/GitHub/peopleanalytics_lifecycle_book/data/employees.csv")
# Subset employees data frame; leads are only applicable for those in sales positions
data <- subset(employees, job_title %in% c('Sales Executive', 'Sales Representative'))
# Regress YTD leads on engagement
slm.fit <- lm(ytd_leads ~ engagement, data)
# Run the Breusch-Pagan test for evaluate homoscedasticity
lmtest::bptest(slm.fit)
# Produce histogram to visualize distribution of model residuals
ggplot2::ggplot() +
ggplot2::aes(slm.fit$residuals) +
ggplot2::labs(x = "YTD Leads Residuals", y = "Density") +
ggplot2::geom_histogram(aes(y = ..density..), fill = "#414141") +
ggplot2::geom_density(fill = "#ADD8E6", alpha = 0.6) +
ggplot2::theme_bw()
library(flextable)
# Produce tabular summary for model results using flextable
flextable::as_flextable(slm.fit)
# Load library
library(equatiomatic)
# Convert model to LaTex regression equation
extract_eq(slm.fit)
# Regress YTD sales on a combination of predictors
mlm.fit <- lm(ytd_sales ~ engagement + job_lvl + stock_opt_lvl + org_tenure, data)
# Load library
library(car)
# Produce VIF for each predictor
car::vif(mlm.fit)
# Regress YTD sales on a combination of predictors
mlm.fit <- lm(sqrt(ytd_sales) ~ engagement + job_lvl + stock_opt_lvl + org_tenure, data)
# Remove high leverage observations per Cook's distance
w <- abs(rstudent(mlm.fit)) < 3 & abs(cooks.distance(mlm.fit)) < 4/nrow(mlm.fit$model)
mlm.fit <- update(mlm.fit, weights = as.numeric(w))
# Convert model to LaTex regression equation
extract_eq(mlm.fit)
# Load library
library(dplyr)
# Load employee data
employees <- read.csv("/Users/craig.starbuck/Library/Mobile Documents/com~apple~CloudDocs/Documents/People Analytics Book/GitHub/peopleanalytics_lifecycle_book/data/employees.csv")
# Subset employees data frame; leads are only applicable for those in sales positions
data <- subset(employees, job_title %in% c('Sales Executive', 'Sales Representative'))
# Regress YTD leads on engagement
slm.fit <- lm(ytd_leads ~ engagement, data)
library(flextable)
# Produce tabular summary for model results using flextable
flextable::as_flextable(slm.fit)
# Load library
library(equatiomatic)
# Convert model to LaTex regression equation
extract_eq(slm.fit)
View(employees)
# Regress YTD sales on a combination of predictors with interaction term
int.mlm.fit <- lm(sqrt(ytd_sales) ~ engagement * stock_opt_lvl, data)
# Regress YTD sales on a combination of predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ engagement * stock_opt_lvl, data)
# Produce tabular summary with standardized coefficients
flextable::as_flextable(mlm.fit.int)
# Regress YTD sales on a combination of predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ job_lvl * org_tenure, data)
# Produce tabular summary with standardized coefficients
flextable::as_flextable(mlm.fit.int)
# Regress YTD sales on a combination of predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ job_lvl * org_tenure, data)
# Produce tabular summary with standardized coefficients
flextable::as_flextable(mlm.fit.int)
average(data$org_tenure)
mean(data$org_tenure)
round(mean(data$org_tenure), 2)
round(sd(data$org_tenure), 2)
# Load library
library(car)
# Produce VIF for each predictor
car::vif(mlm.fit)
# Load library
library(car)
# Produce VIF for each predictor
car::vif(mlm.fit.int)
# Regress YTD sales on a combination of centered predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ (job_lvl - mean(job_lvl)) * (org_tenure - mean(org_tenure)), data)
data$job_lvl_cntrd <- data$job_lvl - mean(data$job_lvl)
data$org_tenure_cntrd <- data$org_tenure - mean(data$org_tenure)
# Append centered predictors to data
data$job_lvl_cntrd <- data$job_lvl - mean(data$job_lvl)
data$org_tenure_cntrd <- data$org_tenure - mean(data$org_tenure)
# Regress YTD sales on a combination of centered predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ job_lvl_cntrd * org_tenure_cntrd, data)
# Produce VIF for each model term
car::vif(mlm.fit.int)
# Load library
library(ggplot2)
# Generate data with a linear relationship + some noise
X <- rnorm(20, 50, 10)
err = rnorm(20, 0, 15)
Y <- 100 + 4*X + err
# Construct basic data frame
df2 <- data.frame(X = X,
Y = Y)
# Fit simple linear model to data
lm.fit.2 <- lm(Y ~ X, df2)
# Save predicted values and residuals
df2$predicted <- predict(lm.fit.2)
df2$residuals <- residuals(lm.fit.2)
# Visualize model fit to observations
ggplot2::ggplot(data = df2, aes(x = X, y = Y)) +
ggplot2::geom_segment(aes(xend = X, yend = predicted)) +
ggplot2::geom_point(shape = 1) +
ggplot2::geom_point(aes(y = predicted)) +
ggplot2::geom_function(fun = function(x) {lm.fit.2$coefficients[[2]]*x + lm.fit.2$coefficients[[1]]}, colour = "red", linetype = "dashed") +
ggplot2::theme_bw() +
ggplot2::theme(axis.title.y = element_text(face = "italic"), axis.title.x = element_text(face = "italic"))
# Load library
library(dplyr)
# Load employee data
employees <- read.csv("/Users/craig.starbuck/Library/Mobile Documents/com~apple~CloudDocs/Documents/People Analytics Book/GitHub/peopleanalytics_lifecycle_book/data/employees.csv")
# Subset employees data frame; leads are only applicable for those in sales positions
data <- subset(employees, job_title %in% c('Sales Executive', 'Sales Representative'))
# Regress YTD leads on engagement
slm.fit <- lm(ytd_leads ~ engagement, data)
# Set seed for reproducibility
set.seed(1234)
# Simulate n observations
n <- 20
X <- runif(n, 0, 5)
Y <- 1 + 3*X + rnorm(n, 0, 1)
df.orig <- data.frame(X = X, Y = Y)
# Model data
model <- lm(Y ~ X)
summary(model)
# Visualize model fit to observations
p1 <- ggplot2::ggplot(data = df.orig, aes(x = X, y = Y)) +
ggplot2::geom_point() +
ggplot2::geom_function(fun = function(x) {model$coefficients[[2]]*x + model$coefficients[[1]]}, colour = "red", linetype = "dashed") +
ggplot2::theme_bw() +
ggplot2::theme(axis.title.y = element_text(face = "italic"), axis.title.x = element_text(face = "italic"))
# Model data with non-influential outliers
X.out <- c(X, 8)
Y.out <- c(Y, 25)
df.out <- data.frame(X = X.out, Y = Y.out)
model.out <- lm(Y.out ~ X.out)
summary(model.out)
# Visualize model fit to observations
p2 <- ggplot2::ggplot(data = df.out, aes(x = X, y = Y)) +
ggplot2::geom_point(col = ifelse(df.out$X == 8, "red", "black"), size = ifelse(df.out$X == 8, 2, 1)) +
ggplot2::geom_function(fun = function(x) {model$coefficients[[2]]*x + model$coefficients[[1]]}, colour = "black", linetype = "solid") +
ggplot2::geom_function(fun = function(x) {model.out$coefficients[[2]]*x + model.out$coefficients[[1]]}, colour = "red", linetype = "dashed") +
ggplot2::theme_bw() +
ggplot2::theme(axis.title.y = element_text(face = "italic"), axis.title.x = element_text(face = "italic"))
# Model data with influential (high leverage) observations
X.lev <- c(X, 8)
Y.lev <- c(Y, 5)
df.lev <- data.frame(X = X.lev, Y = Y.lev)
model.lev <- lm(Y.lev ~ X.lev)
summary(model.lev)
# Visualize model fit to observations
p3 <- ggplot2::ggplot(data = df.lev, aes(x = X, y = Y)) +
ggplot2::geom_point(col = ifelse(df.out$X == 8, "red", "black"), size = ifelse(df.out$X == 8, 2, 1)) +
ggplot2::geom_function(fun = function(x) {model$coefficients[[2]]*x + model$coefficients[[1]]}, colour = "black", linetype = "solid") +
ggplot2::geom_function(fun = function(x) {model.lev$coefficients[[2]]*x + model.lev$coefficients[[1]]}, colour = "red", linetype = "dashed") +
ggplot2::theme_bw() +
ggplot2::theme(axis.title.y = element_text(face = "italic"), axis.title.x = element_text(face = "italic"))
# Display distribution visualizations
ggpubr::ggarrange(p2, p3, ncol = 2, nrow = 1)
library(flextable)
# Produce tabular summary for model results using flextable
flextable::as_flextable(slm.fit)
# Regress YTD sales on a combination of predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ job_lvl * org_tenure, data)
# Produce tabular summary with standardized coefficients
flextable::as_flextable(mlm.fit.int)
# Produce VIF for each model term
car::vif(mlm.fit.int)
# Append centered predictors to data
data$job_lvl_cntrd <- data$job_lvl - mean(data$job_lvl)
data$org_tenure_cntrd <- data$org_tenure - mean(data$org_tenure)
# Regress YTD sales on a combination of centered predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ job_lvl * org_tenure_cntrd, data)
# Produce VIF for centered variables
car::vif(mlm.fit.int)
# Append centered predictors to data
data$job_lvl_cntrd <- data$job_lvl - mean(data$job_lvl)
data$org_tenure_cntrd <- data$org_tenure - mean(data$org_tenure)
# Regress YTD sales on a combination of centered predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ job_lvl_cntrd * org_tenure_cntrd, data)
# Produce VIF for centered variables
car::vif(mlm.fit.int)
# Append centered predictors to data
data$job_lvl_cntrd <- data$job_lvl - mean(data$job_lvl)
data$org_tenure_cntrd <- data$org_tenure - mean(data$org_tenure)
# Regress YTD sales on a combination of centered predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ job_lvl_cntrd * org_tenure_cntrd, data)
# Produce VIF for centered variables
car::vif(mlm.fit.int)
View(data)
mean(job_lvl_cntrd)
mean(data$job_lvl_cntrd)
mean(data$org_tenure_cntrd)
# Append centered predictors to data
data$job_lvl_cntrd <- data$job_lvl - mean(data$job_lvl)
data$org_tenure_cntrd <- data$org_tenure - mean(data$org_tenure)
# Regress YTD sales on a combination of centered predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ job_lvl_cntrd * org_tenure_cntrd, data)
# Produce VIF for centered variables
car::vif(mlm.fit.int)
lm(sqrt(ytd_sales) ~ job_lvl_cntrd * org_tenure_cntrd, data)
lm(sqrt(ytd_sales) ~ job_lvl_cntrd * org_tenure_cntrd, data)
summary(lm(sqrt(ytd_sales) ~ job_lvl_cntrd * org_tenure_cntrd, data))
# Append centered predictors to data
data$job_lvl_cntrd <- data$job_lvl - mean(data$job_lvl)
data$org_tenure_cntrd <- data$org_tenure - mean(data$org_tenure)
# Regress YTD sales on a combination of centered predictors with interaction term
mlm.fit.int <- lm(sqrt(ytd_sales) ~ job_lvl_cntrd * org_tenure_cntrd, data)
# Produce tabular summary with standardized coefficients
flextable::as_flextable(mlm.fit.int)
summary(lm(sqrt(ytd_sales) ~ job_lvl_cntrd * org_tenure_cntrd, data))
mean(data$org_tenure_cntrd)
sd(data$org_tenure_cntrd)
sd(data$org_tenure_cntrd)
mean(data$org_tenure_cntrd)
mlm.fit.int$coefficients[[2]]
mlm.fit.int$coefficients[[1]]
mlm.fit.int$coefficients[[3]]
mlm.fit.int$coefficients[[4]]
276.56 - 2.51 (-4.32 + 5.12) * 2
276.56 - 2.51 * (-4.32 + 5.12) * 2
-2.51 * (-4.32 + 5.12) * 2 + 276.56
mlm.fit.int$coefficients[[2]]
mlm.fit.int$coefficients[[2]]
mlm.fit.int$coefficients[[1]]
mlm.fit.int$coefficients[[4]]
sd(data$org_tenure_cntrd)
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 1.4, y = 40, label = "y = 20.1x + 1.6", colour = "red") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 1.4, y = 40, label = "High org tenure: y = -2.51 (-4.32 + 5.12)x + 276.56", colour = "red") +
ggplot2::annotate("text", x = 1.4, y = 40, label = "Low org tenure: y = -2.51 (-4.32 - 5.12)x + 276.56", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 1.4, y = 40, label = "High org tenure: y = -2.51 (-4.32 + 5.12)x + 276.56", colour = "red") +
ggplot2::annotate("text", x = 1.4, y = 475, label = "Low org tenure: y = -2.51 (-4.32 - 5.12)x + 276.56", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 0, y = -50, label = "High org tenure: y = -2.51 (-4.32 + 5.12)x + 276.56", colour = "red") +
ggplot2::annotate("text", x = 0, y = 550, label = "Low org tenure: y = -2.51 (-4.32 - 5.12)x + 276.56", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 0, y = -50, label = "High org tenure", colour = "red") +
ggplot2::annotate("text", x = 0, y = 550, label = "Low org tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 10, y = 0, label = "High org tenure", colour = "red") +
ggplot2::annotate("text", x = 10, y = 550, label = "Low org tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 13, y = 0, label = "High org tenure", colour = "red") +
ggplot2::annotate("text", x = 13, y = 550, label = "Low org tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 10, y = 0, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 10, y = 550, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 10, y = 10, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 10, y = 550, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = org_tenure_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Org Tenure (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 10, y = 25, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 10, y = 525, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 10, y = 25, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 10, y = 525, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 5, y = 150, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 5, y = 375, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 2, y = 150, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 2, y = 375, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 2, y = 150, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 2, y = 375, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = -1, y = 310, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = -1, y = 230, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 0, y = 310, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 0, y = 230, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 0, y = 300, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 0, y = 250, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = -.05, y = 295, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = -.05, y = 255, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = -.5, y = 295, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = -.5, y = 255, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level (Centered)", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = -.5, y = 295, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = -.5, y = 258, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl_cntrd, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Centered Job Level", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) + sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure_cntrd) - sd(data$org_tenure_cntrd)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = -.5, y = 295, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = -.5, y = 258, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
max(data$org_tenure_cntrd) - min(data$org_tenure_cntrd)
max(data$org_tenure) - min(data$org_tenure)
mean(data$org_tenure)
sd(data$org_tenure)
ggplot2::ggplot(data = data, aes(x = job_lvl, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) + sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) - sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = -.5, y = 295, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = -.5, y = 258, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
unique(data$job_lvl)
ggplot2::ggplot(data = data, aes(x = job_lvl, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) + sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) - sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = -.5, y = 225, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = -.5, y = 280, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) + sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) - sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = .5, y = 225, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = .5, y = 280, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) + sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) - sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 1, y = 225, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 1, y = 280, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) + sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) - sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 1.5, y = 225, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 1.5, y = 280, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) + sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) - sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 1.5, y = 250, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 1.5, y = 280, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) + sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) - sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 1.5, y = 255, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 1.5, y = 280, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
ggplot2::ggplot(data = data, aes(x = job_lvl, y = sqrt(ytd_sales))) +
ggplot2::labs(x = "Job Level", y = "Square Root of YTD Sales") +
#ggplot2::geom_point(color = "black") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) + sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "red") +
ggplot2::geom_function(fun = function(x) {mlm.fit.int$coefficients[[4]] * (mean(data$org_tenure) - sd(data$org_tenure)) * x + mlm.fit.int$coefficients[[1]]}, colour = "blue") +
ggplot2::annotate("text", x = 1.5, y = 255, label = "High organization tenure", colour = "red") +
ggplot2::annotate("text", x = 1.5, y = 280, label = "Low organization tenure", colour = "blue") +
ggplot2::theme_bw()
