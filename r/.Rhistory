axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = dept, y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores in Sales and Engineering.', x = 'Department', y = 'Engagement Favorability') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-150, 150, 50),
labels = abs(seq(-150, 150, 50))) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = dept, y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Sales and Engineering.', x = 'Department', y = 'Engagement Favorability') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-150, 150, 50),
labels = abs(seq(-150, 150, 50))) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = dept, y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Sales and Engineering.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-150, 150, 50),
labels = abs(seq(-150, 150, 50))) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = dept, y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Sales and Engineering.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10),
labels = abs(seq(-50, 50, 10))) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = dept, y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Sales and Engineering.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(
labels = abs(seq(-50, 50, 10))) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = dept, y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Sales and Engineering.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
order <- engagement_scores |> dplyr::filter(favorability = 'Unfavorable') |> dplyr::arrange(desc(pct))
order <- engagement_scores |> dplyr::filter(favorability = "Unfavorable") |> dplyr::arrange(desc(pct))
order <- engagement_scores |> dplyr::filter(favorability == "Unfavorable") |> dplyr::arrange(desc(pct))
View(order)
order <- engagement_scores |>
dplyr::filter(favorability == "Unfavorable") |>
dplyr::arrange(desc(pct)) |>
dplyr::select(dept)
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = dept, y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Sales and Engineering.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_x_discrete(limits = order) +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Stacked Bar Charts ###
ggplot2::ggplot(engagement_scores, aes(x = reorder(dept, -rank), y = pct, fill = factor(favorability, levels = c("Unfavorable", "Neutral", "Favorable")))) +
ggplot2::labs(title = 'Half of Engineering respondents report unfavorable engagement.', x = 'Department', y = 'Engagement Score') +
ggplot2::guides(fill = guide_legend(title = "Favorability")) +
ggplot2::geom_bar(position = "fill", stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Favorable" = "#0070C0",
"Neutral" = "#D9D9D9",
"Unfavorable" = "#ED7D31")) +
ggplot2::scale_y_continuous(labels = scales::percent) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = reorder(dept, -pct), y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Sales and Engineering.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_x_discrete(limits = order) +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = reorder(dept, -pct), y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Sales and Engineering.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = reorder(dept, -pct_trans), y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Sales and Engineering.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = reorder(dept, -pct_trans), y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = reorder(dept, -pct_trans), y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_blank(),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = reorder(dept, -pct_trans), y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
#ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(subset(engagement_scores, favorability %in% c('Favorable', 'Unfavorable')), aes(x = reorder(dept, -pct_trans), y = pct_trans, fill = as.factor(favorability))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Unfavorable" = "#ED7D31",
"Favorable" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
rep(c('Hires', 'Terms'), 7)
round(runif(14, 5, 150), 0)
# Build data frame with YoY headcount metrics by department
hires_terms <- data.frame(dept = c('Engineering', 'Finance', 'Legal', 'Marketing', 'People', 'Product', 'Sales'),
metric = rep(c('Hires', 'Terms'), 7),
cnt = round(runif(14, 5, 150), 0))
# Append transformed count column to support bidirectional bar charts
hires_terms$cnt_trans <- ifelse(hires_terms$metric == 'Terms', 0 - hires_terms$cnt, hires_terms$cnt)
View(hires_terms)
### Data Prep ###
# Load library
library(dplyr)
# Set seed for reproducibility
set.seed(1234)
# Build data frame with YoY headcount metrics by department
hires_terms <- data.frame(dept = c('Engineering', 'Finance', 'Legal', 'Marketing', 'People', 'Product', 'Sales'),
metric = rep(c('Hires', 'Terms'), 7),
cnt = round(runif(14, 5, 150), 0))
# Append transformed count column to support bidirectional bar charts
hires_terms$cnt_trans <- ifelse(hires_terms$metric == 'Terms', 0 - hires_terms$cnt, hires_terms$cnt)
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
#ggplot2::scale_y_continuous(breaks = seq(-50, 50, 10)) +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_y_continuous(breaks = seq(-150, 150, 25)) +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = '% of Respondents') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Data Prep ###
# Load library
library(dplyr)
# Set seed for reproducibility
set.seed(1234)
# Build data frame with YoY headcount metrics by department
hires_terms <- data.frame(dept = c('Engineering', 'Finance', 'Legal', 'Marketing', 'People', 'Product', 'Sales'),
metric = rep(c('Hires', 'Terms'), 7),
cnt = round(runif(14, 5, 150), 0))
# Append transformed count column to support bidirectional bar charts
hires_terms$cnt_trans <- ifelse(hires_terms$metric == 'Terms', 0 - hires_terms$cnt, hires_terms$cnt)
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = 'Term and Hire Count') +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(legend.position = "none",
panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = 'Term and Hire Count') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Unfavorable scores have eclipsed favorable scores \nin Engineering and Sales.', x = 'Department', y = 'Count') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Terms have eclipsed hires \nin Sales, Product, and Engineering.', x = 'Department', y = 'Count') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Terms have eclipsed hires in \nSales, Product, and Engineering.', x = 'Department', y = 'Count') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Terms have eclipsed hires in Sales, Product, and Engineering.', x = 'Department', y = 'Count') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Terms have eclipsed hires in Sales, Product, and Engineering \nover the trailing 12 months.', x = 'Department', y = 'Count') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Terms have eclipsed hires in Sales, Product, and Engineering \nover the trailing 12 month period.', x = 'Department', y = 'Count') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Terms have eclipsed hires in Sales, Product, and Engineering \nover the trailing 12-month period.', x = 'Department', y = 'Count') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Terms have eclipsed hires in Sales, Product, and Engineering \nover the trailing 12-month period.', x = 'Department', y = 'Headcount Changes') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
### Bidirectional Bar Charts ###
# Load library
library(ggplot2)
ggplot2::ggplot(hires_terms, aes(x = reorder(dept, -cnt_trans), y = cnt_trans, fill = as.factor(metric))) +
ggplot2::labs(title = 'Terms have eclipsed hires in Sales, Product, and Engineering \nover the trailing 12-month period.', x = 'Department', y = 'Headcount Changes') +
ggplot2::guides(fill = guide_legend(title = "Metric")) +
ggplot2::geom_bar(stat = "identity") +
ggplot2::coord_flip() +
ggplot2::scale_fill_manual(values = c("Terms" = "#ED7D31",
"Hires" = "#0070C0")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 10, r = 0, b = 0, l = 0), colour = "#404040"),
axis.title.y = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 0), colour = "#404040"),
plot.title = ggplot2::element_text(margin = ggplot2::margin(t = 0, r = 0, b = 20, l = 0), colour = "#404040"),
axis.ticks.x = ggplot2::element_blank(),
axis.ticks.y = ggplot2::element_blank())
knitr::include_graphics("/Users/craig.starbuck/Library/Mobile Documents/com~apple~CloudDocs/Documents/People Analytics Book/GitHub/peopleanalytics_book/graphics/bidirectional_bar_chart.png")
View(hires_terms)
knitr::include_graphics("/Users/craig.starbuck/Library/Mobile Documents/com~apple~CloudDocs/Documents/People Analytics Book/GitHub/peopleanalytics_book/graphics/stacked_bar_chart.png")
knitr::include_graphics("/Users/craig.starbuck/Library/Mobile Documents/com~apple~CloudDocs/Documents/People Analytics Book/GitHub/peopleanalytics_book/graphics/bidirectional_bar_chart.png")
